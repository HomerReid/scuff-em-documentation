<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Brillouin zone integration - SCUFF-EM documentation</title>
  

  <link rel="shortcut icon" href="../../scuffEM.ico">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "reference/BrillouinZoneIntegration"
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
  <script src="../../mathjaxhelper.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">

      <p align="center"
      <a href="../..">
         <img align="center" height="auto" width="100%"  
              src="../../img/scuffEMNavBar.png"
      </a>

      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> SCUFF-EM documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">SCUFF-EM documentation</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Examples</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/MieScattering/MieScattering/">Mie scattering</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/DielectricShell/DielectricShell/">Electrostatics of a spherical dielectric shell</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/ThinFilm/ThinFilm/">Spatially-resolved study of plane-wave transmission through an infinite-area thin dielectric film</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/DiffractionPatterns/DiffractionPatterns/">Imaging diffraction patterns of discs, disc arrays, and hole arrays in metal screens</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/CubeTorus/">Casimir forces in a compact geometry</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/SiliconBeams/SiliconBeams/">Casimir forces in a 1D extended geometry</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/SiliconSlabs/SiliconSlabs/">Casimir forces in a 2D extended geometry</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/NanostructureCasimirPolder/NanostructureCasimirPolder/">Casimir-Polder potentials in dielectric nanostructures</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/SiO2Spheres/SiO2Spheres/">Thermal radiation, heat transfer, and non-equilibrium Casimir forces between silicon dioxide spheres</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/TipSubstrate/TipSubstrate/">Spatial distribution of heat flux from a warm tip over a cold substrate</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/HalfSpaceLDOS/HalfSpaceLDOS/">LDOS and dyadic Green functions above an infinite aluminum half-space</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/PlatonicSolids/PlatonicSolids/">Electrostatic polarizability of platonic solids</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/TwoBodyCapacitors/TwoBodyCapacitors/">Capacitance of two-body capacitors</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/StriplineCapacitor/StriplineCapacitor/">Capacitance of a PCB stripline trace</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/ImplicitSubstrate/ImplicitSubstrate/">Implicit handling of multilayer dielectric substrates</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>General reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../TopLevel/">Top-level overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Installing/">Installation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Geometries/">Geometry descriptions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Materials/">Material designations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Transformations/">Geometric transformations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../IncidentFields/">Incident fields</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Brillouin zone integration</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#command-line-options-for-customizing-internal-bz-integration">Command-line options for customizing internal BZ integration</a></li>
                
            
                <li class="toctree-l3"><a href="#understanding-the-internal-bz-integration-algorithms">Understanding the internal BZ integration algorithms</a></li>
                
                    <li><a class="toctree-l4" href="#integration-methods-for-1d-brillouin-zones">Integration methods for 1D Brillouin zones</a></li>
                
                    <li><a class="toctree-l4" href="#symmetry-factors-for-1d-brillouin-zones">Symmetry factors for 1D Brillouin zones</a></li>
                
                    <li><a class="toctree-l4" href="#integration-methods-for-2d-brillouin-zones">Integration methods for 2D Brillouin zones</a></li>
                
                    <li><a class="toctree-l4" href="#symmetry-factors-for-2d-brillouin-zones">Symmetry factors for 2D Brillouin zones</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../FAQ/">FAQ</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Command-line application reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/GeneralReference/">General command-line reference</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-scatter/scuff-scatter/">scuff-scatter</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-transmission/scuff-transmission/">scuff-transmission</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-ldos/scuff-ldos/">scuff-ldos</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-tmatrix/scuff-tmatrix/">scuff-tmatrix</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-cas3D/scuff-cas3D/">scuff-cas3D</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-caspol/scuff-caspol/">scuff-caspol</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-neq/scuff-neq/">scuff-neq</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-RF/scuff-RF/">scuff-RF</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-static/scuff-static/">scuff-static</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-analyze/scuff-analyze/">scuff-analyze</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-integrate/scuff-integrate/">scuff-integrate</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Validation tests</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/Overview/">Overview of the test suite</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/MieScattering/MieScattering/">Mie scattering</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/FresnelScattering/FresnelScattering/">Fresnel scattering</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/CasimirSpheres/CasimirSpheres/">Equilibrium Casimir forces between spheres</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/CasimirPlates/CasimirPlates/">Equilibrium Casimir forces between plates</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/CPSphere/CPSphere/">Equilibrium Casimir-Polder potential near a sphere</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/CPPlate/CPPlate/">Equilibrium Casimir-Polder potential near a plate</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/NEQSpheres/NEQSpheres/">Heat transfer and non-equilibrium Casimir forces between spheres</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/libscuff/libscuff/">Low-level tests of the core library</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>API reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../API/libscuff/">libscuff</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>For developers</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../forDevelopers/Implementation/">Implementation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../forDevelopers/DataStructures/">Data Structures</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../forDevelopers/Documentation/">Documentation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../forDevelopers/SingularIntegrals/">Code for computing singular integrals</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">SCUFF-EM documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.."><span class="SmallCaps">scuff-em</span> documentation</a> &raquo;</li>
    
      
        
          <li>General reference &raquo;</li>
        
      
    
    <li>Brillouin zone integration</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/homerreid/scuff-em/" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="brillouin-zone-integration-in-scuff-em">Brillouin-zone integration in <a class="wikilink" href="../../scuff-em/">scuff-em</a></h1>
<p>Many codes in the <a class="wikilink" href="../../scuff-em/">scuff-em</a> suite require evaluating
integrals over the Brillouin zone (BZ) of a 1D or 2D
reciprocal lattice, i.e.</p>
<p>
<script type="math/tex; mode=display">Q(\omega) = \int_\text{BZ} \overline{Q}(\omega, \mathbf{k}_\text{B}) 
 \,d\mathbf{k}_\text{B}</script>
</p>
<p>where we generically use the overlined symbol
<script type="math/tex">\overline{Q}(\mathbf{k}_\text{B})</script> to denote
the contribution of Bloch vector <script type="math/tex">\mathbf{k}_\text{B}</script>
to quantity <script type="math/tex">Q</script>. Examples of calculations that require
Brillouin-zone integrations include</p>
<ul>
<li>
<p>the Casimir force per unit imaginary frequency
<script type="math/tex">\omega=i\xi</script> 
on an extended object in
<a href="../../applications/scuff-cas3D/scuff-cas3D/"><span class="SC">scuff-cas3d</span></a></p>
</li>
<li>
<p>the Casimir-Polder potential per unit imaginary frequency
<script type="math/tex">\omega=i\xi</script> 
experienced by a polarizable particle near an extended surface
in 
<a href="../../applications/scuff-caspol/scuff-caspol/"><span class="SC">scuff-caspol</span></a></p>
</li>
<li>
<p>the local density of states at a given angular frequency
<script type="math/tex">\omega</script>
at user-specified evaluation points in 
<a href="../../applications/scuff-ldos/scuff-ldos/"><span class="SC">scuff-ldos</span></a>.</p>
</li>
</ul>
<p>In general, Brillouin-zone integrations are evaluated
by numerical cubature---that is, as weighted sums of
integrand samples:
<script type="math/tex; mode=display"> Q(\omega) \approx \sum w_n \overline Q(\omega, \mathbf{k}_n)</script>
where <script type="math/tex">\{w_n, \mathbf{k}_n\}</script> are the weights and points in
a cubature rule for the Brillouin zone of your reciprocal
lattice, and where each integrand sample
<script type="math/tex">\overline Q(\omega, \bf k_n)</script> is computed by performing a
single <a class="wikilink" href="../../scuff-em/">scuff-em</a> calculation at a fixed Bloch
wavevector. The <a class="wikilink" href="../../scuff-em/">scuff-em</a> workflow offers two 
options for evaluating such cubatures:   </p>
<ul>
<li>You can design and implement your own cubature scheme
involving your own custom-chosen weights and points
<script type="math/tex">\{w_n, \bf k_n\}</script>. In this case, you will use 
the <code>--byOmegakBloch</code> command-line option to instruct
a <a class="wikilink" href="../../scuff-em/">scuff-em</a> application code to report values of the
quantity <script type="math/tex">\overline Q(\omega, \bf k_n)</script> at each of your points
(this output will typically be written to file with
extension <code>.byOmegakBloch</code> or <code>.byXikBloch</code>),
then compute the weighted sums yourself in e.g.
<a href="http://julialang.org"><span class="SC">julia</span></a>.    </li>
</ul>
<p>&nbsp;</p>
<ul>
<li>Alternatively, you can ask <a class="wikilink" href="../../scuff-em/">scuff-em</a> to perform the
BZ integration internally, using one of several
built-in cubature schemes. In this case the BZ-integrated
quantities <script type="math/tex">Q(\omega)</script> will typically be written to 
an output file with extension <code>.byOmega</code> or <code>.byXi</code>.
You will <em>also</em> get an output file named <code>.byOmegakBloch</code>
or <code>.byXikBloch</code> that reports the Bloch-vector-resolved
integrand samples <script type="math/tex">\overline Q(\omega, \bf k_n)</script>
chosen internally by the <a class="wikilink" href="../../scuff-em/">scuff-em</a> BZ integrator.</li>
</ul>
<h3 id="command-line-options-for-customizing-internal-bz-integration">Command-line options for customizing internal BZ integration</h3>
<p>If you choose the second option above, you may specify
various command-line options to customize the algorithm
used by <a class="wikilink" href="../../scuff-em/">scuff-em</a> to select the cubature points and
weights <script type="math/tex">\{w_n, \mathbf{k}_n\}</script>. The options are 
listed here and discussed in more detail below.</p>
<pre><code class="bash">--BZIMethod [CC | TC | Polar | Polar2]
</code></pre>

<p>Selects the integration algorithm (see below for details).</p>
<pre><code class="bash">--BZIOrder NN
</code></pre>

<p>Sets the order (accuracy parameter) of the integration
algorithm to <code>NN</code>. The allowed values of <code>NN</code> here depend
on the integration algorithm you chose (see below).</p>
<pre><code class="bash">--BZIRelTol xx
--BZIAbsTol xx
--BZIMaxEvals NN
</code></pre>

<p>For adaptive integration algorithms in which the 
order is determined internally (see below), these 
options allow you to specify relative and absolute
error tolerances and an upper limit on the number of 
integrand samples that will be used.</p>
<pre><code class="bash">--BZSymmetryFactor [2|4|8]
</code></pre>

<p>This option lets you tell <a class="wikilink" href="../../scuff-em/">scuff-em</a> that your
integrand function <script type="math/tex">\overline Q(\mathbf k_\text{B})</script>
is invariant under 2, 4, or 8-fold rotational 
symmetry transformations applied to <script type="math/tex">\mathbf k_\text{B}</script>. 
See below for more details on what this means.</p>
<h3 id="understanding-the-internal-bz-integration-algorithms">Understanding the internal BZ integration algorithms</h3>
<p>To help you understand how to configure the various
command-line options above, this section
describes the various integration algorithms available
and how they are affected by the command-line parameters.</p>
<h5 id="integration-methods-for-1d-brillouin-zones">Integration methods for 1D Brillouin zones</h5>
<p>For one-dimensional Brillouin zones, there is only one
BZ integration method available---namely,
<a href="http://homerreid.com/teaching/18.330/Notes/ClenshawCurtis.pdf">Clenshaw-Curtis quadrature</a>
(<code>--BZIMethod CC</code>, the default)
with the number of integrand samples either fixed
or chosen adaptively until user-specified error tolerances
are achieved.</p>
<p>More specifically, you may say either</p>
<ul>
<li><code>--BZIOrder [11 | 13 | 15 | ... | 97 | 99]</code></li>
</ul>
<p>or </p>
<ul>
<li><code>--BZIOrder 0</code></li>
</ul>
<p>The former option selects fixed-order CC cubature
with 11, 13, ... 99 sample points. (This number must 
be an odd integer between 11 and 99 inclusive.)</p>
<p>The latter option selects adaptive
CC cubature
using <a href="http://ab-initio.mit.edu/wiki/index.php/Cubature">this algorithm</a>.
In this case the number of sample points will be chosen
automatically subject to the values you select for the
<code>--BZIRelTol</code>, <code>--BZIAbsTol</code>, and <code>--BZIMaxEvals</code>
command-line options.</p>
<h5 id="symmetry-factors-for-1d-brillouin-zones">Symmetry factors for 1D Brillouin zones</h5>
<p>For 1D Brillouin zones, the only allowed 
value of the <code>--BZSymmetryFactor</code> option is <code>2</code>,
indicating that your integrand is symmetric under
sign flip of the Bloch wavevector, i.e.
<script type="math/tex">\overline Q(k_x) = \overline Q(-k_x)</script>.
In this case the BZ integration may be restricted to 
the range <script type="math/tex">0\le k_x \le \frac{\pi}{L_x}.</script>
</p>
<h4 id="integration-methods-for-2d-brillouin-zones">Integration methods for 2D Brillouin zones</h4>
<p>The following integration methods are implemented for 
2D Brillouin zones. (See below for pictures of where
the various methods place their sample points.)</p>
<ul>
<li>
<p><strong>Clenshaw-Curtis cubature</strong> (<code>--BZIMethod CC</code>)</p>
<p>Nested 2D fixed-order or adaptive Clenshaw-Curtis cubature.</p>
<p>For fixed-order nested CC cubature with <code>NN</code> sample points
per dimension, say <code>--BZIOrder NN</code>. Here <code>NN</code> must be 
an odd integer between 11 and 99 inclusive.</p>
<p>For adaptive 2D CC cubature (subject to your specified values
of <code>--BZIRelTol</code>, <code>--BZIAbsTol</code>, and <code>--BZIMaxEvals</code>)
say <code>--BZIOrder 0.</code>    </p>
</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>
<p><strong>Triangle cubature</strong> (<code>--BZIMethod TC</code>)</p>
<p>This algorithm divides the Brillouin zone into 8
triangles and applies a fixed-order triangle cubature scheme
to each triangle, omitting repetition of triangles
that are symmetry-equivalent given the value you specified
for <code>--BZSymmetryFactor</code> (see pictures below).</p>
<p>For this algorithm, the allowed values of
<code>--BZIOrder</code> are 1, 2, 4, 5, 7, 9, 13, 14, 16, 20, or 25.</p>
</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>
<p><strong>Polar cubature</strong> (<code>--BZIMethod Polar</code>)</p>
<p>This algorithm uses a polar decomposition
<script type="math/tex">(k_x,k_y) \to (k_\rho, k_\theta)</script> to
evaluate the BZ integral as two nested 1D integrals,
one over <script type="math/tex">k_\rho</script> and the second over <script type="math/tex">k_\theta</script>.
(The <script type="math/tex">k_\rho</script> integral is evaluated via
 Clenshaw-Curtis quadrature, and the <script type="math/tex">k_\theta</script> 
 quadrature is evaluated using rectangular-rule quadrature,
 not necessarily of the same order).</p>
<p>This algorithm is useful for integrands that are strongly 
peaked near the origin of the Brillouin zone and highly
attenuated near the boundaries, so that most of the integral
comes from the region near the origin.</p>
<p>For this algorithm, the number of integration points
used for the <script type="math/tex">k_\rho</script> and <script type="math/tex">k_\theta</script> integrals (call these
numbers <script type="math/tex">N_\rho</script> and <script type="math/tex">N_\theta</script>) are encoded 
into the value passed to <code>--BZIOrder</code>
in the form <script type="math/tex">100\times N_\rho + N_\theta,</script>
where <script type="math/tex">N_\rho</script> and <script type="math/tex">N_\theta</script> are each odd integers 
between 11 and 99 inclusive.</p>
<p>Thus, for example, <code>--BZIOrder 3321</code> specifies that the
<script type="math/tex">k_\rho</script> integral is to be evaluated via 33-point CC
cubature, while the <script type="math/tex">k_\theta</script> integral is to be evaluated
via 21-point rectangular-rule cubature.</p>
</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>
<p><strong> Polar cubature with change of variables
     <script type="math/tex">k_\rho \to k_z</script> </strong> (<code>--BZIMethod Polar2</code>)</p>
<p>This is the same as <code>--BZIMethod Polar</code>, but with
two modifications: <strong>(a)</strong> The <script type="math/tex">k_\rho</script> integral 
is split into two separate integrals covering the
ranges <script type="math/tex">k_\rho < k_0</script> and <script type="math/tex">k_\rho >k_0</script> 
(where <script type="math/tex">k_0\equiv \frac{\omega}{c}</script> is the vacuum photon
wavenumber at the frequency in question).
<strong>(b)</strong> In each of the two <script type="math/tex">k_\rho</script> integrals we
make the change of variables
<script type="math/tex; mode=display"> k_\rho \to k_z\equiv \sqrt{|k_0^2 - k_\rho^2|}.</script>
</p>
<p>These modifications are useful
for cases in which the free-space wavevector <script type="math/tex">k_0</script>
falls within the Brillouin zone. In these cases,
the convergence of the <script type="math/tex">k_\rho</script> integral is
degraded by the phenomena known as "Wood anomalies"
in optics or "van Hove singularities" in solid-state
physics, and changing variables to <script type="math/tex">k_z</script> introduces
a Jacobian factor that neutralizes these singularities
to yield a better-behaved integrand.    </p>
</li>
</ul>
<p><strong> Special <script type="math/tex">N_\theta</script> values for rotationally-invariant integrands </strong></p>
<p>As discussed above, for the <code>Polar</code> and <code>Polar2</code> integration methods
the value of the <code>--BZIOrder</code> option is interpreted as the composite 
quantity <script type="math/tex">100\times N_\rho + N_\theta</script>,
where <script type="math/tex">N_\rho</script> and <script type="math/tex">N_\theta</script> are odd integers in the range <script type="math/tex">[11,99]</script>
specifying the number of cubature points used for the <script type="math/tex">k_\rho</script> and 
<script type="math/tex">k_\theta</script> integrals (or set to 0 to request adaptive quadrature).</p>
<p>For <em>fully</em> rotationally-symmetric geometries in which the BZ integrand
<script type="math/tex">\overline{Q}</script> is independent of <script type="math/tex">k_\theta</script>, you can specify
<script type="math/tex">N_\theta=\{2,4,6\}</script> to indicate that the <script type="math/tex">k_\theta</script> integral
is to be evaluated by a 1-point cubature with the single <script type="math/tex">k_\theta</script>
sample taken at <script type="math/tex">k_\theta=\{0,\frac{\pi}{2},\frac{\pi}{4}\}</script>.</p>
<p>(Of course, no geometry discretized into triangles can actually
be fully rotationally invariant, but pretending so may be a
reasonable approximation in some cases, such as <a href="../../examples/HalfSpaceLDOS/HalfSpaceLDOS/">this one</a>.)</p>
<h4 id="symmetry-factors-for-2d-brillouin-zones">Symmetry factors for 2D Brillouin zones</h4>
<p>For 2D geometries, the option <code>--BZSymmetryFactor</code> may
take the value 2, 4, or 8, specifying that the Brillouin-zone
integrand <script type="math/tex">\overline{Q}(k_x, k_y)</script> obeys symmetries as follows:</p>
<ul>
<li>
<p><code>--BZSymmetryFactor 2</code>: </p>
<p>We have
<script type="math/tex">\overline{Q}(k_x,k_y) = \overline{Q}(k_x,-k_y),</script> so the BZ integration
may be restricted to just the right half of the BZ.</p>
</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>
<p><code>--BZSymmetryFactor 4</code>:</p>
<p>We have
<script type="math/tex">\overline{Q}(k_x,k_y) = \overline{Q}(\pm k_x, \pm k_y),</script> 
so the BZ integration
may be restricted to just the upper-right quadrant of the BZ.</p>
</li>
</ul>
<p>&nbsp;</p>
<ul>
<li><code>--BZSymmetryFactor 8</code>: 
    In addition to symmetry under sign changes, the integrand
    is symmetric under <script type="math/tex">k_x\leftrightarrow k_y</script>,
    so the BZ integration
    may be restricted to the triangular region
    <script type="math/tex">0\le k_y \le k_x \le \frac{\pi}{L_x}.</script>
    (This is only possible for square lattices.)</li>
</ul>
<h5 id="locations-of-quadrature-points-for-2d-brillouin-zones">Locations of quadrature points for 2D Brillouin zones</h5>
<p>Here are some diagrams indicating the Bloch wavevectors
that will be sampled by the internal algorithms for Brillouin-zone
integration with various values of the command-line parameters:</p>
<pre><code class="bash">--BZIMethod CC    --BZIOrder  21    --BZSymmetryFactor 1
</code></pre>

<p><img alt="CC21.SF1.png" src="../BZIDiagrams/CC21.SF1.png" /></p>
<p>&nbsp;</p>
<pre><code class="bash">--BZIMethod CC    --BZIOrder  21    --BZSymmetryFactor 2
</code></pre>

<p><img alt="CC21.SF1.png" src="../BZIDiagrams/CC21.SF2.png" /></p>
<p>&nbsp;</p>
<pre><code class="bash">--BZIMethod CC    --BZIOrder  21    --BZSymmetryFactor 4
</code></pre>

<p><img alt="CC21.SF1.png" src="../BZIDiagrams/CC21.SF4.png" />
&nbsp;</p>
<p><a name="IrreducibleBZ"></p>
<pre><code class="bash">--BZIMethod CC    --BZIOrder  21    --BZSymmetryFactor 8
</code></pre>

<p><img alt="CC21.SF1.png" src="../BZIDiagrams/CC21.SF8.png" />
&nbsp;</p>
<pre><code class="bash">--BZIMethod TC    --BZIOrder  20    --BZSymmetryFactor 1
</code></pre>

<p><img alt="TC20.SF1.png" src="../BZIDiagrams/TC20.SF1.png" /></p>
<p>&nbsp;</p>
<pre><code class="bash">--BZIMethod TC    --BZIOrder  20    --BZSymmetryFactor 2
</code></pre>

<p><img alt="TC20.SF2.png" src="../BZIDiagrams/TC20.SF2.png" /></p>
<p>&nbsp;</p>
<pre><code class="bash">--BZIMethod TC    --BZIOrder  20    --BZSymmetryFactor 4
</code></pre>

<p><img alt="TC20.SF4.png" src="../BZIDiagrams/TC20.SF4.png" />
&nbsp;</p>
<pre><code class="bash">--BZIMethod TC    --BZIOrder  20    --BZSymmetryFactor 8
</code></pre>

<p><img alt="TC20.SF8.png" src="../BZIDiagrams/TC20.SF8.png" />
&nbsp;</p>
<pre><code class="bash">--BZIMethod Polar --BZIOrder 3111 --BZSymmetryFactor 1
</code></pre>

<p><img alt="Polar.3111.SF1.png" src="../BZIDiagrams/Polar.3111.SF1.png" /></p>
<p>&nbsp;</p>
<pre><code class="bash">--BZIMethod Polar --BZIOrder 3111 --BZSymmetryFactor 2
</code></pre>

<p><img alt="Polar.3111.SF2.png" src="../BZIDiagrams/Polar.3111.SF2.png" /></p>
<p>&nbsp;</p>
<pre><code class="bash">--BZIMethod Polar --BZIOrder 3111 --BZSymmetryFactor 4
</code></pre>

<p><img alt="Polar.3111.SF4.png" src="../BZIDiagrams/Polar.3111.SF4.png" /></p>
<p>&nbsp;</p>
<pre><code class="bash">--BZIMethod Polar --BZIOrder 3111 --BZSymmetryFactor 8
</code></pre>

<p><img alt="Polar.3111.SF8.png" src="../BZIDiagrams/Polar.3111.SF8.png" /></p>
<p>&nbsp;</p>
<p><strong>Note:</strong> The next four diagrams are for a frequency of
<script type="math/tex">\frac{\omega}{c}\approx 0.32\cdot \frac{2\pi}{L}</script>. The accumulation
of points near <script type="math/tex">|\mathbf{k}_\text{B}|=\frac{\omega}{c}</script>
is noticeable for the <code>Polar2</code> integration strategy.</p>
<pre><code class="bash">--BZIMethod Polar2 --BZIOrder 1111 --BZSymmetryFactor 1
</code></pre>

<p><img alt="Polar2.1111.SF1.png" src="../BZIDiagrams/Polar2.SF1.png" /></p>
<pre><code class="bash">--BZIMethod Polar2 --BZIOrder 1111 --BZSymmetryFactor 2
</code></pre>

<p><img alt="Polar2.1111.SF2.png" src="../BZIDiagrams/Polar2.SF2.png" /></p>
<pre><code class="bash">--BZIMethod Polar2 --BZIOrder 1111 --BZSymmetryFactor 4
</code></pre>

<p><img alt="Polar2.1111.SF4.png" src="../BZIDiagrams/Polar2.SF4.png" /></p>
<pre><code class="bash">--BZIMethod Polar2 --BZIOrder 1111 --BZSymmetryFactor 8
</code></pre>

<p><img alt="Polar2.1111.SF8.png" src="../BZIDiagrams/Polar2.SF8.png" /></p>
<h5 id="locations-of-quadrature-points-for-1d-brillouin-zones">Locations of quadrature points for 1D Brillouin zones</h5>
<pre><code class="bash">--BZIMethod CC    --BZIOrder  31    --BZSymmetryFactor 1
</code></pre>

<p><img alt="CC31.SF1.1D.png" src="../BZIDiagrams/CC31.SF1.1D.png" /></p>
<p>&nbsp;</p>
<pre><code class="bash">--BZIMethod CC    --BZIOrder  31    --BZSymmetryFactor 2
</code></pre>

<p><img alt="CC31.SF2.png" src="../BZIDiagrams/CC31.SF2.1D.png" /></p>
<p>&nbsp;</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../FAQ/" class="btn btn-neutral float-right" title="FAQ"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../IncidentFields/" class="btn btn-neutral" title="Incident fields"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  <a href="http://homerreid.com/scuff-em"> 
    <span class="SmallCaps">scuff-em</span>
  </a> documentation, by
  <a href="http://homerreid.com">Homer Reid</a>

  <p>
  <font size=-1>
  Built with <a href="http://www.mkdocs.org">MkDocs</a> 
  using a customized theme modeled 
  after the 
  <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
  provided by <a href="https://readthedocs.org">Read the Docs</a>.
  </font>

</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../IncidentFields/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../FAQ/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
