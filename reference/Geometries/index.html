



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="http://homerreid.github.io/scuff-em-documentation/reference/Geometries/">
      
      
        <meta name="author" content="Homer Reid">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>Geometry descriptions - SCUFF-EM documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.8d40d89b.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,400i,700|">
        <style>body,input{font-family:"Noto Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/scuff-em.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#1-simple-geometries-one-or-more-compact-objects-possibly-nested" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://homerreid.github.io/scuff-em-documentation" title="SCUFF-EM documentation" class="md-header-nav__button md-logo">
          
            <img src="../../reference/scuffEMLogo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                SCUFF-EM documentation
              </span>
              <span class="md-header-nav__topic">
                Geometry descriptions
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/homerreid/scuff-em/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      scuff-em
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../examples/" title="Examples" class="md-tabs__link">
          Examples
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../tests/Overview/" title="Test suite" class="md-tabs__link">
          Test suite
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../TopLevel/" title="General reference" class="md-tabs__link md-tabs__link--active">
          General reference
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../applications/GeneralReference/" title="Command-line tools" class="md-tabs__link">
          Command-line tools
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../HighLevelInterface/HighLevelInterface/" title="High-level interface" class="md-tabs__link">
          High-level interface
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../API/libscuff/" title="Low-level API" class="md-tabs__link">
          Low-level API
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../forDevelopers/Implementation/" title="For developers" class="md-tabs__link">
          For developers
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../reference/scuffEMLogo.png" width="48" height="48">
      
    </span>
    SCUFF-EM documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/homerreid/scuff-em/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      scuff-em
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/" title="SCUFF-EM tutorial examples" class="md-nav__link">
      SCUFF-EM tutorial examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/MieScattering/MieScattering/" title="Mie scattering" class="md-nav__link">
      Mie scattering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/DielectricShell/DielectricShell/" title="Electrostatics of a spherical dielectric shell" class="md-nav__link">
      Electrostatics of a spherical dielectric shell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/ThinFilm/ThinFilm/" title="Spatially-resolved study of plane-wave transmission through an infinite-area thin dielectric film" class="md-nav__link">
      Spatially-resolved study of plane-wave transmission through an infinite-area thin dielectric film
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/DiffractionPatterns/DiffractionPatterns/" title="Imaging diffraction patterns of discs, disc arrays, and hole arrays in metal screens" class="md-nav__link">
      Imaging diffraction patterns of discs, disc arrays, and hole arrays in metal screens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/NanorodResonantModes/NanorodResonantModes/" title="Mode frequencies and field patterns of resonant modes in gold nanorods" class="md-nav__link">
      Mode frequencies and field patterns of resonant modes in gold nanorods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/CubeTorus/" title="Casimir forces in a compact geometry" class="md-nav__link">
      Casimir forces in a compact geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/SiliconBeams/SiliconBeams/" title="Casimir forces in a 1D extended geometry" class="md-nav__link">
      Casimir forces in a 1D extended geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/SiliconSlabs/SiliconSlabs/" title="Casimir forces in a 2D extended geometry" class="md-nav__link">
      Casimir forces in a 2D extended geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/NanostructureCasimirPolder/NanostructureCasimirPolder/" title="Casimir-Polder potentials in dielectric nanostructures" class="md-nav__link">
      Casimir-Polder potentials in dielectric nanostructures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/SiO2Spheres/SiO2Spheres/" title="Thermal radiation, heat transfer, and non-equilibrium Casimir forces between silicon dioxide spheres" class="md-nav__link">
      Thermal radiation, heat transfer, and non-equilibrium Casimir forces between silicon dioxide spheres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/TipSubstrate/TipSubstrate/" title="Spatial distribution of heat flux from a warm tip over a cold substrate" class="md-nav__link">
      Spatial distribution of heat flux from a warm tip over a cold substrate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/HalfSpaceLDOS/HalfSpaceLDOS/" title="LDOS and dyadic Green functions above an infinite aluminum half-space" class="md-nav__link">
      LDOS and dyadic Green functions above an infinite aluminum half-space
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/PlatonicSolids/PlatonicSolids/" title="Electrostatic polarizability of platonic solids" class="md-nav__link">
      Electrostatic polarizability of platonic solids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/TwoBodyCapacitors/TwoBodyCapacitors/" title="Capacitance of two-body capacitors" class="md-nav__link">
      Capacitance of two-body capacitors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/StriplineCapacitor/StriplineCapacitor/" title="Capacitance of a PCB stripline trace" class="md-nav__link">
      Capacitance of a PCB stripline trace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/ImplicitSubstrate/ImplicitSubstrate/" title="Implicit handling of multilayer dielectric substrates" class="md-nav__link">
      Implicit handling of multilayer dielectric substrates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/pythonCapacitance/pythonCapacitance/" title="Finite-size effects in stripline capacitors" class="md-nav__link">
      Finite-size effects in stripline capacitors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/PaulTrap/PaulTrap/" title="Electrostatic fields of an electrode array" class="md-nav__link">
      Electrostatic fields of an electrode array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/YagiUdaAntennas/YagiUdaAntennas/" title="Z-parameters and directivity of Yagi-Uda antennas" class="md-nav__link">
      Z-parameters and directivity of Yagi-Uda antennas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/MicrostripDevices/MicrostripDevices/" title="Input impedance, mutual coupling, and radiated fields of microstrip RF devices" class="md-nav__link">
      Input impedance, mutual coupling, and radiated fields of microstrip RF devices
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Test suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Test suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tests/Overview/" title="Overview of the test suite" class="md-nav__link">
      Overview of the test suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tests/MieScattering/MieScattering/" title="Mie scattering" class="md-nav__link">
      Mie scattering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tests/FresnelScattering/FresnelScattering/" title="Fresnel scattering" class="md-nav__link">
      Fresnel scattering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tests/CasimirSpheres/CasimirSpheres/" title="Equilibrium Casimir forces between spheres" class="md-nav__link">
      Equilibrium Casimir forces between spheres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tests/CasimirPlates/CasimirPlates/" title="Equilibrium Casimir forces between plates" class="md-nav__link">
      Equilibrium Casimir forces between plates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tests/CPSphere/CPSphere/" title="Equilibrium Casimir-Polder potential near a sphere" class="md-nav__link">
      Equilibrium Casimir-Polder potential near a sphere
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tests/CPPlate/CPPlate/" title="Equilibrium Casimir-Polder potential near a plate" class="md-nav__link">
      Equilibrium Casimir-Polder potential near a plate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tests/NEQSpheres/NEQSpheres/" title="Heat transfer and non-equilibrium Casimir forces between spheres" class="md-nav__link">
      Heat transfer and non-equilibrium Casimir forces between spheres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tests/libscuff/libscuff/" title="Low-level tests of the core library" class="md-nav__link">
      Low-level tests of the core library
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      General reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        General reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../TopLevel/" title="Top-level overview" class="md-nav__link">
      Top-level overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Installing/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
    <a href="./" title="Geometry descriptions" class="md-nav__link md-nav__link--active">
      Geometry descriptions
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EquivalentEdgeSurfacePairs/" title="Equivalent edge/surface pairs" class="md-nav__link">
      Equivalent edge/surface pairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Materials/" title="Material designations" class="md-nav__link">
      Material designations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Transformations/" title="Geometric transformations" class="md-nav__link">
      Geometric transformations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../IncidentFields/" title="Incident fields" class="md-nav__link">
      Incident fields
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../BrillouinZoneIntegration/" title="Brillouin zone integration" class="md-nav__link">
      Brillouin zone integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FAQ/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Command-line tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Command-line tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/GeneralReference/" title="General command-line reference" class="md-nav__link">
      General command-line reference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-scatter/scuff-scatter/" title="scuff-scatter" class="md-nav__link">
      scuff-scatter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-transmission/scuff-transmission/" title="scuff-transmission" class="md-nav__link">
      scuff-transmission
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-ldos/scuff-ldos/" title="scuff-ldos" class="md-nav__link">
      scuff-ldos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-tmatrix/scuff-tmatrix/" title="scuff-tmatrix" class="md-nav__link">
      scuff-tmatrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-cas3D/scuff-cas3D/" title="scuff-cas3D" class="md-nav__link">
      scuff-cas3D
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-caspol/scuff-caspol/" title="scuff-caspol" class="md-nav__link">
      scuff-caspol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-neq/scuff-neq/" title="scuff-neq" class="md-nav__link">
      scuff-neq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-rf/scuff-rf/" title="scuff-rf" class="md-nav__link">
      scuff-rf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-static/scuff-static/" title="scuff-static" class="md-nav__link">
      scuff-static
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-spectrum/scuff-spectrum/" title="scuff-spectrum" class="md-nav__link">
      scuff-spectrum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-analyze/scuff-analyze/" title="scuff-analyze" class="md-nav__link">
      scuff-analyze
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../applications/scuff-integrate/scuff-integrate/" title="scuff-integrate" class="md-nav__link">
      scuff-integrate
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      High-level interface
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        High-level interface
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../HighLevelInterface/HighLevelInterface/" title="High-Level Interface" class="md-nav__link">
      High-Level Interface
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Low-level API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Low-level API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../API/libscuff/" title="libscuff" class="md-nav__link">
      libscuff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../API/MainFlow/" title="MainFlow API" class="md-nav__link">
      MainFlow API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../API/UtilityAPI/" title="Utility API" class="md-nav__link">
      Utility API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      For developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        For developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../forDevelopers/Implementation/" title="Implementation" class="md-nav__link">
      Implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../forDevelopers/DataStructures/" title="Data Structures" class="md-nav__link">
      Data Structures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../forDevelopers/Documentation/" title="Documentation" class="md-nav__link">
      Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../forDevelopers/SingularIntegrals/" title="Code for computing singular integrals" class="md-nav__link">
      Code for computing singular integrals
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/homerreid/scuff-em/edit/master/docs/reference/Geometries.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="geometry-descriptions-in-scuff-em">Geometry Descriptions in <span class="SC">scuff-em</span></h1>
<p>Geometries in <a class="wikilink" href="../../scuff-em/">scuff-em</a> are described by simple text files 
that are conventionally given the file extension <code class="codehilite"><span class="na">.scuffgeo.</span></code> 
The <code class="codehilite"><span class="na">.scuffgeo</span></code> file format supports a variety of options for 
specifying scattering geometries.</p>
<p>The simplest case is one in which you have a collection of
compact homogeneous objects (which may be nested inside 
one another). In this case, your <code class="codehilite"><span class="na">.scuffgeo</span></code> 
file will simply specify mesh files representing the 
surfaces of these objects, as well as optional material
specifications for the frequency-dependent electrical properties
of the media inside.
(A <em>mesh</em> is a collection of flat triangular panels that 
approximates a two-dimensional surface.
<a class="wikilink" href="../../scuff-em/">scuff-em</a> doesn't do the meshing for you;
you use external meshing software such as 
<a href="http://www.geuz.org/gmsh"><span class=SC>gmsh</span></a> or
<a href="http://www.comsol.com"><span class=SC>comsol</span></a>
for that.)</p>
<p>In more complicated cases, it may not be possible to
describe your geometry as a simple collection of
objects. This is true, for example, if your geometry 
contains any <em>multi-material junctions</em>---that is, 
points at which three or more disparate media meet.
In this case your <code class="codehilite"><span class="na">.scuffgeo</span></code> file will specify 
a series of three-dimensional <em>regions</em> and a set of 
two-dimensional meshed <em>surfaces</em> lying between them.</p>
<p>Finally, your geometry may be infinitely <em>extended</em> in 
one or two directions. Examples of 1D extended geometries
include this description of
<a href="../../examples/SiliconBeams/SiliconBeams/"><em>parallel silicon beams</em></a>
while examples of 2D extended geometries include
a planar metamaterial array or an infinite square lattice
of spheres. In this case, your <code class="codehilite"><span class="na">.scuffgeo</span></code> file will
specify <em>lattice vectors</em> together with a description
of the objects, or the regions and surfaces, that constitute
just the <em>unit-cell</em> geometry, which is then infinitely
periodically replicated to constitute the actual geometry.</p>
<p>In what follows we will see how to write <code class="codehilite"><span class="na">.scuffgeo</span></code>
files that describe each of these types of geometries.</p>
<p><strong>Update, June 2018: <span class=SC>scuff-em</span> versions
0.96 and later incorporate a new optimization known as
<a href="../EquivalentEdgeSurfacePairs/"><em>automated detection of equivalent edge and surface pairs</em></a>
that can yield enormous reductions (as much as 90% or more) in the cost of assembling the
system matrix. See the <a href="../EquivalentEdgeSurfacePairs/">documentation</a> for details on 
how to exploit this features.</strong></p>
<ol class="TOC">

<p align="center">
<b>Geometry Files in <span class="SmallCaps">scuff-em</span></b>
</p>

<li> <a href="#Simple">Simple geometries: One or more compact objects (possibly nested)</a>
<li> <a href="#Complex">More complex geometries: multi-material junctions</a>
<li> <a href="#Extended">Extended geometries: periodic boundary conditions</a>
<li> <a href="#Substrate">Implicit handling of multilayered dielectric substrates</a>
<li> <a href="#Reference"><code>.scuffgeo</code> file syntax reference</a>
<li> <a href="#Examples">A compendium of <code>.scuffgeo</code> files</a>

</ol>

<p><a name="Simple"></a> </p>
<h2 id="1-simple-geometries-one-or-more-compact-objects-possibly-nested">1. Simple Geometries: One or more compact objects (possibly nested)</h2>
<p>The simplest <a class="wikilink" href="../../scuff-em/">scuff-em</a> geometries consist of 
one or more <em>compact objects</em>---that is, finite volumes of homogeneous media,
bounded by closed 2D surfaces. In this case, all meshed surfaces in the geometry 
must be <em>closed</em> surfaces, and no two object surfaces may touch or overlap.
Each surface is then associated with a single homogeneous material
region---namely, the region interior to that surface---and we collectively
refer to that material region and its closed surface as an <em>object.</em></p>
<p>The <code class="codehilite"><span class="na">.scuffgeo</span></code> file for geometries of this type consists simply 
of a sequence of <em>object declarations</em>, one for each compact object 
in the geometry. A typical object declaration section looks something 
like this:</p>
<div class="codehilite"><pre><span></span>OBJECT UpperSphere
    MESHFILE Sphere_458.msh
    MATERIAL Gold
    DISPLACED 0 0 3
    ROTATED 45 ABOUT 0 0 1
ENDOBJECT
</pre></div>

<p>The string that follows the <code class="codehilite">OBJECT</code> keyword 
(<code class="codehilite">UpperSphere</code> in this case) is an arbitrary 
user-specified label that you may attach to your object
for ease of identifying it in output files, etc. </p>
<p>The only keyword that is strictly required within the 
<code class="codehilite">OBJECT...ENDOBJECT</code> clause is <code class="codehilite">MESHFILE.</code> This specifies 
a mesh file, generated by <a class="wikilink" href="../../gmsh/">gmsh</a>, <a class="wikilink" href="../../comsol/">comsol</a>, or other meshing 
tools, describing the surface of your object. 
<a class="wikilink" href="../../scuff-em/">scuff-em</a> will look for this file in several places: </p>
<ul>
<li>the current working directory</li>
<li>the directory specified by the <code class="codehilite">SCUFF_MESH_PATH</code> environment variable</li>
<li>any search directories specified using the <code class="codehilite">MESHPATH</code> keyword in the <code class="codehilite"><span class="na">.scuffgeo</span></code> file.</li>
</ul>
<p>The latter two options allow you to set up one or more common 
repositories of mesh files which you can then re-use for 
<a class="wikilink" href="../../scuff-em/">scuff-em</a> calculations launched from whatever directory you like.</p>
<p>The optional <code class="codehilite">MATERIAL</code> keyword is used to select a 
<a href="../Materials/"><span class="SC">scuff-em</span> material designation</a>
(in this case, <code class="codehilite">Gold</code>) for the medium interior to 
your object. The actual definition of the material <code class="codehilite">Gold</code>
(given by a <code class="codehilite">MATERIAL...ENDMATERIAL</code> clause)
may be present in the <code class="codehilite"><span class="na">.scuffgeo</span></code> file before the 
<code class="codehilite">OBJECT</code> specification, or may exist in a separate 
material database file. If you don't specify a <code class="codehilite">MATERIAL</code>
for your object, it will be treated as a perfectly electrically 
conducting (PEC) body. </p>
<p>The optional <code class="codehilite">DISPLACED</code> and <code class="codehilite">ROTATED</code>
keywords specify geometrical transformations 
that are applied to the surface mesh after it is read in from 
the mesh file. For example, if your mesh file describes a sphere 
centered around the origin, and you include the line 
<code class="codehilite">DISPLACED 0 0 3</code> in your <code class="codehilite">OBJECT...ENDOBJECT</code>
clause, then your geometry as interpreted by 
<a class="wikilink" href="../../scuff-em/">scuff-em</a> will contain a sphere
centered around the point with cartesian coordinates 
(0,0,3). For more details, see the 
<a href="#Reference">syntax reference</a>
below.</p>
<p>Your <code class="codehilite"><span class="na">.scuffgeo</span></code> file may contain any number of
<code class="codehilite">OBJECT...ENDOBJECT</code> clauses.
The objects specified by these clauses may be 
<a href="#NestedSpheres"><em>nested</em></a>,
i.e. one object may be fully contained inside another 
object; this will be autodetected by <a class="wikilink" href="../../scuff-em/">scuff-em</a>.</p>
<p>(However, this simple way of specifying geometries has 
the constraint that no two object surfaces may touch or intersect. 
If you find yourself needing to describe geometries involving 
objects whose surface touch---thus defining <em>multi-material junctions</em>---you
you have graduated to writing the 
<a href="#Complex">slightly more complicated type of <code class="codehilite"><span class="na">.scuffgeo</span></code> file described below</a>.)</p>
<p>Here's an example of a simple <code class="codehilite"><span class="na">.scuffgeo</span></code> file describing 
a smaller PEC sphere embedded inside a larger silicon dioxide
sphere.</p>
<div class="codehilite"><pre><span></span># material specification for intrinsic silicon
MATERIAL SILICON
epsf = 1.035;      # \epsilon_infinity
eps0 = 11.87;      # \epsilon_0 
wp = 6.6e15;       # \plasmon frequency
Eps(w) = epsf + (eps0-epsf)/(1-(w/wp)^2);
ENDMATERIAL


OBJECT SiliconSphere 
MESHFILE Sphere_R1P0.msh
MATERIAL Silicon
ENDOBJECT 


OBJECT InnerSphere 
MESHFILE Sphere_R0P5.msh
MATERIAL PEC
ENDOBJECT 
</pre></div>

<p><img alt="SphericalShell" src="../SphericalShell.png" /></p>
<p>Note that the <code class="codehilite">MATERIAL PEC</code> specification for the 
inner sphere is actually superfluous---we could simply have 
omitted it, because PEC is the default material assumed for 
<code class="codehilite">OBJECT</code> clauses. On the other hand, if we had 
instead said <code class="codehilite">MATERIAL Vacuum</code>, then we would be 
describing an <em>vacuum</em> sphere inside our larger 
silicon sphere---that is, a spherical <em>shell</em> of silicon,
as considered in 
<a href="../../examples/DielectricShell/DielectricShell/">this <span class="SmallCaps">scuff-scatter</span> example</a>.</p>
<p><a name="Complex"></a></p>
<h2 id="2-more-complex-geometries-multi-material-junctions">2. More complex geometries: multi-material junctions</h2>
<p>The attempt to describe a geometry simply as a collection of compact objects 
breaks down for more complicated situations. For example, consider the composite 
sphere (or "bihemisphere") depicted in the figure below; this is a spherical
object formed by adjoining an upper hemisphere of material A to a lower 
hemisphere of material B. </p>
<p><strong>Schematic depiction of a Bihemisphere</strong></p>
<p><img alt="BiHemisphere" src="../BiHemisphere.png" /></p>
<p><strong>Mesh representations of the three interface surfaces</strong>
(shown displaced for clarity)</p>
<p><img alt="BiHemisphereMesh" src="../BiHemisphereMesh.png" /></p>
<p>Our first thought might be to think of the upper hemispherical volume as one 
compact object, and the lower hemispherical volume as a second compact object.
But this doesn't work, because we can't assign a unique closed surface to each
compact object. Clearly the upper hemispherical surface "belongs" to object 
<code class="codehilite">UpperHemisphere,</code> and the lower hemispherical surface "belongs" to
object <code class="codehilite">LowerHemisphere.</code> But to which volume do we assign the surface 
of the equatorial plane?</p>
<p>More formally, the key aspect of the bihemisphere geometry that prevents 
it from being describable as a collection of compact objects is the presence
of <em>multi-material junctions</em>---that is, regions of the geometry 
at which three or more homogeneous material regions meet. The equator of 
the bihemisphere is a multi-material junction. </p>
<p>(A note on terminology: In <a class="wikilink" href="../../scuff-em/">scuff-em</a> parlance,
a multi-material junction (MMJ) is a point or line 
at which <em>three or more</em> homogeneous regions meet.
Of course any meshed surface in a geometry---including 
the closed surfaces used to describe simple compact-object 
geometries above---lies at the junction of
at least <em>two</em> regions, and is thus technically 
a "multi-material" junction, but is not considered 
an MMJ for the purposes of the present discussion.)</p>
<p>Geometries involving multi-material junctions are described in 
<a class="wikilink" href="../../scuff-em/">scuff-em</a> by explicitly 
specifying the various <em>regions</em> and <em>surfaces</em> 
that are present. Each <em>region</em> is a contiguous volume 
throughout which the material properties are spatially constant.
Each <em>surface</em> is a mesh describing a closed <em>or open</em> 
2D surface represented as a 
union of flat triangular panels. Each surface must lie at the 
interface between precisely two regions.</p>
<p>For example, in the bihemisphere geometry, there are three 
regions: </p>
<ul>
<li>The exterior medium (vacuum).</li>
<li>The upper hemispherical volume (material A).</li>
<li>The lower hemispherical volume (material B).</li>
</ul>
<p>And there are three surfaces:</p>
<ul>
<li>The upper hemispherical surface, which is an interface between regions 1 and 2.</li>
<li>The lower hemispherical surface, which is an interface between regions 1 and 3.</li>
<li>The surface of the equatorial plane, which is an interface between regions 2 and 3.</li>
</ul>
<p>The <code class="codehilite"><span class="na">.scuffgeo</span></code> file for geometry described
using regions and surfaces will consist, unsurprisingly,
of <code class="codehilite">REGION</code> lines and 
<code class="codehilite">SURFACE...ENDSURFACE</code> clauses.</p>
<p>Each <code class="codehilite">REGION</code> line should look something like this:</p>
<div class="codehilite"><pre><span></span>REGION UpperHemisphereVolume MATERIAL Gold
</pre></div>

<p>The string identifier following the <code class="codehilite">REGION</code> keyword is an 
arbitrary label you may assign to your region. The string identifier
following the <code class="codehilite">MATERIAL</code> keyword is a 
[<span class="SmallCaps">scuff-em</span> material designation][Materials]
specifying the frequency-dependent material properties 
of the region.</p>
<p>All <a class="wikilink" href="../../scuff-em/">scuff-em</a> geometries by default
start off with an implicitly defined region
named <code class="codehilite">Exterior</code>, of material <code class="codehilite">VACUUM</code>.
If you want to change the material properties of the 
exterior medium---for example, if your entire scattering geometry
is embedded in ethanol---you can say something like </p>
<div class="codehilite"><pre><span></span>REGION Exterior MATERIAL Ethanol
</pre></div>

<p>Otherwise, you can refer freely to the region named 
<code class="codehilite">Exterior</code> without defining it, as it will 
be automatically present in all <a class="wikilink" href="../../scuff-em/">scuff-em</a>
geometries.</p>
<p>Surfaces in a regions-and-surfaces geometry are identified 
by <code class="codehilite">SURFACE...ENDSURFACE</code> clauses.
These are similar to <code class="codehilite">OBJECT...ENDOBJECT</code> 
clauses, but with a couple of differences. A typical 
example looks like this:</p>
<div class="codehilite"><pre><span></span>SURFACE UpperHemisphereSurface
    MESHFILE UpperHemisphereSurface.msh
    REGIONS Exterior UpperHemisphereVolume
ENDSURFACE
</pre></div>

<p>The string identifier following the <code class="codehilite">SURFACE</code> keyword
is an arbitrary label you may assign to your surface to 
help identify it in output files, etc.</p>
<p>The mandatory <code class="codehilite">MESHFILE</code> keyword specifies the 
name of a file from which <a class="wikilink" href="../../scuff-em/">scuff-em</a>
will attempt to read the surface mesh.</p>
<p>The mandatory <code class="codehilite">REGIONS</code> keyword identifies the two 
regions that lie on the two sides of the surface.
These should be regions that were previously declared using 
<code class="codehilite">REGION</code> statements (with the exception of the
region <code class="codehilite">Exteror</code>, which is always implicitly 
present.)</p>
<p>The <em>order</em> in which you specify surfaces is 
important for the internal workings of <a class="wikilink" href="../../scuff-em/">scuff-em</a>,
although most output quantities reported by most 
<a class="wikilink" href="../../scuff-em/">scuff-em</a> codes will not depend on 
this ordering.</p>
<p>The distinction is this: The surface normal vector is taken to 
point <em>into</em> the first region specified with the 
<code class="codehilite">REGIONS</code> keyword, and thus <em>away from</em> the second
region. What this means internally is that surface currents on 
the surface contribute to the fields in the first region with a 
<em>positive</em> sign, and to the fields in the second region 
with a <em>negative</em> sign. Again, however, this is all handled 
consistently within the internal workings of the code, so flipping
the order in the <code class="codehilite">REGION</code> specification should not
lead to any differences in physically relevant output quantities.
(If you flip the order of the regions, the currents on the surface
change sign, and their contributions to the fields in each region
change sign, so the fields don't change.)</p>
<p>In addition to the mandatory <code class="codehilite">MESHFILE</code> 
and <code class="codehilite">REGIONS</code> keyword, the <code class="codehilite">SURFACE...ENDSURFACE</code>
may also include <code class="codehilite">DISPLACED</code> and/or <code class="codehilite">ROTATED</code>
statements to apply geometrical transforms to your surface,
as is possible in <code class="codehilite">OBJECT...ENDOBJECT</code> clauses.</p>
<p>Note that any geometry that may be represented in the simpler
form discussed above (as a sequence of <code class="codehilite">OBJECT...ENDOBJECT</code>
clauses) may also be represented in the regions-and-surfaces 
language. 
A compact object consists of a single region (the interior of 
the object) and a single surface (lying at the interface between
the interior and exterior regions). Thus, if the meshfile 
<code class="codehilite">MySphere.msh</code> represents a meshed sphere, then the 
following two <code class="codehilite"><span class="na">.scuffgeo</span></code> files are equivalent:</p>
<div class="codehilite"><pre><span></span>REGION SphereInterior MATERIAL Gold

SURFACE TheSphere
MESHFILE Sphere.msh
REGIONS  Exterior SphereInterior
ENDSURFACE
</pre></div>

<div class="codehilite"><pre><span></span>OBJECT TheSphere
MESHFILE Sphere.msh
MATERIAL Gold
ENDSURFACE
</pre></div>

<p>(And see <a href="#NestedSpheres">below</a> for an example of how to 
rewrite the nested-spheres example from above
in the regions-and-surfaces language.)</p>
<p>In some cases it may be convenient to write a single meshfile
that contains mesh descriptions for multiple surfaces 
in your geometry. This may be done by including a
<code class="codehilite">MESHTAG</code> specification in your 
<code class="codehilite">SURFACE...ENDSURFACE</code> clause:</p>
<div class="codehilite"><pre><span></span>SURFACE MySurface
    MESHFILE MyMeshFile.msh
    MESHTAG 12
    REGIONS MyRegion1 MyRegion2
ENDSURFACE
</pre></div>

<p>What this does is to instruct <a class="wikilink" href="../../scuff-em/">scuff-em</a> to
read from <code class="codehilite">MyMeshFile.msh</code> only those triangular panels
that have been tagged by the meshing program as belonging 
to entity 12. 
(Different meshing programs have different ways of tagging mesh 
entities. In <a class="wikilink" href="../../gmsh/">gmsh</a>, the tag corresponds to
what <a class="wikilink" href="../../gmsh/">gmsh</a> calls the "physical region;"
it is the argument that enters statements
such as <code class="codehilite">Physical Surface(12)={...}</code> in the <code class="codehilite"><span class="na">.geo</span></code>
file, and it is the number printed as the <em><code class="codehilite">physical-number</code></em>
field in the <code class="codehilite"><span class="na">.msh</span></code> output file.)</p>
<p>As an example, here's a <code class="codehilite"><span class="na">.scuffgeo</span></code> file for the bihemisphere 
geometry described above. The meshfile <code class="codehilite">BiHemisphere_126.msh</code>
was produced by a <a class="wikilink" href="../../gmsh/">gmsh</a> file named 
[BiHemisphere.geo](BiHemisphere.geo};
note that the three separate interface surfaces
are created with three separate <code class="codehilite">Physical Surface</code>
commands, each specifying a different tag, which is then used 
in the <code class="codehilite"><span class="na">.scuffgeo</span></code> file below to distinguish different 
entities in the <code class="codehilite"><span class="na">.msh</span></code> file.</p>
<div class="codehilite"><pre><span></span>REGION Exterior        MATERIAL VACUUM
REGION UpperHemisphere MATERIAL CONST_EPS_20
REGION LowerHemisphere MATERIAL CONST_EPS_2

SURFACE LowerHemisphereSurface 
    MESHFILE BiHemisphere_126.msh
    MESHTAG 1
    REGIONS Exterior LowerHemisphere
ENDSURFACE

SURFACE UpperHemisphereSurface 
    MESHFILE BiHemisphere_126.msh
    MESHTAG 2
    REGIONS Exterior UpperHemisphere
ENDSURFACE

SURFACE EquatorialPlane
    MESHFILE BiHemisphere_126.msh
    PHYSICAL_REGION 3
    REGIONS UpperHemisphere LowerHemisphere
ENDSURFACE
</pre></div>

<h1 id="3-extended-geometries-periodic-boundary-conditions">3. Extended geometries: periodic boundary conditions</h1>
<p><a class="wikilink" href="../../scuff-em/">scuff-em</a> can handle geometries that are
infinitely extended (that is, periodically repeated) in one or two
dimensions using Bloch-periodic boundary conditions. In this case,
your <code class="codehilite"><span class="na">.scuffgeo</span></code> file will contain a specification of 
the objects, or the surfaces and regions, that constitute the 
<em>unit-cell</em> geometry, together with a specification of the 
<em>lattice vectors</em> that describe how the unit cell is periodically
repeated.</p>
<blockquote>
<p><strong>Note</strong>: The current version of <a class="wikilink" href="../../scuff-em/">scuff-em</a> 
requires that 2D lattice basis vectors have vanishing <em>z</em>
component and that 1D lattice basis vectors have vanishing
<em>y</em> and <em>z</em> components. In other words, for 2D periodicity
the lattice vectors must live in the <em>xy</em> plane, while
for 1D periodicity the lattice vector must be aligned 
with the <em>x</em> axis. This places no restriction on the 
actual geometric configurations that may be treated, but 
may be inconvenient for some users who are accustomed to 
setting up their periodic geometries in a different way.
(For example, if you are studying thin films, and you are 
used to having the film surfaces parallel to the <em>yz</em>
plane with the film thickness in the <em>x</em> direction, you will
need to rotate your coordinate system so that the surfaces 
re parallel to the <em>xy</em> plane and the thickness is in 
the <em>z</em> direction.) This limitation may be lifted in 
a future code release.</p>
<p><strong>Note</strong>: An additional restriction in the current version
of <a class="wikilink" href="../../scuff-em/">scuff-em</a> is that 2D lattices must be <em>rectangular</em> 
lattices: the first <code class="codehilite">LATTICE</code> vector must have only its 
<script type="math/tex">x</script> component nonzero, while the second <code class="codehilite">LATTICE</code> vector 
must have only its <script type="math/tex">y</script> component nonzero (although the two 
vectors may have different lengths).
. This actually <em>does</em> place restrictions on 
the geometries that may be treated (for example, it 
excludes hexagonal lattices), and it will be remedied
as soon as somebody wants to run calculations on a 
non-square-lattice geometry and is willing to help me
test the new feature.</p>
</blockquote>
<p>The lattice is specified using a <code class="codehilite">LATTICE...ENDLATTICE</code>
section. For example, a square lattice with lattice constant 
of 1 <script type="math/tex">\mu</script>m would look like this: </p>
<div class="codehilite"><pre><span></span>LATTICE
VECTOR 1 0 
VECTOR 0 1 
ENDLATTICE 
</pre></div>

<p>Each <code class="codehilite">VECTOR xx yy</code> statement adds a new lattice vector
with cartesian components of <code class="codehilite">(xx,yy)</code> length units.</p>
<p>You may specify one or two <code class="codehilite">VECTOR</code> statements.
If you specify a single <code class="codehilite">VECTOR</code>, your unit-cell
geometry will be periodically repeated in just that one direction.
If you specify two <code class="codehilite">VECTOR</code> statements, your unit-cell
geometry will be periodically repeated in a two-dimensional lattice
pattern.</p>
<p>Having specified the lattice vectors, the remainder of your 
<code class="codehilite"><span class="na">.scuffgeo</span></code> file just consists of a specification of 
the unit-cell geometry as if it were a standalone compact 
geometry. For example, you may include <code class="codehilite">OBJECT...ENDOBJECT</code> 
sections to describe any compact objects that exist inside 
the unit cell, or <code class="codehilite">REGION</code> statements and <code class="codehilite">SURFACE...ENDSURFACE</code>
sections to describe more complicated unit-cell geometries.</p>
<h2 id="compact-objects-fully-contained-in-the-unit-cell">Compact objects fully contained in the unit cell</h2>
<p>The simplest case is that in which your geometry is simply 
an array of isolated compact objects (with "isolated" here meaning 
that each object does not touch its periodically repeated images.)
In this case, you will want to make sure that the objects 
lie entirely within the unit cell (not straddling its boundaries),</p>
<p>For example, here's a <code class="codehilite"><span class="na">.scuffgeo</span></code> file describing
a square lattice of cubical nanoparticles:</p>
<p><strong> The unit cell geometry </strong></p>
<p><img alt="CubeUnitCell.png" src="../CubeUnitCell.png" /></p>
<p><strong> The innermost 25 cells of the full geometry </strong></p>
<p><img alt="CubeLattice.png" src="../CubeLattice.png" /></p>
<p><strong> The <code class="codehilite"><span class="na">.scuffgeo</span></code> file </strong> 
<div class="codehilite"><pre><span></span>LATTICE
VECTOR 0.5  0
VECTOR 0.0  0.5
ENDLATTICE 

OBJECT CubicalNanoparticle
MESHFILE Cube.msh
MATERIAL Silicon
ENDOBJECT
</pre></div></p>
<h2 id="surfaces-that-straddle-the-unit-cell-boundary">Surfaces that straddle the unit-cell boundary</h2>
<p>More generally, your unit-cell geometry may include surfaces 
that straddle the unit-cell boundary. (This will be the case 
whenever the infinite surfaces you are describing are 
<em>connected</em>, as opposed to the isolated arrays of objects
considered above). For example, here's a <code class="codehilite"><span class="na">.scuffgeo</span></code>
file representing a thin metallic film perforated by an 
array of holes. The parameters here are chosen to mimic 
the geometry studied by 
<a href="http://prl.aps.org/abstract/PRL/v86/i6/p1114_1">Martin-Moreno et al, <em>Physical Review Letters</em> <strong>86</strong> 1114 (2001).</a></p>
<p><strong> The unit cell geometry</strong></p>
<p><img alt="PTFUnitCell1.png" src="../PTFUnitCell1.png" /></p>
<p><strong>The innermost 25 cells of the full geometry</strong></p>
<p><img alt="PTFLattice.png" src="../PTFLattice.png" /></p>
<p><strong> The <code class="codehilite"><span class="na">.scuffgeo</span></code> file</strong>
<div class="codehilite"><pre><span></span>LATTICE
VECTOR 0.75  0
VECTOR 0.0   0.75
ENDLATTICE 

OBJECT UnitCellMesh
MESHFILE PFT_794.msh
MATERIAL Gold
ENDOBJECT
</pre></div></p>
<h2 id="meshing-constraints-for-surfaces-that-straddle-the-unit-cell-boundary">Meshing constraints for surfaces that straddle the unit-cell boundary</h2>
<p>There is an important constraint on the surface meshes that may be<br />
used to define the unit-cell geometry for problems involving continuous symmetries.</p>
<p>The constraint is this: 
<em>For any panel edge that lies on a unit-cell 
boundary, there must be an identical edge lying on the opposite 
side of the unit-cell boundary.</em> One way to think about this is 
that the periodically-repeated images of the unit-cell geometry must 
all fit together "nicely" at the unit-cell boundaries, as indicated 
in the right panel of the figure above.</p>
<p><a name="Substrate"></a></p>
<h1 id="4-implicit-handling-of-multilayered-material-substrates">4. Implicit handling of multilayered material substrates</h1>
<p>As of October 2017, <span class=SC>scuff-em</span> now offers
built-in support for calculations in the presence of a
multilayered material substrate, with the effect of the
substrate handled <em>implicitly</em> through the use of an
appropriately modified Green's function.</p>
<p>A multilayered material substrate consists of one or
more layers of homogeneous material, stacked in the <em>z</em>
direction and with infinite extent in the <em>x</em> and <em>y</em>
directions; each layer may have arbitrary user-specified
frequency-dependent dielectric permittivity and magnetic 
permeability described by a 
[<span class=SC>scuff-em</span> material designation][Materials].
The substrate may optionally be terminated below
by a perfectly conducting ground plane; if a ground
plane is not present, the lowest material layer
in the stack extends to negative infinity in 
the <script type="math/tex">z</script>-direction (i.e. it is a half-space). (If you
want to describe a substrate consisting of <script type="math/tex">N</script>
finite-thickness layers, just add an <script type="math/tex">N+1</script>th layer
of vacuum.)</p>
<p>To include a substrate in your geometry,
simply include a <code class="codehilite">SUBSTRATE...ENDSUBSTRATE</code> clause
in your <code class="codehilite"><span class="na">.scuffgeo</span></code> file. Each intermediate line in
this clause should either be of the form</p>
<div class="codehilite"><pre><span></span> zValue   MaterialName
</pre></div>

<p>to add a layer of material <code class="codehilite">MaterialName</code> whose
uppermost surface has <em>z</em>-coordinate <code class="codehilite">zValue</code>; or</p>
<div class="codehilite"><pre><span></span> zGP      GROUNDPLANE 
</pre></div>

<p>to specify that your substrate has a perfectly-conducting
ground plane at <em>z</em>=<code class="codehilite">zGP</code>. (All other layers must lie
above <code class="codehilite">zGP.</code>)</p>
<p>Here are some examples of <code class="codehilite">SUBSTRATE</code> definition
sections in <code class="codehilite"><span class="na">.scuffgeo</span></code> files.</p>
<ul>
<li>An SiO2 layer of thickness 2 length units atop an
infinite silicon half-space, with the upper surface of the
SiO2 lying at <script type="math/tex">z=0</script>:</li>
</ul>
<div class="codehilite"><pre><span></span>SUBSTRATE
  <span class="m">0</span>.0  SiO2
 -2.0  Silicon
ENDSUBSTRATE
</pre></div>

<ul>
<li>Same as above, but now with a finite-thickness silicon
layer of thickness 5 length units terminated below by
a ground plane:</li>
</ul>
<div class="codehilite"><pre><span></span>SUBSTRATE
  <span class="m">0</span>.0  SiO2
 -2.0  Silicon
 -7.0  GROUNDPLANE
ENDSUBSTRATE
</pre></div>

<ul>
<li>Same as above, but now without the ground plane, so that 
finite-thickness silicon layer is simply suspended in air
with vacuum below:</li>
</ul>
<div class="codehilite"><pre><span></span>SUBSTRATE
  <span class="m">0</span>.0  SiO2
 -2.0  Silicon
 -7.0  VACUUM
ENDSUBSTRATE
</pre></div>

<h3 id="checking-substrate-specifications-with-scuff-analyze">Checking substrate specifications with <span class=SC>scuff-analyze</span></h3>
<p>If your <code class="codehilite"><span class="na">.scuffgeo</span></code> file contains a <code class="codehilite">SUBSTRATE</code> section,
it will be properly interpreted by <code class="codehilite">scuff-analyze,</code>
which will print a little description of your multilayered
structure. For example, running <code class="codehilite">scuff-analyze</code> on a
<code class="codehilite"><span class="na">.scuffgeo</span></code> file containing the above <code class="codehilite">SUBSTRATE</code> 
clause yields, after the usual <code class="codehilite">scuff-analyze</code> data dump,
the following output:</p>
<div class="codehilite"><pre><span></span>***********************************************
*  SUBSTRATE:
***********************************************
Region  <span class="m">0</span> <span class="o">(</span>VACUUM              <span class="o">)</span>: <span class="o">[</span>       inf &lt; z &lt; <span class="m">0</span>         <span class="o">]</span>
Region  <span class="m">1</span> <span class="o">(</span>SiO2                <span class="o">)</span>: <span class="o">[</span>         <span class="m">0</span> &lt; z &lt; -2        <span class="o">]</span>
Region  <span class="m">2</span> <span class="o">(</span>Silicon             <span class="o">)</span>: <span class="o">[</span>        -2 &lt; z &lt; -7        <span class="o">]</span>
Region  <span class="m">3</span> <span class="o">(</span>Vacuum              <span class="o">)</span>: <span class="o">[</span>        -7 &lt; z &lt; -inf      <span class="o">]</span>
</pre></div>

<p>Note that the infinite half-space lying above the
substrate (which in this case is vacuum)
is considered the first (uppemost) region of the
substrate.</p>
<p>For more information on the implementation
of material substrates in <span class=SC>scuff-em</span>,
see these memos:</p>
<p>+<a href="../../tex/StaticDielectricSubstrate.pdf">"Implicit handling of multilayered dielectric substrates in <span class=SC>scuff-static</span>"</a></p>
<p>+<a href="../../tex/FullWaveSubstrate.pdf">"Implicit handling of multilayered dielectric substrates in full-wave <span class=SC>scuff-em</span>"</a></p>
<p><a name="Reference"></a></p>
<h1 id="5-syntax-reference-for-the-scuffgeo-file-format">5. Syntax reference for the <code class="codehilite"><span class="na">.scuffgeo</span></code> file format</h1>
<p>A <code class="codehilite"><span class="na">.scuffgeo</span></code> file consists of one or more multiline
<em>sections</em> (delimited by starting and ending keywords)
plus zero or more single-line <em>statements</em>.</p>
<p>Blank lines and comments (lines beginning with a <code class="codehilite">#</code> symbol)
are ignored in <code class="codehilite"><span class="na">.scuffgeo</span></code> files.</p>
<h3 id="meshpath-statement"><code class="codehilite">MESHPATH</code> statement</h3>
<table width="75%" align="center" border="1" cellpadding="5" cellspacing="5">

<tr> <th width="200"> Keyword </th> 
<th> Description </th> 
</tr>

<tr> 
<td> <code>MESHPATH</code> <b><i>my-mesh-path</i></b></td>
<td> Adds the directory <b><i>my-mesh-path</i></b>
     to the path searched by <span class="SmallCaps">scuff-em</span> 
     for mesh files.
</td>
</tr> 
</table>

<h3 id="region-statement"><code class="codehilite">REGION</code> statement</h3>
<table width="75%" align="center" border="1" cellpadding="5" cellspacing="5">

<tr> <th width="200"> Keyword </th> 
<th> Description </th> 
</tr>

<tr> 
<td> <code>REGION</code> <b><i>Name</i></b>
     <code>MATERIAL</code> <b><i>Material</i></b>
</td>
<td> 
     Adds a new homogeneous material region
     to the geometry with name <b><i>Name</b></i>
     and material properties described by the     
     <span class="SmallCaps">scuff-em</span> 
     material designation <b><i>Material</i></b>.

     As discussed above, <code>REGION</code>
     statements are <i>not needed</i>
     for geometries consisting of compact homogeneous
     bodies described by <code>OBJECT</code> sections.
     (Each <code>OBJECT</code> section automatically
     adds a new region to the problem for the interior
     of the object in question.) <code>REGION</code>
     statements are generally only necessary when your 
     geometry contains 
     <a href="#Complex">multi-material junctions.</a>

</td>
</tr> 
</table>

<h3 id="objectendobject-sections"><code class="codehilite">OBJECT...ENDOBJECT</code> sections</h3>
<table width="75%" align="center" border="1" cellpadding="5" cellspacing="5">

<tr> <th width="200"> Keyword </th> 
<th> Description </th> 
</tr>

<tr> 
<td> <code>OBJECT</code> <b><i>object label</i></b> </td>
<td> Begins an object declaration for an object with the specified
label.
</td>
</tr> 

<tr> 
<td> <code>MESHFILE</code> <b><i>MyFile.msh</i></b> </td>
<td> Specifies the mesh file that defines the closed surface
     of the object.
</td>
</tr> 

<tr> 
<td> <code>MESHTAG </code> <b><i>xx</i></b> </td>
<td> Specifies that only panels tagged in the mesh
     file with tag <b><i>xx</i></b> are to be considered 
     part of the surface of this object. This allows a
     single <code>.msh</code> file to contain multiple
     closed surfaces each defining distinct objects.
</td>
</tr> 

<tr> 
<td> <code>MATERIAL </code> <b><i>MyMaterial</i></b> </td>
<td> Specifies a <span class="SmallCaps">scuff-em</span>
     material designation for the homogeneous medium
     interior to the object.
</td>
</tr> 

<tr> 
<td> <code>DISPLACED</code> <b><i>xx yy zz</i></b> </td>
<td> Indicates that the contents of the specified mesh 
file are to be translated through a displacement vector with 
cartesian components (<b><i>xx, yy, zz</i></b>before
inclusion in the geometry.
</td>
</tr>

<tr> 
<td> <code>ROTATED</code> <b><i>dd</i></b> <code>ABOUT</code> <b><i>nx ny nz</i></b> </td>
<td> Indicates that the contents of the specified mesh 
file are to be rotated through an angle of <b><i>dd</i></b>
degrees (<b>degrees, not radians</b>) about an axis passing 
through the origin and through the point with cartesian coordinates
(<b><i>nx, ny, nz/</i></b>before inclusion in the geometry.
</td>
</tr> 

<tr> 
<td> <code>ENDOBJECT</code></td>
<td> Ends the object declaration.
</td>
</tr> 
</table>

<h3 id="surfaceendsurface-sections"><code class="codehilite">SURFACE...ENDSURFACE</code> sections</h3>
<h3 id="latticeendlattice-sections"><code class="codehilite">LATTICE...ENDLATTICE</code> sections</h3>
<h3 id="materialendmaterial-sections"><code class="codehilite">MATERIAL...ENDMATERIAL</code> sections</h3>
<blockquote>
<p>For details on how to write a <code class="codehilite">MATERIAL</code> section,
see <a href="../Materials/">here</a>.</p>
</blockquote>
<p><a name="Examples"></a> </p>
<h1 id="6-a-compendium-of-sample-scuffgeo-files">6. A compendium of sample <code class="codehilite"><span class="na">.scuffgeo</span></code> files</h1>
<p>The images corresponding to the <code class="codehilite"><span class="na">.scuffgeo</span></code> files below were 
obtained using the <code class="codehilite">scuff-analyze</code> utility distributed with 
the <a class="wikilink" href="../../scuff-em/">scuff-em</a> suite, like this:</p>
<div class="codehilite"><pre><span></span>% scuff-analyze --geometry MyGeometry.scuffgeo --WriteGMSHFiles
</pre></div>

<p>This produces a <a class="wikilink" href="../../gmsh/">gmsh</a> post-processing file 
named <code class="codehilite">MyGeometry.pp</code> that you can open in 
<a class="wikilink" href="../../gmsh/">gmsh</a> to visualize your geometry and
make sure <a class="wikilink" href="../../scuff-em/">scuff-em</a> interpreted your 
<code class="codehilite"><span class="na">.scuffgeo</span></code> file as you intended.
This is generally a good thing to do before launching any serious
calculations.</p>
<p><a name="SingleSphere"></a>
<strong>A single perfectly electrically conducting (PEC) sphere</strong></p>
<p>This is perhaps the simplest imaginable <a class="wikilink" href="../../scuff-em/">scuff-em</a>
geometry.</p>
<div class="codehilite"><pre><span></span>OBJECT PECSphere 
    MESHFILE Sphere.msh
ENDOBJECT 
</pre></div>

<p><img alt="Sphere" src="../Sphere.png" /></p>
<hr />
<p><a name="TwoSpheres"></a>
<strong>A gold sphere and a silicon sphere</strong></p>
<p>This example illustrates the use of the <code class="codehilite">DISPLACED</code>
keyword to displace a surface mesh relative to its positioning 
in the mesh file. Note in particular that this keyword allows
us to use the same mesh file to describe two different spheres,
which speeds things up by allowing <a class="wikilink" href="../../scuff-em/">scuff-em</a> 
to reuse certain parts of the calculation, thus eliminating
redundant numerical work. (Without the <code class="codehilite">DISPLACED</code> 
keyword in this example, the two spheres would be sitting on 
top of one another.)</p>
<div class="codehilite"><pre><span></span>MATERIAL SILICON
  epsf = 1.035;      # \epsilon_infinity
  eps0 = 11.87;      # \epsilon_0 
  wp = 6.6e15;       # \plasmon frequency
  Eps(w) = epsf + (eps0-epsf)/(1-(w/wp)^2);
ENDMATERIAL

MATERIAL GOLD
  wp = 1.37e16; 
  gamma = 5.32e13;
  Eps(w) = 1 - wp^2 / (w * (w + i*gamma));
ENDMATERIAL

MESHPATH /home/homer/work/MeshFiles

OBJECT GoldSphere
  MESHFILE Sphere.msh
  MATERIAL Gold
  DISPLACED 0 0 3
ENDOBJECT 

OBJECT SiliconSphere
  MESHFILE Sphere.msh
  MATERIAL Silicon
ENDOBJECT 
</pre></div>

<p><img alt="TwoSpheres.png" src="../TwoSpheres.png" /></p>
<hr />
<p><a name="NestedSpheres"></a>
<strong>A small gold sphere inside a larger silicon dioxide sphere</strong></p>
<div class="codehilite"><pre><span></span>MATERIAL SILICON
  epsf = 1.035;      # \epsilon_infinity
  eps0 = 11.87;      # \epsilon_0 
  wp = 6.6e15;       # \plasmon frequency
  Eps(w) = epsf + (eps0-epsf)/(1-(w/wp)^2);
ENDMATERIAL

OBJECT SiliconSphere 
  MESHFILE Sphere_R1P0.msh
  MATERIAL Silicon
ENDOBJECT 


OBJECT InnerSphere 
  MESHFILE Sphere_R0P5.msh
  MATERIAL PEC
ENDOBJECT 
</pre></div>

<p><img alt="SphericalShell" src="../SphericalShell.png" /></p>
                
                  
                
              
              
                



  <h2 id="__comments">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "http://homerreid.github.io/scuff-em-documentation/reference/Geometries/";
      this.page.identifier =
        "/reference/Geometries/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//homerreid-github-io-scuff-em-documentation.disqus.com.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Installing/" title="Installation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Installation
              </span>
            </div>
          </a>
        
        
          <a href="../EquivalentEdgeSurfacePairs/" title="Equivalent edge/surface pairs" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Equivalent edge/surface pairs
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../.."}})</script>
      
        <script src="../../javascripts/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../../javascripts/mathjaxhelper.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-119340518-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>