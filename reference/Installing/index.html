<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installation - SCUFF-EM documentation</title>
  

  <link rel="shortcut icon" href="../../scuffEM.ico">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "reference/Installing"
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
  <script src="../../mathjaxhelper.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">

      <p align="center"
      <a href="../..">
         <img align="center" height="auto" width="100%"  
              src="../../img/scuffEMNavBar.png"
      </a>

      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> SCUFF-EM documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">SCUFF-EM documentation</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Examples</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/MieScattering/MieScattering/">Mie scattering</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/DielectricShell/DielectricShell/">Electrostatics of a spherical dielectric shell</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/ThinFilm/ThinFilm/">Spatially-resolved study of plane-wave transmission through an infinite-area thin dielectric film</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/DiffractionPatterns/DiffractionPatterns/">Imaging diffraction patterns of discs, disc arrays, and hole arrays in metal screens</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/CubeTorus/">Casimir forces in a compact geometry</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/SiliconBeams/SiliconBeams/">Casimir forces in a 1D extended geometry</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/SiliconSlabs/SiliconSlabs/">Casimir forces in a 2D extended geometry</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/NanostructureCasimirPolder/NanostructureCasimirPolder/">Casimir-Polder potentials in dielectric nanostructures</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/SiO2Spheres/SiO2Spheres/">Thermal radiation, heat transfer, and non-equilibrium Casimir forces between silicon dioxide spheres</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/TipSubstrate/TipSubstrate/">Spatial distribution of heat flux from a warm tip over a cold substrate</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/HalfSpaceLDOS/HalfSpaceLDOS/">LDOS and dyadic Green functions above an infinite aluminum half-space</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/PlatonicSolids/PlatonicSolids/">Electrostatic polarizability of platonic solids</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/TwoBodyCapacitors/TwoBodyCapacitors/">Capacitance of two-body capacitors</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/StriplineCapacitor/StriplineCapacitor/">Capacitance of a PCB stripline trace</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/ImplicitSubstrate/ImplicitSubstrate/">Implicit handling of multilayer dielectric substrates</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/pythonCapacitance/pythonCapacitance/">Finite-size effects in stripline capacitors</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/PaulTrap/PaulTrap/">Electrostatic fields of an electrode array</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../examples/YagiUdaAntennas/YagiUdaAntennas/">Z-parameters and directivity of Yagi-Uda antennas</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>General reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../TopLevel/">Top-level overview</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Installation</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#external-packages">External packages</a></li>
                
            
                <li class="toctree-l3"><a href="#status-of-the-github-repository">Status of the GitHub repository</a></li>
                
            
                <li class="toctree-l3"><a href="#setting-up-an-informative-command-line-prompt">Setting up an informative command-line prompt</a></li>
                
            
                <li class="toctree-l3"><a href="#configure-options">Configure options</a></li>
                
                    <li><a class="toctree-l4" href="#specifying-the-installation-prefix">Specifying the installation prefix</a></li>
                
                    <li><a class="toctree-l4" href="#specifying-locations-of-external-libraries">Specifying locations of external libraries</a></li>
                
                    <li><a class="toctree-l4" href="#using-the-mpi-compilers">Using the MPI compilers</a></li>
                
                    <li><a class="toctree-l4" href="#disabling-the-python-interface-to-speed-the-build-process">Disabling the python interface to speed the build process</a></li>
                
                    <li><a class="toctree-l4" href="#parallel-make">Parallel make</a></li>
                
            
                <li class="toctree-l3"><a href="#2-installing-on-debianubuntu-based-linux-systems">2. Installing on Debian/Ubuntu-based Linux systems</a></li>
                
                    <li><a class="toctree-l4" href="#a-use-apt-get-to-install-external-packages">A. Use apt-get to install external packages</a></li>
                
                    <li><a class="toctree-l4" href="#b-clone-the-github-repository-and-build-the-code">B. Clone the GitHub repository and build the code</a></li>
                
            
                <li class="toctree-l3"><a href="#3-installing-on-macos">3. Installing on MacOS</a></li>
                
                    <li><a class="toctree-l4" href="#a-use-xcode-and-homebrew-to-install-external-packages">A. Use xcode and homebrew to install external packages</a></li>
                
                    <li><a class="toctree-l4" href="#b-clone-the-github-repository-and-build-the-code_1">B. Clone the GitHub repository and build the code</a></li>
                
            
                <li class="toctree-l3"><a href="#4-installing-on-windows">4. Installing on Windows</a></li>
                
            
                <li class="toctree-l3"><a href="#5-run-a-scuff-em-computational-example-and-check-cpu-utilization">5. Run a scuff-em computational example and check CPU utilization</a></li>
                
            
                <li class="toctree-l3"><a href="#6-building-for-debugging">6. Building for debugging</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Geometries/">Geometry descriptions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Materials/">Material designations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Transformations/">Geometric transformations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../IncidentFields/">Incident fields</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../BrillouinZoneIntegration/">Brillouin zone integration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../FAQ/">FAQ</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Command-line application reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/GeneralReference/">General command-line reference</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-scatter/scuff-scatter/">scuff-scatter</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-transmission/scuff-transmission/">scuff-transmission</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-ldos/scuff-ldos/">scuff-ldos</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-tmatrix/scuff-tmatrix/">scuff-tmatrix</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-cas3D/scuff-cas3D/">scuff-cas3D</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-caspol/scuff-caspol/">scuff-caspol</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-neq/scuff-neq/">scuff-neq</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-RF/scuff-RF/">scuff-RF</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-static/scuff-static/">scuff-static</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-spectrum/scuff-spectrum/">scuff-spectrum</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-analyze/scuff-analyze/">scuff-analyze</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../applications/scuff-integrate/scuff-integrate/">scuff-integrate</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Validation tests</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/Overview/">Overview of the test suite</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/MieScattering/MieScattering/">Mie scattering</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/FresnelScattering/FresnelScattering/">Fresnel scattering</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/CasimirSpheres/CasimirSpheres/">Equilibrium Casimir forces between spheres</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/CasimirPlates/CasimirPlates/">Equilibrium Casimir forces between plates</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/CPSphere/CPSphere/">Equilibrium Casimir-Polder potential near a sphere</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/CPPlate/CPPlate/">Equilibrium Casimir-Polder potential near a plate</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/NEQSpheres/NEQSpheres/">Heat transfer and non-equilibrium Casimir forces between spheres</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tests/libscuff/libscuff/">Low-level tests of the core library</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>API reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../API/libscuff/">libscuff</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>For developers</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../forDevelopers/Implementation/">Implementation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../forDevelopers/DataStructures/">Data Structures</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../forDevelopers/Documentation/">Documentation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../forDevelopers/SingularIntegrals/">Code for computing singular integrals</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">SCUFF-EM documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.."><span class="SmallCaps">scuff-em</span> documentation</a> &raquo;</li>
    
      
        
          <li>General reference &raquo;</li>
        
      
    
    <li>Installation</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/homerreid/scuff-em/" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1>Installing <span class=SC>scuff-em</span></h1>

<p>The <span class=SC>scuff-em</span> source distribution is packaged with the standard
<a href="https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html"><span class=SC>gnu autotools</span></a>
build environment. If you have experience installing <span class=SC>autotools</span>-based
software packages, you should have no trouble installing <span class=SC>scuff-em</span>
via your typical procedures, although you are encouraged to skim 
the <a href="#GeneralComments">general comments</a> section below before you start.</p>
<p>If you <em>aren't</em> an <span class=SC>autotools</span> expert, you should still be
able to install <span class=SC>scuff-em</span> without much trouble by following
the OS-specific instructions below.</p>
<p><strong>In either case, if you have any trouble installing <span class=SC>scuff-em</span>,
please <a href="https://github.com/HomerReid/scuff-em/issues">file an issue on the <span class=SC>scuff-em</span> GitHub page</a>.</strong></p>
<div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#1-general-comments-about-installing-scuff-em">1. General comments about installing <span class=SC>scuff-em</span></a><ul>
<li><a href="#external-packages">External packages</a></li>
<li><a href="#status-of-the-github-repository">Status of the GitHub repository</a></li>
<li><a href="#setting-up-an-informative-command-line-prompt">Setting up an informative command-line prompt</a></li>
<li><a href="#configure-options">Configure options</a><ul>
<li><a href="#specifying-the-installation-prefix">Specifying the installation prefix</a></li>
<li><a href="#specifying-locations-of-external-libraries">Specifying locations of external libraries</a></li>
<li><a href="#using-the-mpi-compilers">Using the MPI compilers</a></li>
<li><a href="#disabling-the-python-interface-to-speed-the-build-process">Disabling the python interface to speed the build process</a></li>
<li><a href="#parallel-make">Parallel make</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#2-installing-on-debianubuntu-based-linux-systems">2. Installing on Debian/Ubuntu-based Linux systems</a><ul>
<li><a href="#a-use-apt-get-to-install-external-packages">A. Use <span class=SC>apt-get</span> to install external packages</a></li>
<li><a href="#b-clone-the-github-repository-and-build-the-code">B. Clone the GitHub repository and build the code</a></li>
</ul>
</li>
<li><a href="#3-installing-on-macos">3. Installing on MacOS</a><ul>
<li><a href="#a-use-xcode-and-homebrew-to-install-external-packages">A. Use <span class=SC>xcode</span> and <span class=SC>homebrew</span> to install external packages</a></li>
<li><a href="#b-clone-the-github-repository-and-build-the-code_1">B. Clone the GitHub repository and build the code</a></li>
</ul>
</li>
<li><a href="#4-installing-on-windows">4. Installing on Windows</a></li>
<li><a href="#5-run-a-scuff-em-computational-example-and-check-cpu-utilization">5. Run a <span class=SC>scuff-em</span> computational example and check CPU utilization</a></li>
<li><a href="#6-building-for-debugging">6. Building for debugging</a></li>
</ul>
</div>
<p><a name="#GeneralComments"></a></p>
<h1 id="1-general-comments-about-installing-scuff-em">1. General comments about installing <span class=SC>scuff-em</span></h1>
<h2 id="external-packages">External packages</h2>
<p><a class="wikilink" href="../../scuff-em/">scuff-em</a> relies on a small number of well-established free open-source
software packages to implement certain non-essential functionality (see
the OS-specific instructions below for guidance on how to install these).
<a class="wikilink" href="../../scuff-em/">scuff-em</a> 
can be compiled and installed without any of these packages, 
but in this case the code will be somewhat crippled.</p>
<ul>
<li>
<p>If you actually want to solve scattering problems (instead of
  just setting them up), you will need
  <a href="http://www.netlib.org/lapack">LAPACK/BLAS</a> or an equivalent
  replacement such as the Intel MKL. If you do not already have your
  own favorite solution for this, I highly recommend the excellent
  open-source (<span class=SC>openblas</span>)(http://www.openblas.net/)
  package, which includes both LAPACK and BLAS and automatically
  tunes itself for optimal performance on your hardware.</p>
</li>
<li>
<p>If you want the capacity to write output files in the
  standard HDF5 binary format, you will need
  <a href="http://www.hdfgroup.org/HDF5">HDF5</a>.</p>
</li>
<li>
<p>If you want to compile the <a class="wikilink" href="../../python/">python</a> interface, you will need the
  <a class="wikilink" href="../../python/">python</a> development files and the <a class="wikilink" href="../../numpy/">numpy</a> package,
  as well as the <a href="http://www.swig.org"><span class=SC>swig</sc></a>
  interface-generator package.</p>
</li>
</ul>
<p>+</span> Although not required to install, compile, or use
  <a class="wikilink" href="../../scuff-em/">scuff-em</a>,
  <a href="http://geuz.org/gmsh"><span class="SC">gmsh</span></a>
  is an extremely valuable open-source meshing and visualization
  tool that is used throughout the
  <a class="wikilink" href="../../scuff-em/">scuff-em</a> documentation.</p>
<h2 id="status-of-the-github-repository">Status of the GitHub repository</h2>
<p>After installing external packages, you will fetch the <span class=SC>scuff-em</span>
source code from its repository hosted on <a href="https://github.com/HomerReid/scuff-em/">GitHub</a> (see specific
instructions below).
The current build status of the <a class="wikilink" href="../../scuff-em/">scuff-em</a> master branch is:</p>
<p><img alt="Build Status" src="https://travis-ci.org/HomerReid/scuff-em.svg?branch=master" /></p>
<p><a name="UsefulPrompt"></a></p>
<h2 id="setting-up-an-informative-command-line-prompt">Setting up an informative command-line prompt</h2>
<p>Regardless of the specific OS you're running (Linux, MacOS,
or Windows), the installation process will involve typing
commands at a prompt in a console window. Unfortunately, 
in most cases the default prompt is not particularly
informative---in particular, it doesn't tell you the
current working directory (which can be easy to forget
when switching among folders in a complex build process)
or the current host name (which can be easy to forget
when you're frequently logging in and out of remote
machines.) Thus, for command-line work I find it useful
to set up a prompt that includes this information, which
you can do as follows:</p>
<pre><code class="bash">% export PS1='$HISTCMD '`hostname`' $PWD &lt;&gt; '
34 mac-56-129-14.mit.edu /Users/homereid &lt;&gt; 
</code></pre>

<p>Note that the prompt now tells me my current working
directory (<code>/Users/homereid</code>) and the name of the
machine (<code>mac-56-129-14.mit.edu</code>) so I don't lose track
of where I am. (The <code>34</code> refers to the number of commands
I've executed in this console session thus far.)</p>
<p>If you find the above command useful, you may copy
it into your <code>${HOME}/.bashrc</code> file, in which case
the informative prompt will be set up automatically 
whenever you open a console window.</p>
<h2 id="configure-options">Configure options</h2>
<p>After fetching the source tree, you will run a command that automatically sniffs out
the environment on your machine to <em>configure</em> the procedure that will be used to
build <span class=SC>scuff-em</span>. As detailed in the OS-specific instructions 
below, this command takes the form</p>
<pre><code class="bash"> % sh autogen.sh [OPTIONS]
</code></pre>

<p>the first time you run it after fetching the source, or simply</p>
<pre><code class="bash"> % configure [OPTIONS]
</code></pre>

<p>on subsequent builds. For the most part, this step will
 <em>automatically</em> handle the various things that need to be done to setup the
build process, but you may <em>guide</em> the process by specifying
various options manually (in the space labeled <code>[OPTIONS]</code> above).
Here are a few of the more salient options you may wish to specify
to customize your build.</p>
<h4 id="specifying-the-installation-prefix">Specifying the installation prefix</h4>
<p>If the build process succeeds, all files needed to
run <span class=SC>scuff-em</span> calculations---including
executable programs, library files, and example calculations---will
be automatically installed in subdirectories of a top-level
directory known as the <em>prefix.</em> The default prefix is <code>/usr/local/,</code>
but you may wish to install <span class=SC>scuff-em</span>
in a different location---in particular, you will <em>need</em> to do this
if you don't have administrator privileges on the machine you 
are using. This may be done via the configure option <code>--prefix=/path/to/scuff/installation.</code></p>
<p>For example, to install <span class=SC>scuff-em</span> in
a subdirectory of your home directory named <code>scuff-em-installation,</code>
you can say</p>
<pre><code class="bash">% configure --prefix=${HOME}/scuff-em-installation [other options]
</code></pre>

<p>In this case, after the <span class=SC>scuff-em</span> installation
has completed, the various installed files will be in the following
locations:</p>
<ul>
<li>
<p>Binary executable files (like <code>scuff-scatter</code> and <code>scuff-rf</code>) will be in <code>${HOME}/scuff-em-installation/bin.</code></p>
</li>
<li>
<p>Library files (like <code>libscuff.so</code>) will be in <code>${HOME}/scuff-em-installation/lib.</code></p>
</li>
<li>
<p>The <span class=SC>scuff-em</span> example files (like <code>YagiUdaAntennas</code>) will be in <code>${HOME}/scuff-em-installation/share/scuff-em/examples.</code></p>
</li>
</ul>
<p>If you go this route, you will probably want to add the location
of the <span class=SC>scuff-em</span> binary executables to your execution
path by saying</p>
<pre><code class="bash"> % export PATH=${PATH}:${HOME}/scuff-em-installation/bin
</code></pre>

<p>Now you will be able to run command-line codes like <code>scuff-rf</code>
from any directory and the OS will know where to find the
program file.</p>
<p><a name="HDF5Locations"></a></p>
<h4 id="specifying-locations-of-external-libraries">Specifying locations of external libraries</h4>
<p>In some cases, external packages used in the SCUFF-EM compilation
process may be installed in non-standard locations on your system.
In this case, you may need to set the <code>CPPFLAGS</code> and/or <code>LDFLAGS</code>
environment variables to specify the locations of library header
files and binary files, respectively.</p>
<p>For example, on my (Ubuntu-based) Linux system, the HDF5 library
is provided by the <code>libhdf5-openmpi-dev</code> package, which
places the HDF5 header files in <code>/usr/include/hdf5/openmpi</code> and
the HDF5 library binaries in <code>/usr/lib/x86_64-linux-gnu/hdf5/openmpi.</code>
Thus, when I <code>configure</code> to build <span class=SC>scuff-em</span>
I specify these paths, like this:</p>
<pre><code class="bash"> % configure CPPFLAGS=-I/usr/include/hdf5/openmpi LDFLAGS=-L/usr/lib/x86_64-linux-gnu/hdf5/openmpi [other options]
</code></pre>

<p>Note: To figure out where a package like <code>libhdf5-openmpi-dev</code> installs
its files, you can use the command <code>dpkg --listfiles</code>:</p>
<pre><code class="bash">% dpkg --listfiles libhdf5-openmpi-dev

....
....
/usr/include/hdf5/openmpi/H5PTpublic.h
/usr/include/hdf5/openmpi/H5api_adpt.h
....
....
/usr/lib/x86_64-linux-gnu/hdf5/openmpi/libhdf5_hl.a
/usr/lib/x86_64-linux-gnu/hdf5/openmpi/libhdf5.a
....
....

</code></pre>

<p><a name="openMPI"></a></p>
<h4 id="using-the-mpi-compilers">Using the MPI compilers</h4>
<p><span class=SC>scuff-em</span> makes heavy use of
<a href="http://www.openmp.org/"><span class=SC>openmp</span>-based shared-memory multithreading</a> to accelerate tasks
such as BEM matrix assembly. Compiling with OpenMP support is enabled by default, but if you wish to <em>disable</em> it
you may use the <code>--without-openmp</code> option to <code>configure.</code> (But you will be sacrificing a lot of speed if your 
system has more than one CPU core available!)</p>
<p>In some cases, you may need to use the MPI-aware compilers when 
building <span class=SC>scuff-em</span>; this is true, in particular,
if you are using a parallel version of the HDF5 libraries.
In this case, 
just set the <code>CC</code> and <code>CXX</code> environment variables to
the names of the MPI C and C++ compilers (usually <code>mpicc</code> and <code>mpic++</code>) before
configuring:</p>
<pre><code class="bash">% export CC=mpicc
% export CXX=mpic++
% ./configure [OPTIONS]
</code></pre>

<p><a name="Disabling Python"></a></p>
<h4 id="disabling-the-python-interface-to-speed-the-build-process">Disabling the python interface to speed the build process</h4>
<p>Compiling the python interface is slow---it accounts for
more than half of the build time on some systems.
If you don't need the python interface to <a class="wikilink" href="../../scuff-em/">scuff-em</a>,
use the configure option <code>--without-python</code> 
to accelerate the build process.</p>
<h4 id="parallel-make">Parallel make</h4>
<p>As described in the OS-specific instructions below,
after the configure process is finished you will type <code>make install</code>
to proceed with the actual build and installation of the code.
If your machine has more than one CPU core, you can accelerate
this process by saying e.g.</p>
<pre><code class="bash">% make -j 8 install
</code></pre>

<p>(replace <code>8</code> by the actual number of CPU cores on your machine).</p>
<!------------------------------------------------------>

<!------------------------------------------------------>

<!------------------------------------------------------>

<p><a name="Linux"></a></p>
<h1 id="2-installing-on-debianubuntu-based-linux-systems">2. Installing on Debian/Ubuntu-based Linux systems</h1>
<h3 id="a-use-apt-get-to-install-external-packages">A. Use <span class=SC>apt-get</span> to install external packages</h3>
<p>On Debian/Ubuntu Linux systems, you can fetch all of the external packages mentioned above as follows:</p>
<pre><code class="bash">% sudo apt-get install libopenblas-dev libhdf5-openmpi-dev python-dev python3-scipy gmsh
</code></pre>

<h3 id="b-clone-the-github-repository-and-build-the-code">B. Clone the GitHub repository and build the code</h3>
<p>The procedure should now be as simple as </p>
<pre><code class="bash">% git clone https://github.com/HomerReid/scuff-em.git
% cd scuff-em
% sh autogen.sh --prefix=${HOME}/scuff-em-installation
% make -j 8 install
</code></pre>

<p>(In the last line, replace <code>8</code> with the number of CPU cores
on your machine.)</p>
<p>As discussed above, if this succeeds, the executable files
for the <span class=SC>scuff-em</span> application modules
(such as <code>scuff-scatter</code>, <code>scuff-rf</code>, etc.) will be 
installed in the directory <code>${HOME}/scuff-em-installation/bin/,</code>
and the demonstration examples for the various application programs 
will be in <code>${HOME}/scuff-em-installation/share/scuff-em/examples.</code>
At this point you may proceed to <a href="../PerformanceCheck">running a computational example
and verifying CPU utilization</a>.</p>
<!------------------------------------------------------>

<!------------------------------------------------------>

<!------------------------------------------------------>

<p><a name="MacOS"></a></p>
<h1 id="3-installing-on-macos">3. Installing on MacOS</h1>
<p>The following installation procedure succeeded for me
on MacOS Sierra 10.12.3 with 
<a href="https://developer.apple.com/xcode">XCode version 8.1</a>
and 
<a href="https://brew.sh/">HomeBrew</a> pre-installed.
All commands are to be
entered at the console prompt of a terminal window
(and, if you wish, after <a href="#UsefulPrompt">setting up an informative prompt</a> to help you keep track of where you are in the filesystem).</p>
<h3 id="a-use-xcode-and-homebrew-to-install-external-packages">A. Use <span class=SC>xcode</span> and <span class=SC>homebrew</span> to install external packages</h3>
<h4>A1. Install command-line tools for Apple developer suite</h4>

<pre><code class="bash"> % xcode-select --install
</code></pre>

<h4>A2. Use homebrew to install required open-source packages</h4>

<pre><code class="bash"> % brew update
 % brew install gcc --without-multilib
 % brew install autoconf automake hdf5 openblas
</code></pre>

<p>The second command here appears to be necessary---even if
GCC is already installed on your system---to build anything
with OpenMPI support, which <a href="../openMPI">(as noted above)</a>
is important for achieving good <span class=SC>scuff-em</span>
performance on machines with more than one CPU core.</p>
<p>You will most likely also want to install
<a href="http://gmsh.info/"><span class=SC>gmsh</span></a>. (Although
<a class="wikilink" href="../../gmsh/">gmsh</a> is available within HomeBrew, the HomeBrew-installed 
version seemed to be lacking graphics support when I tried it, 
so instead I installed it from the 
<a href="http://gmsh.info/"><span class=SC>gmsh</span> website</a>, but YMMV.)</p>
<h3 id="b-clone-the-github-repository-and-build-the-code_1">B. Clone the GitHub repository and build the code</h3>
<p>On the system I used (MacOS Sierra 10.12.3, XCode version
8.1), the setup protocol outlined above has the following quirks:</p>
<ul>
<li>OpenMPI codes must be compiled with <code>gcc-7</code> or <code>g++-7</code> with the <code>-fopenp</code> compiler flag.</li>
<li>The Homebrew installation of <span class=SC>openblas</span> leaves it in a nonstandard location, which must then be specified explicitly when building codes.</li>
</ul>
<p>The following script accomodates these quirks
while fetching the latest <span class=SC>scuff-em</span> source
repository from GitHub, building, and installing in the
parent directory specified by the <code>--prefix</code> option below:</p>
<pre><code class="bash">#!/bin/bash

export CC=&quot;gcc-7 -fopenmp&quot;
export CXX=&quot;g++-7 -fopenmp&quot;
export CPPFLAGS=&quot;-I/usr/local/opt/openblas/include&quot;
export LDFLAGS&quot;=-L/usr/local/opt/openblas/lib&quot;
export BLAS_LIBS=&quot;-lopenblas&quot;

git clone https://GitHub.com/HomerReid/scuff-em.git
cd scuff-em
sh autogen.sh --prefix=${HOME}/scuff-em-installation

make install -j 4
</code></pre>

<p>As discussed above, for a system with e.g. 8 CPU cores
you would say <code>make -j 8</code> instead of <code>make -j 4</code> in
the last line.</p>
<p>If this succeeds , you may proceed to <a href="../PerformanceCheck">running a computational example
and verifying CPU utilization</a>.</p>
<!------------------------------------------------------>

<!------------------------------------------------------>

<!------------------------------------------------------>

<p><a name="Windows"></a></p>
<h1 id="4-installing-on-windows">4. Installing on Windows</h1>
<!------------------------------------------------------>

<!------------------------------------------------------>

<!------------------------------------------------------>

<p><a name="PerformanceCheck"></a></p>
<h1 id="5-run-a-scuff-em-computational-example-and-check-cpu-utilization">5. Run a <span class=SC>scuff-em</span> computational example and check CPU utilization</h1>
<p>If the build and installation succeed, you're in business
to run a <span class=SC>scuff-em</span> calculation
and verify that your machine's resources are being 
fully utilized. For example, to compute 
<a href="../../examples/YagiUdaAntennas">input impedance vs. frequency for a Yagi-Uda antenna</a>, try:</p>
<pre><code class="bash">export PATH=${PATH}:${HOME}/scuff-em-installation/bin
cd ${HOME}/scuff-em-installation/share/scuff-em/examples/YagiUdaAntennas
. RunScript.SZParms
</code></pre>

<p>This calculation should take anywhere between 10 seconds and a minute
depending on your CPU configuration. While the calculation is 
running in one terminal window, open a second terminal window and
run <code>top</code> to monitor system performance---in particular,
to verify that <code>scuff-rf</code> is properly using all of your CPU 
cores. On the system I used, which has 4 CPU cores, this looks
like this:</p>
<p><img alt="Screen shot of top output" src="../TopOnMacOS.png" /></p>
<p>The red-framed portion of the display here is the part you
care about: you want the CPU utilization reported
for <code>scuff-rf</code> to be close to <script type="math/tex">N\times 100\%</script>, where <script type="math/tex">N</script> is the
number of CPU cores on your machine. If you see something like this,
then <span class=SC>scuff-em</span> was built properly to 
take advantage of your machine's resources. On the other hand,
if the CPU utilization reported for <code>scuff-rf</code> bounces around
near 100 %, then (assuming your machine has more than one CPU 
core!) your <span class=SC>scuff-em</span> build is suboptimal---calculations
will work and will yield correct answers, but at a fraction
the speed that should be available on your machine.</p>
<p><strong>Note:</strong> On some (but not all) Linux systems I have
found it necessary to set the environment variable <code>GOMP_CPU_AFFINITY</code>
to achieve maximum multithreaded performance in 
<span class=SC>scuff-em</span> calculations. If you have an 8-core
machine, say something like</p>
<pre><code class="bash">% export GOMP_CPU_AFFINITY=&quot;0-7&quot;
</code></pre>

<p>(for a machine with <code>N</code> cores, replace the <code>7</code> with <code>N-1</code>).
I don't understand why this is needed in some cases but not
others---if you have any ideas let me know!</p>
<!------------------------------------------------------>

<!------------------------------------------------------>

<!------------------------------------------------------>

<p><a name="Debugging"></a></p>
<h1 id="6-building-for-debugging">6. Building for debugging</h1>
<p>If you would like to run <a class="wikilink" href="../../scuff-em/">scuff-em</a> API codes in a debugger
like <a href="https://www.gnu.org/software/gdb"><span class="SC">gdb</sc></a>,
you will want to modify the build options to <strong>(a)</strong> include
debugging symbols, <strong>(b)</strong> turn off optimization, <strong>(c)</strong>
disable <a class="wikilink" href="../../openmp/">openmp</a> multithreading, which does not play well
with <a class="wikilink" href="../../GDB/">GDB</a>. </p>
<p>Here is the script that works for me to achieve these goals:</p>
<pre><code class="bash">#!/bin/bash

CC=&quot;gcc -ggdb -O0&quot;
CXX=&quot;g++ -ggdb -O0&quot;
export CFLAGS=&quot;-O0&quot;
export CXXFLAGS=&quot;-O0&quot;
sh autogen.sh --enable-debug --without-openmp --disable-shared
</code></pre>

<p>(It shouldn't be necessary to have to add <code>-O0</code> to both the
environment variables and the compiler command lines, but
this seems to be the only way things work for me.)</p>
<p>After running this script to reconfigure for building with
compiling support, you will want to <code>make clean; make</code>
to rebuild everything with debugging support. Of course,
after you are finished debugging you will need to reconfigure
with debugging support removed and then re-do the 
clean build. Because this is time-consuming, I typically
maintain two separate copies of the code base, one for
debugging and one for running at full speed.</p>
<p>Once debugging support has been added, you can run 
the code in <a class="wikilink" href="../../gdb/">gdb</a>. Here's a sample session:</p>
<pre><code class="bash"> % gdb /path/to/debug/repository/bin/scuff-ldos

 (gdb) set args &lt; scuff-ldos.args

 (gdb) break GetHalfSpaceDGFs
Breakpoint 1 at 0x409626: file AnalyticalDGFs.cc, line 217.

 (gdb) run

Breakpoint 1, GetHalfSpaceDGFs (Omega=..., kBloch=0x7fffffffd5c0, 
    zp=0.10000000000000001, LBasis=0x7fffffffd380, MP=0x130a7c0, RelTol=0.01, 
    AbsTol=1e-10, MaxCells=1000, GE=0x7fffffffd3a0, GM=0x7fffffffd430)
    at AnalyticalDGFs.cc:217

217   double BZVolume=GetRLBasis(LBasis, RLBasis);

(gdb) print Omega
$1 = {_M_value = 0.10000000000000001 + 0 * I}

(gdb) u 230

GetHalfSpaceDGFs (Omega=..., kBloch=0x7fffffffd5c0, zp=0.10000000000000001, 
    LBasis=0x7fffffffd380, MP=0x130a7c0, RelTol=0.01, AbsTol=1e-10, 
    MaxCells=1000, GE=0x7fffffffd3a0, GM=0x7fffffffd430)
    at AnalyticalDGFs.cc:230

230   cdouble Sum[18];

(gdb) print Data-&gt;Epsilon
$2 = {_M_value = -45765.335680436379 + 115960.58424811834 * I}
</code></pre>

<p><strong>Note</strong>: If you have a better debugging solution that 
does not require steps <strong>(b)</strong> and/or <strong>(c)</strong> above , please
let me know about it. It stinks to have to run the codes
at greatly reduced speed when debugging, because often the
problem spots lie after expensive sections like BEM matrix
assembly, and then it takes forever for the code to run
in the debugger to get there.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Geometries/" class="btn btn-neutral float-right" title="Geometry descriptions"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../TopLevel/" class="btn btn-neutral" title="Top-level overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  <a href="http://homerreid.com/scuff-em"> 
    <span class="SmallCaps">scuff-em</span>
  </a> documentation, by
  <a href="http://homerreid.com">Homer Reid</a>

  <p>
  <font size=-1>
  Built with <a href="http://www.mkdocs.org">MkDocs</a> 
  using a customized theme modeled 
  after the 
  <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
  provided by <a href="https://readthedocs.org">Read the Docs</a>.
  </font>

</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../TopLevel/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Geometries/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
