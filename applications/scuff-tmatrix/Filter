#!/bin/bash

#
# Filter     -- a simple little script to extract T-matrix entries 
#            -- with specific row and column indices from the .TMatrix
#            -- data file generated by scuff-TMatrix
#
# usage:
#
# To extract diagonal T-matrix entries:
#
#   Filter MyFile.TMatrix P L M 
#
# To extract off-diagonal T-matrix entries:
#
#   Filter MyFile.TMatrix P L M PPrime LPrime MPrime
#
# homer reid -- 8/2012
#

if [ $# -eq 7 ] 
then
  INFILE=$1
  TYPE=$2
  LV=$3
  MV=$4
  TYPEP=$5
  LVP=$6
  MVP=$7
  EXT=${TYPE}${LV}${MV}.${TYPEP}${LVP}${MVP}
elif [ $# -eq 4 ]
then
  INFILE=$1
  TYPE=$2
  LV=$3
  MV=$4
  TYPEP=$2
  LVP=$3
  MVP=$4
  EXT=${TYPE}${LV}${MV}
else
  echo "usage example: Filter MyFile.TMatrix M 2 -1 [ E 1 3 ]"
  exit
fi

AWKSCRIPT="\$2==\"${TYPEP}\" && \$3==${LVP} && \$4==${MVP} && \$5==\"${TYPE}\" && \$6==${LV} && \$7==${MV} {printf(\" %e %e %e \\n\", \$1, \$8, \$9)}"

echo AWKSCRIPT is ${AWKSCRIPT}

OUTFILE=${INFILE%%.*}
awk "${AWKSCRIPT}" ${INFILE} > ${OUTFILE}
