<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>scuff-spectrum - SCUFF-EM documentation</title>
  

  <link rel="shortcut icon" href="../../../scuffEM.ico">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "applications/scuff-spectrum/scuff-spectrum"
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script>
  <script src="../../../js/theme.js"></script> 
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
  <script src="../../../mathjaxhelper.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">

      <p align="center"
      <a href="../../..">
         <img align="center" height="auto" width="100%"  
              src="../../../img/scuffEMNavBar.png"
      </a>

      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> SCUFF-EM documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../..">SCUFF-EM documentation</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Examples</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/MieScattering/MieScattering/">Mie scattering</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/DielectricShell/DielectricShell/">Electrostatics of a spherical dielectric shell</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/ThinFilm/ThinFilm/">Spatially-resolved study of plane-wave transmission through an infinite-area thin dielectric film</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/DiffractionPatterns/DiffractionPatterns/">Imaging diffraction patterns of discs, disc arrays, and hole arrays in metal screens</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/CubeTorus/">Casimir forces in a compact geometry</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/SiliconBeams/SiliconBeams/">Casimir forces in a 1D extended geometry</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/SiliconSlabs/SiliconSlabs/">Casimir forces in a 2D extended geometry</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/NanostructureCasimirPolder/NanostructureCasimirPolder/">Casimir-Polder potentials in dielectric nanostructures</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/SiO2Spheres/SiO2Spheres/">Thermal radiation, heat transfer, and non-equilibrium Casimir forces between silicon dioxide spheres</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/TipSubstrate/TipSubstrate/">Spatial distribution of heat flux from a warm tip over a cold substrate</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/HalfSpaceLDOS/HalfSpaceLDOS/">LDOS and dyadic Green functions above an infinite aluminum half-space</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/PlatonicSolids/PlatonicSolids/">Electrostatic polarizability of platonic solids</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/TwoBodyCapacitors/TwoBodyCapacitors/">Capacitance of two-body capacitors</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/StriplineCapacitor/StriplineCapacitor/">Capacitance of a PCB stripline trace</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/ImplicitSubstrate/ImplicitSubstrate/">Implicit handling of multilayer dielectric substrates</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/pythonCapacitance/pythonCapacitance/">Finite-size effects in stripline capacitors</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/PaulTrap/PaulTrap/">Electrostatic fields of an electrode array</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../examples/YagiUdaAntennas/YagiUdaAntennas/">Z-parameters and directivity of Yagi-Uda antennas</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>General reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../reference/TopLevel/">Top-level overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../reference/Installing/">Installation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../reference/Geometries/">Geometry descriptions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../reference/Materials/">Material designations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../reference/Transformations/">Geometric transformations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../reference/IncidentFields/">Incident fields</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../reference/BrillouinZoneIntegration/">Brillouin zone integration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../reference/FAQ/">FAQ</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Command-line application reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../GeneralReference/">General command-line reference</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../scuff-scatter/scuff-scatter/">scuff-scatter</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../scuff-transmission/scuff-transmission/">scuff-transmission</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../scuff-ldos/scuff-ldos/">scuff-ldos</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../scuff-tmatrix/scuff-tmatrix/">scuff-tmatrix</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../scuff-cas3D/scuff-cas3D/">scuff-cas3D</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../scuff-caspol/scuff-caspol/">scuff-caspol</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../scuff-neq/scuff-neq/">scuff-neq</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../scuff-RF/scuff-RF/">scuff-RF</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../scuff-static/scuff-static/">scuff-static</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">scuff-spectrum</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#mode-frequencies-as-nonlinear-eigenvalues">Mode frequencies as nonlinear eigenvalues</a></li>
                
            
                <li class="toctree-l3"><a href="#beyns-contour-integral-algorithm-a-lightning-overview">Beyn's contour-integral algorithm: A lightning overview</a></li>
                
            
                <li class="toctree-l3"><a href="#beyns-algorithm-mechanics">Beyn's algorithm: Mechanics</a></li>
                
            
                <li class="toctree-l3"><a href="#2-scuff-spectrum-tutorial-modes-of-a-spherical-dielectric-cavity">2. scuff-spectrum tutorial: Modes of a spherical dielectric cavity</a></li>
                
                    <li><a class="toctree-l4" href="#exact-spherical-wave-calculation">Exact (spherical-wave) calculation</a></li>
                
                    <li><a class="toctree-l4" href="#scuff-spectrum-calculation">scuff-spectrum calculation</a></li>
                
            
                <li class="toctree-l3"><a href="#3-scuff-spectrum-command-line-reference">3. scuff-spectrum command-line reference</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../scuff-analyze/scuff-analyze/">scuff-analyze</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../scuff-integrate/scuff-integrate/">scuff-integrate</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Validation tests</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../tests/Overview/">Overview of the test suite</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../tests/MieScattering/MieScattering/">Mie scattering</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../tests/FresnelScattering/FresnelScattering/">Fresnel scattering</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../tests/CasimirSpheres/CasimirSpheres/">Equilibrium Casimir forces between spheres</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../tests/CasimirPlates/CasimirPlates/">Equilibrium Casimir forces between plates</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../tests/CPSphere/CPSphere/">Equilibrium Casimir-Polder potential near a sphere</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../tests/CPPlate/CPPlate/">Equilibrium Casimir-Polder potential near a plate</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../tests/NEQSpheres/NEQSpheres/">Heat transfer and non-equilibrium Casimir forces between spheres</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../tests/libscuff/libscuff/">Low-level tests of the core library</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>API reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../API/libscuff/">libscuff</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>For developers</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../forDevelopers/Implementation/">Implementation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../forDevelopers/DataStructures/">Data Structures</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../forDevelopers/Documentation/">Documentation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../../forDevelopers/SingularIntegrals/">Code for computing singular integrals</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">SCUFF-EM documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.."><span class="SmallCaps">scuff-em</span> documentation</a> &raquo;</li>
    
      
        
          <li>Command-line application reference &raquo;</li>
        
      
    
    <li>scuff-spectrum</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/homerreid/scuff-em/" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1> Computing electromagnetic modes with <span class="SC">scuff-spectrum</span>
</h1>

<p><a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> is a tool within the <a class="wikilink" href="../../../scuff-em/">scuff-em</a> code suite
for computing frequencies and field patterns of resonant modes
in arbitrary material geometries. More specifically, <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a>
implements <a href="../../../applications/scuff-spectrum/scuff-spectrum.md/#BeynMethod">Beyn's contour-integral algorithm for nonlinear
eigenproblems</a>, described in more detail below,
to pinpoint frequencies <script type="math/tex">\omega</script> at which the
<a href="../../../forDevelopers/Implementation.md/#PMCHWTSystem">BEM system matrix <script type="math/tex">\mathbf{M}(\omega)</script></a> is singular,
allowing nonzero surface currents to flow in the absence of
external fields. <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> reports mode frequencies
and, optionally, visualization diagrams and various
types of information on the current and field patterns
of the corresponding eigenvectors.</p>
<p>Of course, the information reported by <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> could
also be obtained <em>indirectly</em> from other codes in the
<a href="../../../index.md/#ApplicationSuite"><span class=SC>scuff-em</span> application suite</a>---for
example, the resonant modes of the
<a href="../../../applications/scuff-spectrum/scuff-spectrum.md/#SphericalDielectricCavity">spherical dielectric cavity</a>
shown below would show up as blips in (say) the
scattering cross section as the frequency is scanned past
the vicinity of the resonance.
<!--# while the [circuit-QED resonator][CircuitQEDResonator]-->
However, this would be an inefficient and imprecise way to
determine resonance frequencies---we would probably wind up
computing scattering cross sections at hundreds of frequencies
on a dense grid just to approximate the resonance with 
one- or two-digit accuracy---and it would not yield
direct information on the current and field patterns
of the corresponding modes. In contrast, the method
used by <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> is optimized to pinpoint
mode frequencies with many-digit accuracy---using
only a small number of samples---and, moreover, directly
furnishes all information we may need about the current a
and field patterns of the modes themselves.</p>
<div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#1-beyns-algorithm-the-computational-engine-behind-scuff-spectrum">1. Beyn's algorithm: the computational engine behind <span class="SC">scuff-spectrum</span></a><ul>
<li><a href="#mode-frequencies-as-nonlinear-eigenvalues">Mode frequencies as nonlinear eigenvalues</a></li>
<li><a href="#beyns-contour-integral-algorithm-a-lightning-overview">Beyn's contour-integral algorithm: A lightning overview</a></li>
<li><a href="#beyns-algorithm-mechanics">Beyn's algorithm: Mechanics</a></li>
</ul>
</li>
<li><a href="#2-scuff-spectrum-tutorial-modes-of-a-spherical-dielectric-cavity">2. <span class="SC">scuff-spectrum</span> tutorial: Modes of a spherical dielectric cavity</a><ul>
<li><a href="#exact-spherical-wave-calculation">Exact (spherical-wave) calculation</a></li>
<li><a href="#scuff-spectrum-calculation"><span class=SC>scuff-spectrum</span> calculation</a><ul>
<li><a href="#scuff-em-geometry-files-for-spherical-cavity"><span class=SC>scuff-em</span> geometry files for spherical cavity</a></li>
<li><a href="#running-scuff-spectrum-to-pinpoint-mode-frequencies">Running <span class=SC>scuff-spectrum</span> to pinpoint mode frequencies</a></li>
<li><a href="#mesh-convergence">Mesh convergence</a></li>
<li><a href="#running-scuff-spectrum-to-analyze-eigenmode-field-patterns">Running <span class=SC>scuff-spectrum</span> to analyze eigenmode field patterns</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#3-scuff-spectrum-command-line-reference">3. <span class="SC">scuff-spectrum</span> command-line reference</a></li>
</ul>
</div>
<p><a name="BeynMethod"></a></p>
<h1 id="1-beyns-algorithm-the-computational-engine-behind-scuff-spectrum">1. Beyn's algorithm: the computational engine behind <span class="SC">scuff-spectrum</span></h1>
<h3 id="mode-frequencies-as-nonlinear-eigenvalues">Mode frequencies as nonlinear eigenvalues</h3>
<p>The basic problem solved by <span class=SC>scuff-spectrum</span>
is to find values of the angular frequency <script type="math/tex">\omega</script> at which the
<a href="../../../forDevelopers/Implementation.md/#PMCHWTSystem">BEM system matrix <script type="math/tex">\mathbf{M}(\omega)</script></a> is singular
(has non-empty nullspace), in which case we can find a 
nonzero vector <script type="math/tex">\mathbf{v}</script> that solves the equation</p>
<p>
<script type="math/tex; mode=display"> \mathbf{M}(\omega) \mathbf{v} = 0. \qquad (1) </script>
</p>
<p>This is just the 
<a href="../../../forDevelopers/Implementation.md/#PMCHWTSystem">usual linear system of equations solved in <span class=SC>scuff-em</span> scattering problems</a>,
but now with zero right-hand side, i.e. there is no incident field or
other external stimulus exciting the structure; instead,
the eigenvector <script type="math/tex">\mathbf{v}={\mathbf{k} \choose \mathbf{n}}</script>
describes a configuration of surface currents that can exist
in the absence of external fields---a resonance mode.</p>
<p>Equation (1) resembles an eigenvalue problem, but with the
complication that the matrix <script type="math/tex">\mathbf{M}(\omega)</script> depends
in a complicated nonlinear way on the frequency <script type="math/tex">\omega</script>; 
this means we can't simply use standard solvers
for linear eigenproblems such as those implemented
in <a href="http://www.netlib.org/lapack/"><span class=SC>lapack</span></a>.</p>
<h3 id="beyns-contour-integral-algorithm-a-lightning-overview">Beyn's contour-integral algorithm: A lightning overview</h3>
<p>Instead, <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> implements the contour-integral approach
to nonlinear eigenproblems proposed by W. Beyn in this 2012 paper:</p>
<ul>
<li>
<p>Wolf-J&uuml;rgen Beyn, "An integral method for solving nonlinear eigenvalue problems." <em>Linear Algebra and its Applications</em> <strong>436</strong> 3839 (May 2012).</p>
</li>
<li>
<p>DOI: <a href="https://doi.org/10.1016/j.laa.2011.03.030">https://doi.org/10.1016/j.laa.2011.03.030</a></p>
</li>
<li>
<p>ArXiV: <a href="https://arxiv.org/abs/1003.1580">https://arxiv.org/abs/1003.1580</a></p>
</li>
</ul>
<p>In a nutshell, Beyn's method locates eigenvalues of (1) by
evaluating a certain contour integral in the complex <script type="math/tex">\omega</script> plane;
the evaluation proceeds via numerical quadrature, sampling
the integrand at a total of <script type="math/tex">N</script> quadrature points
<script type="math/tex">\{\omega_n\},n=1,2,\cdots,N</script> (see figure below).
The number of quadrature points, and the shape and location
of the contour, are user-tweakable parameters that you 
will specify as inputs to <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a>; the basic idea
is that Beyn's method will identify all eigenvalues located 
<em>inside</em> the contour, and will ignore any eigenvalues lying
<em>outside</em> the contour, so the challenge from the user's 
perspective is to have a rough idea of where your eigenvalues
will be---and to design contours that enclose the ones you
want while omitting the others.</p>
<p>We are being deliberately vague here about precisely
<em>what</em> contour integral we are evaluating, as this is not
crucial knowledge for using <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> (for details,
see the original paper linked above). Pretty much all you need
to know is this: Evaluating the integrand at each
quadrature point <script type="math/tex">\omega_n</script> involves <strong>(a)</strong> forming and factorizing 
the matrix <script type="math/tex">\mathbf{M}(\omega_n)</script>, and then <strong>(b)</strong> doing some simple
linear-algebra calculations involving the solution
of a small number (see below) of linear systems of equations
of the form <script type="math/tex">\mathbf{M}(\omega)\mathbf{x}=\mathbf{b}</script>
for certain given RHS vectors <script type="math/tex">\mathbf{b}.</script> Of course, 
assembling the system matrix <script type="math/tex">\mathbf{M}(\omega)</script> and solving
linear systems is exactly what <span class=SC>scuff-em</span>
does to solve scattering problems, and so <em>mechanically</em>
Beyn's algorithm boils down simply to solving integral-equation
scattering problems, at some number of frequencies, with
some number of RHS vectors at each frequency---not different,
in principle, from what we would wind up doing in the brute-force
(frequency-scanning) approach to computing mode frequencies
discussed above. The difference is that Beyn's algorithm
chooses the frequencies at which we calculate, and combines
the results of all those calculations, in clever ways to ensure
that maximal benefit is extracted from the computations,
allowing us to converge quickly to highly accurate values
for the eigenvalues <script type="math/tex">\omega</script> in (1). Of course, in addition
to the eigenvalue <script type="math/tex">\omega</script>, Beyn's method also gives us
the eigen<em>vectors</em> <script type="math/tex">\mathbf{v}</script>, which we can use in
post-processing to do things like visualizing the distribution
of currents and fields in the various eigenmodes we find (see examples
below).</p>
<h3 id="beyns-algorithm-mechanics">Beyn's algorithm: Mechanics</h3>
<p>Having briefly outlined the idea of Beyn's method---and referring
interested readers to Beyn's paper cited above for more detail on the 
theory---let's now turn to a discussion of the mechanics
of running Beyn-method calculations in <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a>.</p>
<p>The following figure illustrates a typical elliptical
contour <script type="math/tex">\mathcal{C}</script> in the complex-<script type="math/tex">\omega</script> plane over
which we might wish to execute Beyn's algorithm.
(Contours in <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> are always elliptical.)</p>
<p><img alt="BeynContour" src="../BeynContour.png" /></p>
<p>In this figure, blue crosses indicate eigenvalues of (1);
note that there are 3 eigenvalues contained inside the
contour <script type="math/tex">\mathcal{C}</script>---labeled <script type="math/tex">\omega_{1,2,3}</script>---as
well as several other eigenvalues not enclosed by the 
contour, which we do not label as they will be ignored
by our calculation. The black dots on the contour indicate
quadrature points; the <script type="math/tex">\omega</script> values represented by these points
are the complex frequencies at which <a class="wikilink" href="../../../scuff-scatter/">scuff-scatter</a>
will assemble the matrix <script type="math/tex">\mathbf{M}(\omega)</script>
and do some linear algebra to compute 
the integrand of the Beyn-method contour integrals.</p>
<p>Items in <em>red</em> in the figure above indicate user-specified
inputs to <a class="wikilink" href="../../../scuff-scatter/">scuff-scatter</a>: these are</p>
<ul>
<li>
<p>the complex-valued frequency <script type="math/tex">\omega_0</script> at which
  the contour <script type="math/tex">\mathcal{C}</script> is centered</p>
</li>
<li>
<p>the horizontal and vertical radii (half-minor axes)
  <script type="math/tex">R_x</script> and <script type="math/tex">R_y</script> of the elliptical contour</p>
</li>
<li>
<p>the number of quadrature points <script type="math/tex">N</script> (12 in this case)</p>
</li>
<li>
<p>an integer <script type="math/tex">L</script> which should be greater than or equal to
  the number of eigenvalues you <em>expect</em> to be found
  within the contour; if <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> finds more than
  this number of eigenvalues, Beyn's method breaks down and 
  must be restarted with a larger value of <script type="math/tex">L</script>. (You will 
  get a console warning in this case.)</p>
</li>
</ul>
<p>On the other hand, the algorithm works fine if <script type="math/tex">L</script> winds up
  being <em>larger</em> than the number of eigenvalues found inside
  the contour, so you should give yourself some leeway by 
  choosing generous values for <script type="math/tex">L</script> (typical values might 
  be 10 or 20); higher values of <script type="math/tex">L</script> do result in slightly
  greater computation time, but not much. (More specifically, <script type="math/tex">L</script>
  is the number of linear-system solves of the form
  <script type="math/tex">\mathbf{M}(\omega_n)\mathbf{x}=\mathbf{b}</script> that must be done
  at each quadrature point <script type="math/tex">\omega_n</script>; increasing <script type="math/tex">L</script> from 10 to 20
  or 30 or so does require more solves, but that cost is 
  generally negligible compared to the cost of assembling 
  and factorizing the matrix <script type="math/tex">\mathbf{M}(\omega)</script>, so don't
  bother with excessive parsimony in choosing <script type="math/tex">L</script>.)</p>
<p>Running <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> with the above inputs as illustrated
in the figure above would yield accurate values for the three 
eigenvalues <script type="math/tex">\omega_{1,2,3}</script> inside the contour---with the
accuracy increasing with the number of quadrature points <script type="math/tex">N</script>---as
well as values for the corresponding eigenvectors.</p>
<p><a name="SphericalDielectricCavity"></a></p>
<h1 id="2-scuff-spectrum-tutorial-modes-of-a-spherical-dielectric-cavity">2. <span class="SC">scuff-spectrum</span> tutorial: Modes of a spherical dielectric cavity</h1>
<p>In this example we'll use the Beyn algorithm as implemented by <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> to
compute the modes of a spherical dielectric cavity, i.e. a simple dielectric sphere.</p>
<h2 id="exact-spherical-wave-calculation">Exact (spherical-wave) calculation</h2>
<p>For this simple geometry, the mode frequencies can be
calculated to any desired numerical precision by looking
for poles of the Mie-scattering coefficients for plane waves
impinging on a dielectric sphere; the calculation is discussed
on page 15 of <a href="../../../tex/scuffSpherical.pdf">this memo</a>
and implemented by 
<a href="../GetSphericalCavityFrequencies.math">this simple <span class=SC>mathematica</span> code</a>
For a sphere of relative permittivity
<script type="math/tex">\epsilon=4</script> (refractive index <script type="math/tex">n=2</script>), some typical results are:</p>
<ul>
<li>For <script type="math/tex">\mathbf{N}</script>-type (electric multipole) waves with <script type="math/tex">\ell=1</script> there is a resonance at</li>
</ul>
<p>
<script type="math/tex; mode=display"> a= 1.1362178236179127955 - 0.63063395652811684933i </script>
</p>
<p>where <script type="math/tex">a=\frac{\omega R}{c}</script> with <script type="math/tex">R</script> the sphere radius.</p>
<ul>
<li>For <script type="math/tex">\mathbf{M}</script>-type (magnetic multipole) waves with <script type="math/tex">\ell=2</script> there is a resonance at
b
<script type="math/tex; mode=display"> a=2.0714122747181446982 - 0.14636128063766849563i </script>
</li>
</ul>
<p>Next let's ask how well we can reproduce these results
in <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a>.</p>
<h2 id="scuff-spectrum-calculation"><span class=SC>scuff-spectrum</span> calculation</h2>
<h3 id="scuff-em-geometry-files-for-spherical-cavity"><span class=SC>scuff-em</span> geometry files for spherical cavity</h3>
<p>For <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> calculations I use a simple <code>.scuffgeo</code>
file describing an isolated sphere with <script type="math/tex">\epsilon_r=4</script>;
this file is called <code>E4Sphere_501.scuffgeo</code>:</p>
<pre><code class="bash">OBJECT Sphere
    MESHFILE Sphere_501.msh
    MATERIAL CONST_EPS_4
ENDOBJECT
</code></pre>

<p>The file <a href="../Sphere_501.msh"><code>Sphere_501.msh</code></a> to which this refers is a 
<a href="../gmsh.info"><span class=SC>gmsh</span></a>
mesh file produced from a <span class=SC>gmsh</span> 
geometry file named <a href="../Sphere.geo"><code>Sphere.geo</code></a>
by running <code>gmsh -2 Sphere.geo -o Sphere.msh</code>; to investigate
the effect of meshing resolution I will also create a series
of more finely discretized spheres by saying e.g.
<code>gmsh -2 Sphere.geo -clscale 0.75 -o Sphere_Finer.msh</code>
(where the <code>-clscale</code> option, short for "characteristic
length scale", may be used to refine the discretization length
everywhere in the geometry.)
The finest-resolution sphere I will use has <script type="math/tex">N=4107</script> interior
edges; for comparison , here are images of the coarsest <script type="math/tex">(N=501)</script> 
and finest <script type="math/tex">(N=4107)</script> sphere meshes I will use.</p>
<p><img alt="Sphere_501.png" src="../Sphere_501.png" />
<img alt="Sphere_4107.png" src="../Sphere_4107.png" /></p>
<h3 id="running-scuff-spectrum-to-pinpoint-mode-frequencies">Running <span class=SC>scuff-spectrum</span> to pinpoint mode frequencies</h3>
<p>Based on the discussion above, I expect to find modes
at frequencies near <script type="math/tex">\omega_0\approx 1.1-0.63i</script>
and <script type="math/tex">\omega_0\approx 2.1-0.14i</script>. Thus, I will use <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a>
to execute Beyn's method for contours centered near these points
and enclosing them.</p>
<p>For example, here's a run in which I specify a contour centered
at <script type="math/tex">\omega_0=1.1-0.63i</script>, with horizontal and vertical
radii <script type="math/tex">R_x=R_y=0.2</script>, using <script type="math/tex">N</script>=14 quadrature points, and 
allowing a budget of up to <script type="math/tex">L</script>=5 eigenvalues to be 
found within the contour:</p>
<pre><code class="bash">% scuff-spectrum --geometry E4Sphere_501.scuffgeo \
                 --omega0 1.1-0.63i               \
                 --Rx 0.2 --Ry 0.2                \
                 --N 14 --L 5                     
</code></pre>

<p>This produces the file <code>E4Sphere_501.ModeFrequencies</code>:</p>
<pre><code class="bash"># For contour w0=1.1+-0.63i, Rx=2.000000e-01, Ry=2.000000e-01, N=14, L=5# w0=1.1+-0.63i, Rx=2.000000e-01, Ry=2.000000e-01, N=14, L=5:
# re(w) im(w)   estimated error in re(w), im(w)
+1.149426e+00 -6.378139e-01  +3.180420e-05 +7.130373e-05  
</code></pre>

<p>As the header says, the 4 numbers reported here are 
the real and imaginary parts of the mode frequency
(which is being estimated at <script type="math/tex">\omega \approx 1.149-0.63i</script>)
followed by estimates of the integration error,
i.e. the error incurred by approximating the contour
integral via numerical quadrature; in this case the 
error is evidently tiny, and we can be confident that Beyn's
method has converged even with just the 14 quadrature points
we used. (For larger contours we would probably need
more points.)</p>
<h3 id="mesh-convergence">Mesh convergence</h3>
<p>Of course, even if Beyn's method converges to many-digit
precision on an eigenmode, we don't necessarily 
expect the 
resulting mode frequency to agree with Mie-theoretic predictions
to high accuracy, because we are here studying a slightly
different <em>structure</em>---namely, a sphere approximated by a
discretized version in the form of a 501-sided polygon---but
we may expect the mode frequencies to converge toward exact 
results for spheres as the <em>discretization</em> is refined.</p>
<p>To test this, I repeated the <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> calculations
above using more finely-meshed spheres. 
Here are results for mode frequency vs. mesh
discretization, characterized by the number <em>N</em>
of interior edges in the discretized sphere:</p>
<table>
<thead>
<tr>
<th><strong>N</strong></th>
<th align="center">Re(<script type="math/tex">\omega</script>)</th>
<th>Im(<script type="math/tex">\omega</script>)</th>
</tr>
</thead>
<tbody>
<tr>
<td>501</td>
<td align="center">1.14943</td>
<td>-0.63781</td>
</tr>
<tr>
<td>1482</td>
<td align="center">1.14076</td>
<td>-0.63318</td>
</tr>
<tr>
<td>2604</td>
<td align="center">1.13877</td>
<td>-0.63204</td>
</tr>
<tr>
<td>4107</td>
<td align="center">1.13787</td>
<td>-0.63157</td>
</tr>
<tr>
<td></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td>inf</td>
<td align="center">1.13627</td>
<td>-0.63071</td>
</tr>
<tr>
<td></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td>exact</td>
<td align="center">1.13622</td>
<td>-0.63063</td>
</tr>
</tbody>
</table>
<p>In this table, the first four data rows show
results of <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> calculations 
for discretized meshes with <script type="math/tex">N</script> interior edges.
The column marked <code>inf</code> corresponds to an extrapolation
of the finite-<script type="math/tex">N</script> data to the <script type="math/tex">N\to \infty</script> limit
(basically, just fit the data to <script type="math/tex">A+B/N</script> and 
retain only the <script type="math/tex">A</script> coefficient.)
The row labeled <code>exact</code> shows
numerically exact predictions of Mie theory.</p>
<p>Here are the analogous results for the <script type="math/tex">M</script>-type <script type="math/tex">\ell=2</script> spherical
cavity mode:</p>
<table>
<thead>
<tr>
<th><strong>N</strong></th>
<th align="center">Re(<script type="math/tex">\omega</script>)</th>
<th>Im(<script type="math/tex">\omega</script>)</th>
</tr>
</thead>
<tbody>
<tr>
<td>501</td>
<td align="center">2.09595</td>
<td>-0.147858</td>
</tr>
<tr>
<td>1482</td>
<td align="center">2.07996</td>
<td>-0.146926</td>
</tr>
<tr>
<td>2604</td>
<td align="center">2.07615</td>
<td>-0.146679</td>
</tr>
<tr>
<td>4107</td>
<td align="center">2.07442</td>
<td>-0.146564</td>
</tr>
<tr>
<td></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td>inf</td>
<td align="center">2.07151</td>
<td>-0.146403</td>
</tr>
<tr>
<td></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td>exact</td>
<td align="center">2.07141</td>
<td>-0.146361</td>
</tr>
</tbody>
</table>
<p>These results demonstrate that the Beyn method implemented by 
<a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> is able to achieve at least 4-digit precision
in determining mode frequencies, despite the modest computational
burden.</p>
<h3 id="running-scuff-spectrum-to-analyze-eigenmode-field-patterns">Running <span class=SC>scuff-spectrum</span> to analyze eigenmode field patterns</h3>
<p>Having identified the <em>frequencies</em> (eigenvalues) of
our structure with high precision, we will next want to look
at the <em>surface currents</em> (eigenvectors) and the <em>field patterns</em>
they produce. <a class="wikilink" href="../../../scuff-spectrum/">scuff-spectrum</a> offers several command-line
options to facilitate this analysis, many of which are 
similar to the post-processing outputs available in 
<a href="../../../applications/scuff-scatter/scuff-scatter.md/#Options"><span class=SC>scuff-scatter</span></a> and other
<span class=SC>scuff-em</span> codes:</p>
<ul>
<li>
<p><code>--EPFile MyEPFile</code> requests computation of <strong>E</strong> and <strong>H</strong>
field components at each evaluation point in a user-specified
list of evaluation points.</p>
</li>
<li>
<p><code>--FVMesh MyFVMesh.msh</code> requests generation of 
<span class=SC>gmsh</span> visualization files
showing fields and fluxes on the user-specified visualization
mesh (screen) <code>MyFVMesh.msh.</code></p>
</li>
<li>
<p><code>--CartesianMomentFile MyFile</code> requests that values of the 
Cartesian multipole moments corresponding to the eigen-current
distribution be written to file <code>MyFile.</code></p>
</li>
<li>
<p><code>--SphericalMomentFile MyFile</code> is like the previous option,
but for <em>spherical</em> multipole moments.</p>
</li>
<li>
<p><code>--PlotSurfaceCurrents</code> requests visualization files
showing the distribution of electric and magnetic
surface currents on the geometry.</p>
</li>
</ul>
<p>For example, here are images showing the distribution of
surface currents for the two eigenmodes captured by the
above tables.</p>
<p><img alt="L1Mode.png" src="../L1Mode.png" /></p>
<p><img alt="L2Mode.png" src="../L2Mode.png" /></p>
<p>The quadrupole structure of the <script type="math/tex">\ell=2</script> resonance is clearly
distinguishable from the dipole structure of the <script type="math/tex">\ell=1</script> mode.</p>
<p><a name="CommandLineReference"></a></p>
<h1 id="3-scuff-spectrum-command-line-reference">3. <span class="SC">scuff-spectrum</span> command-line reference</h1>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../scuff-analyze/scuff-analyze/" class="btn btn-neutral float-right" title="scuff-analyze"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../scuff-static/scuff-static/" class="btn btn-neutral" title="scuff-static"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  <a href="http://homerreid.com/scuff-em"> 
    <span class="SmallCaps">scuff-em</span>
  </a> documentation, by
  <a href="http://homerreid.com">Homer Reid</a>

  <p>
  <font size=-1>
  Built with <a href="http://www.mkdocs.org">MkDocs</a> 
  using a customized theme modeled 
  after the 
  <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
  provided by <a href="https://readthedocs.org">Read the Docs</a>.
  </font>

</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../scuff-static/scuff-static/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../scuff-analyze/scuff-analyze/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
