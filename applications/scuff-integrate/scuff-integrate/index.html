



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="http://homerreid.github.io/scuff-em-documentation/applications/scuff-integrate/scuff-integrate/">
      
      
        <meta name="author" content="Homer Reid">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>scuff-integrate - SCUFF-EM documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.8d40d89b.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,400i,700|">
        <style>body,input{font-family:"Noto Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../../css/scuff-em.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#1-using-scuff-integrate-as-a-general-purpose-numerical-integrator" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://homerreid.github.io/scuff-em-documentation" title="SCUFF-EM documentation" class="md-header-nav__button md-logo">
          
            <img src="../../../reference/scuffEMLogo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                SCUFF-EM documentation
              </span>
              <span class="md-header-nav__topic">
                scuff-integrate
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/homerreid/scuff-em/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      scuff-em
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../examples/" title="Examples" class="md-tabs__link">
          Examples
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../tests/Overview/" title="Test suite" class="md-tabs__link">
          Test suite
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../reference/TopLevel/" title="General reference" class="md-tabs__link">
          General reference
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../GeneralReference/" title="Command-line tools" class="md-tabs__link md-tabs__link--active">
          Command-line tools
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../HighLevelInterface/HighLevelInterface/" title="High-level interface" class="md-tabs__link">
          High-level interface
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../API/libscuff/" title="Low-level API" class="md-tabs__link">
          Low-level API
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../forDevelopers/Implementation/" title="For developers" class="md-tabs__link">
          For developers
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../../reference/scuffEMLogo.png" width="48" height="48">
      
    </span>
    SCUFF-EM documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/homerreid/scuff-em/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      scuff-em
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/" title="SCUFF-EM tutorial examples" class="md-nav__link">
      SCUFF-EM tutorial examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/MieScattering/MieScattering/" title="Mie scattering" class="md-nav__link">
      Mie scattering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/DielectricShell/DielectricShell/" title="Electrostatics of a spherical dielectric shell" class="md-nav__link">
      Electrostatics of a spherical dielectric shell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/ThinFilm/ThinFilm/" title="Spatially-resolved study of plane-wave transmission through an infinite-area thin dielectric film" class="md-nav__link">
      Spatially-resolved study of plane-wave transmission through an infinite-area thin dielectric film
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/DiffractionPatterns/DiffractionPatterns/" title="Imaging diffraction patterns of discs, disc arrays, and hole arrays in metal screens" class="md-nav__link">
      Imaging diffraction patterns of discs, disc arrays, and hole arrays in metal screens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/NanorodResonantModes/NanorodResonantModes/" title="Mode frequencies and field patterns of resonant modes in gold nanorods" class="md-nav__link">
      Mode frequencies and field patterns of resonant modes in gold nanorods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/CubeTorus/" title="Casimir forces in a compact geometry" class="md-nav__link">
      Casimir forces in a compact geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/SiliconBeams/SiliconBeams/" title="Casimir forces in a 1D extended geometry" class="md-nav__link">
      Casimir forces in a 1D extended geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/SiliconSlabs/SiliconSlabs/" title="Casimir forces in a 2D extended geometry" class="md-nav__link">
      Casimir forces in a 2D extended geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/NanostructureCasimirPolder/NanostructureCasimirPolder/" title="Casimir-Polder potentials in dielectric nanostructures" class="md-nav__link">
      Casimir-Polder potentials in dielectric nanostructures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/SiO2Spheres/SiO2Spheres/" title="Thermal radiation, heat transfer, and non-equilibrium Casimir forces between silicon dioxide spheres" class="md-nav__link">
      Thermal radiation, heat transfer, and non-equilibrium Casimir forces between silicon dioxide spheres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/TipSubstrate/TipSubstrate/" title="Spatial distribution of heat flux from a warm tip over a cold substrate" class="md-nav__link">
      Spatial distribution of heat flux from a warm tip over a cold substrate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/HalfSpaceLDOS/HalfSpaceLDOS/" title="LDOS and dyadic Green functions above an infinite aluminum half-space" class="md-nav__link">
      LDOS and dyadic Green functions above an infinite aluminum half-space
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/PlatonicSolids/PlatonicSolids/" title="Electrostatic polarizability of platonic solids" class="md-nav__link">
      Electrostatic polarizability of platonic solids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/TwoBodyCapacitors/TwoBodyCapacitors/" title="Capacitance of two-body capacitors" class="md-nav__link">
      Capacitance of two-body capacitors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/StriplineCapacitor/StriplineCapacitor/" title="Capacitance of a PCB stripline trace" class="md-nav__link">
      Capacitance of a PCB stripline trace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/ImplicitSubstrate/ImplicitSubstrate/" title="Implicit handling of multilayer dielectric substrates" class="md-nav__link">
      Implicit handling of multilayer dielectric substrates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/pythonCapacitance/pythonCapacitance/" title="Finite-size effects in stripline capacitors" class="md-nav__link">
      Finite-size effects in stripline capacitors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/PaulTrap/PaulTrap/" title="Electrostatic fields of an electrode array" class="md-nav__link">
      Electrostatic fields of an electrode array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/YagiUdaAntennas/YagiUdaAntennas/" title="Z-parameters and directivity of Yagi-Uda antennas" class="md-nav__link">
      Z-parameters and directivity of Yagi-Uda antennas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/MicrostripDevices/MicrostripDevices/" title="Input impedance, mutual coupling, and radiated fields of microstrip RF devices" class="md-nav__link">
      Input impedance, mutual coupling, and radiated fields of microstrip RF devices
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Test suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Test suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/Overview/" title="Overview of the test suite" class="md-nav__link">
      Overview of the test suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/MieScattering/MieScattering/" title="Mie scattering" class="md-nav__link">
      Mie scattering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/FresnelScattering/FresnelScattering/" title="Fresnel scattering" class="md-nav__link">
      Fresnel scattering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/CasimirSpheres/CasimirSpheres/" title="Equilibrium Casimir forces between spheres" class="md-nav__link">
      Equilibrium Casimir forces between spheres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/CasimirPlates/CasimirPlates/" title="Equilibrium Casimir forces between plates" class="md-nav__link">
      Equilibrium Casimir forces between plates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/CPSphere/CPSphere/" title="Equilibrium Casimir-Polder potential near a sphere" class="md-nav__link">
      Equilibrium Casimir-Polder potential near a sphere
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/CPPlate/CPPlate/" title="Equilibrium Casimir-Polder potential near a plate" class="md-nav__link">
      Equilibrium Casimir-Polder potential near a plate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/NEQSpheres/NEQSpheres/" title="Heat transfer and non-equilibrium Casimir forces between spheres" class="md-nav__link">
      Heat transfer and non-equilibrium Casimir forces between spheres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/libscuff/libscuff/" title="Low-level tests of the core library" class="md-nav__link">
      Low-level tests of the core library
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      General reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        General reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/TopLevel/" title="Top-level overview" class="md-nav__link">
      Top-level overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/Installing/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/Geometries/" title="Geometry descriptions" class="md-nav__link">
      Geometry descriptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/EquivalentEdgeSurfacePairs/" title="Equivalent edge/surface pairs" class="md-nav__link">
      Equivalent edge/surface pairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/Materials/" title="Material designations" class="md-nav__link">
      Material designations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/Transformations/" title="Geometric transformations" class="md-nav__link">
      Geometric transformations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/IncidentFields/" title="Incident fields" class="md-nav__link">
      Incident fields
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/BrillouinZoneIntegration/" title="Brillouin zone integration" class="md-nav__link">
      Brillouin zone integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/FAQ/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Command-line tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Command-line tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../GeneralReference/" title="General command-line reference" class="md-nav__link">
      General command-line reference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scuff-scatter/scuff-scatter/" title="scuff-scatter" class="md-nav__link">
      scuff-scatter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scuff-transmission/scuff-transmission/" title="scuff-transmission" class="md-nav__link">
      scuff-transmission
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scuff-ldos/scuff-ldos/" title="scuff-ldos" class="md-nav__link">
      scuff-ldos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scuff-tmatrix/scuff-tmatrix/" title="scuff-tmatrix" class="md-nav__link">
      scuff-tmatrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scuff-cas3D/scuff-cas3D/" title="scuff-cas3D" class="md-nav__link">
      scuff-cas3D
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scuff-caspol/scuff-caspol/" title="scuff-caspol" class="md-nav__link">
      scuff-caspol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scuff-neq/scuff-neq/" title="scuff-neq" class="md-nav__link">
      scuff-neq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scuff-rf/scuff-rf/" title="scuff-rf" class="md-nav__link">
      scuff-rf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scuff-static/scuff-static/" title="scuff-static" class="md-nav__link">
      scuff-static
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scuff-spectrum/scuff-spectrum/" title="scuff-spectrum" class="md-nav__link">
      scuff-spectrum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scuff-analyze/scuff-analyze/" title="scuff-analyze" class="md-nav__link">
      scuff-analyze
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        scuff-integrate
      </label>
    
    <a href="./" title="scuff-integrate" class="md-nav__link md-nav__link--active">
      scuff-integrate
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#integrating-a-single-function-of-a-single-variable" title="Integrating a single function of a single variable" class="md-nav__link">
    Integrating a single function of a single variable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrating-multiple-functions-of-frequency" title="Integrating multiple functions of frequency" class="md-nav__link">
    Integrating multiple functions of frequency
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#giving-names-to-data-columns" title="Giving names to data columns" class="md-nav__link">
    Giving names to data columns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrating-functions-of-frequency-and-other-parameters" title="Integrating functions of frequency and other parameters" class="md-nav__link">
    Integrating functions of frequency and other parameters
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      High-level interface
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        High-level interface
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../HighLevelInterface/HighLevelInterface/" title="High-Level Interface" class="md-nav__link">
      High-Level Interface
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Low-level API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Low-level API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../API/libscuff/" title="libscuff" class="md-nav__link">
      libscuff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../API/MainFlow/" title="MainFlow API" class="md-nav__link">
      MainFlow API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../API/UtilityAPI/" title="Utility API" class="md-nav__link">
      Utility API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      For developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        For developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../forDevelopers/Implementation/" title="Implementation" class="md-nav__link">
      Implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../forDevelopers/DataStructures/" title="Data Structures" class="md-nav__link">
      Data Structures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../forDevelopers/Documentation/" title="Documentation" class="md-nav__link">
      Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../forDevelopers/SingularIntegrals/" title="Code for computing singular integrals" class="md-nav__link">
      Code for computing singular integrals
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#integrating-a-single-function-of-a-single-variable" title="Integrating a single function of a single variable" class="md-nav__link">
    Integrating a single function of a single variable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrating-multiple-functions-of-frequency" title="Integrating multiple functions of frequency" class="md-nav__link">
    Integrating multiple functions of frequency
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#giving-names-to-data-columns" title="Giving names to data columns" class="md-nav__link">
    Giving names to data columns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrating-functions-of-frequency-and-other-parameters" title="Integrating functions of frequency and other parameters" class="md-nav__link">
    Integrating functions of frequency and other parameters
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/homerreid/scuff-em/edit/master/docs/applications/scuff-integrate/scuff-integrate.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="integrating-frequency-dependent-data-with-scuff-integrate">Integrating frequency-dependent data with <span class="SC">scuff-integrate</span></h1>
<p>Many application codes in the <a class="wikilink" href="../../../scuff-em/">scuff-em</a> suite compute
physical quantities defined by definite integrals over real
or imaginary frequencies, with the numerical value of the
integrand at each point obtained by solving individual
<a class="wikilink" href="../../../scuff-em/">scuff-em</a> scattering problems at that frequency. For example,</p>
<ul>
<li>
<p><a href="../../scuff-cas3D/scuff-cas3D/"> <span class=SC>scuff-cas3d</span> </a> and
  <a href="../../scuff-caspol/scuff-caspol/"> <span class=SC>scuff-caspol</span> </a>
  compute zero-temperature Casimir quantities by integrating 
  contributions from imaginary frequencies <script type="math/tex">\xi</script>:
<!--%====================================================================%-->
<script type="math/tex; mode=display"> Q = \int_0^\infty I(\xi) \, d\xi \tag{1} </script>
<!--%====================================================================%-->
  Here <script type="math/tex">Q</script> is a zero-temperature Casimir energy/force/torque (<a class="wikilink" href="../../../scuff-cas3d/">scuff-cas3d</a>)
  or Casimir-Polder potential (<a class="wikilink" href="../../../scuff-caspol/">scuff-caspol</a>) and <script type="math/tex">I(\xi)</script> is the 
  spectral density of contributions to <script type="math/tex">Q</script> from fluctuations at 
  imaginary frequency <script type="math/tex">\xi</script>, which may be obtained by solving
  <a class="wikilink" href="../../../scuff-em/">scuff-em</a> scattering calculations at imaginary frequency <script type="math/tex">\xi</script>.</p>
</li>
<li>
<p><a href="../../scuff-neq/scuff-neq/"> <span class=SC>scuff-neq</span> </a> computes
    the total rate of energy or momentum transfer
    from a source body <script type="math/tex">s</script> to a destination body <script type="math/tex">d</script> 
    by integrating contributions from real frequencies <script type="math/tex">\omega</script>:
<!--%====================================================================%-->
<script type="math/tex; mode=display"> Q_{s\rightarrow d}
   = \int_0^\infty
     \Big[ \Theta(T_s,\omega) - \Theta(T_\text{env},\omega) \Big]
     \Phi_{s\rightarrow d}(\omega) \, d\omega
   \tag{2}
</script>
<!--%====================================================================%-->
    Here <script type="math/tex">Q_{s\rightarrow d}</script> is the contribution of body <script type="math/tex">s</script> to
    quantity <script type="math/tex">Q</script> (a heat-transfer rate, force, or torque) for body <script type="math/tex">d</script>,
    <script type="math/tex">\Theta(T,\omega)=\frac{\hbar\omega}{e^{\hbar\omega/kT}-1}</script>
    is the Bose-Einstein statistical factor, <script type="math/tex">T_s</script> and <script type="math/tex">T_\text{env}</script>
    are the temperatures of the source body and the environment,
    and <script type="math/tex">\Phi(\omega)</script> is a "generalized flux" quantity that may be 
    computed by solving <a class="wikilink" href="../../../scuff-em/">scuff-em</a> scattering calculations
    at frequency <script type="math/tex">\omega</script>.</p>
</li>
</ul>
<p>The integrals over <script type="math/tex">\xi</script> and <script type="math/tex">\omega</script> are evaluated by
numerical cubature---that is, as weighted sums of integrand
samples. In a perfect world, it would be possible for 
<a class="wikilink" href="../../../scuff-em/">scuff-em</a> application codes to choose appropriate 
integration strategies automatically, hiding these details
from the user and reporting just the frequency-integrated
quantities <script type="math/tex">Q</script>. This is in fact the strategy that was
adopted in early incarnations of the <a class="wikilink" href="../../../scuff-em/">scuff-em</a> codes.</p>
<p>In the real world, however, the behavior of integrand 
functions like <script type="math/tex">I(\xi)</script> and <script type="math/tex">\Phi(\omega)</script> varies widely
from problem to problem, depending on factors such
as the shapes and materials of bodies in the scattering
geometry and the quantity being computed. For this reason,
it's hard for <a class="wikilink" href="../../../scuff-em/">scuff-em</a> to make intelligent automatic
choices of integration strategies, and attempts to do so 
without user input may result in misleading or even
flat-out incorrect data.</p>
<p>For this reason, the modern approach to frequency integration
in <a class="wikilink" href="../../../scuff-em/">scuff-em</a> is to ask users to define a
list of frequencies at which to sample the integrand; this
list is passed to <a class="wikilink" href="../../../scuff-em/">scuff-em</a> application codes using the 
<code class="codehilite">--XiFile</code> or <code class="codehilite">--OmegaFile</code> command-line options, and in 
response the code produces an output file reporting values
of the integrand at the specified points. The frequency 
integral may then be calculated as as post-processing step
using the information reported in the frequency-resolved
data files, and this is the task for which <a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a>
exists.</p>
<p><strong><span class=SC>scuff-integrate</span> is a general-purpose tool, not limited to <span class=SC>scuff-em</span> applications</strong></p>
<p>Actually, <a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a> is designed to be a general-purpose
numerical-integration tool, not particularly tied to
<a class="wikilink" href="../../../scuff-em/">scuff-em</a>; given a data file containing samples of
some function <script type="math/tex">f(x)</script> at sample points <script type="math/tex">\{x_n\}</script>
distributed over an interval <script type="math/tex">[x_a, x_b]</script>,
<a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a> approximates the integral
<script type="math/tex">\int_{x_a}^{x_b} f(x) \, dx</script>. (It does this by
constructing a third-order spline interpolant through
the data, then integrating the interpolant via numerical
quadrature.) The code offers command-line options
to specify how the data file is to be interpreted
(for example, which columns are the <script type="math/tex">x</script> samples and 
which are the <script type="math/tex">f</script> samples). There is no restriction
on the number or spacing of the sample points; the
variable <em>x</em> need not correspond to a real or imaginary 
frequency, and the function <script type="math/tex">f</script> need not be a generalized
flux, Casimir integrand, or any other quantity
reported by a <a class="wikilink" href="../../../scuff-em/">scuff-em</a> calculation.</p>
<p><strong>But for data files that <em>do</em> come from <span class=SC>scuff-em</span> calculations, <span class=SC>scuff-integrate</span> knows what to do automatically with minimal user input</strong></p>
<p>In addition to the fully general-purpose mode described above,
<a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a> also has built-in automatic support for
certain specialized types of <span class=SC>scuff-em</span>
data files---such as the <a href="../../scuff-neq/scuff-neq/#SIFluxFile"><code class="codehilite"><span class="na">.SIFlux</span></code> files produced by <span class=SC>scuff-neq</span></a>---designed
to make it easy to run the tool to get the frequency-integrated data you want with minimal user input
required.</p>
<div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#integrating-frequency-dependent-data-with-scuff-integrate">Integrating frequency-dependent data with <span class="SC">scuff-integrate</span></a><ul>
<li><a href="#1-using-scuff-integrate-as-a-general-purpose-numerical-integrator">1. Using <span class=SC>scuff-integrate</span> as a general-purpose numerical integrator</a><ul>
<li><a href="#integrating-a-single-function-of-a-single-variable">Integrating a single function of a single variable</a></li>
<li><a href="#integrating-multiple-functions-of-frequency">Integrating multiple functions of frequency</a></li>
<li><a href="#giving-names-to-data-columns">Giving names to data columns</a></li>
<li><a href="#integrating-functions-of-frequency-and-other-parameters">Integrating functions of frequency and other parameters</a></li>
</ul>
</li>
<li><a href="#2-using-scuff-integrate-as-a-specialized-integrator-for-scuff-em-data">2. Using <span class=SC>scuff-integrate</span> as a specialized integrator for <span class=SC>scuff-em</span> data</a><ul>
<li><a href="#2a-integrating-scuff-neq-data">2A. Integrating scuff-neq data</a><ul>
<li><a href="#specifiying-temperatures">Specifiying temperatures</a></li>
<li><a href="#specifiying-multiple-temperature-sets">Specifiying multiple temperature sets</a></li>
<li><a href="#spatially-integrated-flux-data-siflux-files">Spatially-integrated flux data (<span class="na">.SIFlux</span> files)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#3-scuff-integrate-command-line-reference">3. <span class=SC>scuff-integrate</span> Command-Line Reference</a></li>
<li><a href="#4-miscellaneous-notes">4. Miscellaneous notes</a><ul>
<li><a href="#only-numerical-data-columns-are-counted-as-columns">Only numerical data columns are counted as columns</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="1-using-scuff-integrate-as-a-general-purpose-numerical-integrator">1. Using <span class=SC>scuff-integrate</span> as a general-purpose numerical integrator</h2>
<h3 id="integrating-a-single-function-of-a-single-variable">Integrating a single function of a single variable</h3>
<p>The simplest usage of <a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a> is to integrate
a single function <script type="math/tex">f</script> of a single variable <script type="math/tex">x</script>; as noted
above, this is a general-purpose use of the code, independent
of <a class="wikilink" href="../../../scuff-em/">scuff-em</a>, in which <script type="math/tex">x</script> and <script type="math/tex">f</script> need not be a frequency and
a generalized flux, but could have any arbitrary significance.
Suppose we have a file called <code class="codehilite">fData</code> in which
are tabulated numerical pairs <script type="math/tex">(x_n, f_n)</script>, <script type="math/tex">n=1,2,\cdots,N</script>, 
where <script type="math/tex">f_n=f(x_n)</script>:
<div class="codehilite"><pre><span></span>x1 f1 
x2 f2 
...
xN fN 
</pre></div></p>
<p>Then to compute <script type="math/tex">\int_{x_1}^{x_N} f(x) \, dx</script> we can just 
go like this:
<div class="codehilite"><pre><span></span>% scuff-integrate --datafile fData --freqColumn <span class="m">1</span> --dataColumn <span class="m">2</span>
</pre></div></p>
<p>This will produce a file named <code class="codehilite">fData.Integrated</code> containing
a single line of data: the integrated value of <script type="math/tex">f</script>.</p>
<p>If the frequency and/or integrand values are printed in
different columns of the data file, just adjust the 
<code class="codehilite">--freqColumn</code> and <code class="codehilite">--dataColumn</code> options accordingly. For
example, if the data file looks like this: </p>
<div class="codehilite"><pre><span></span>&lt;stuff&gt; &lt;stuff&gt; x1 &lt;stuff&gt; &lt;stuff&gt; f1 &lt;stuff&gt; ...
&lt;stuff&gt; &lt;stuff&gt; x2 &lt;stuff&gt; &lt;stuff&gt; f2 &lt;stuff&gt; ...
...
&lt;stuff&gt; &lt;stuff&gt; xN &lt;stuff&gt; &lt;stuff&gt; fN &lt;stuff&gt; ...
</pre></div>

<p>you would use <code class="codehilite">--freqcolumn 3 --datacolumn 6.</code> 
In this case, the content of the other columns (the <code class="codehilite">&lt;stuff&gt;</code>
in the above snippet) is ignored.</p>
<h3 id="integrating-multiple-functions-of-frequency">Integrating multiple functions of frequency</h3>
<p>More generally, you may have multiple integrand functions 
<script type="math/tex">f_1, \cdots, f_N</script>, each sampled at the same set of <script type="math/tex">x</script> values,
You can integrate all of these
at once simply by specifying multiple <code class="codehilite">--dataColumn</code>
options. For example, if you have functions <script type="math/tex">f</script> and <script type="math/tex">g</script>
and you have a file named <code class="codehilite">fgData</code> with the format</p>
<div class="codehilite"><pre><span></span>x1 f1 g1 
x2 f2 g2 
...
xN fN gN 
</pre></div>

<p>then you can say
<div class="codehilite"><pre><span></span>% scuff-integrate --datafile fgData --freqColumn <span class="m">1</span> --dataColumn <span class="m">2</span> --datacolumn <span class="m">3</span>
</pre></div></p>
<p>and the resulting output file <code class="codehilite">fgData.Integrated</code>
will report values for both <script type="math/tex">\int f(x)\,dx</script> and <script type="math/tex">\int g(x)\,dx</script>.</p>
<h3 id="giving-names-to-data-columns">Giving names to data columns</h3>
<p>In the legend at the top of the <code class="codehilite"><span class="na">.Integrated</span></code> output file,
the values of the various integrated functions will by default
be labeled <code class="codehilite">data 0</code>, <code class="codehilite">data 1</code>, etc. If you want to give more
descriptive names, just follow each <code class="codehilite">--dataColumn</code> option
with a <code class="codehilite">--dataName</code> option. </p>
<p>For example, if 
columns 8 and 11 of your data file respectively
report values of force and torque integrands, you might say
, say 
<code class="codehilite">--dataColumn 8 --dataName Force --dataColumn 11 --dataName Torque</code>.</p>
<h3 id="integrating-functions-of-frequency-and-other-parameters">Integrating functions of frequency and other parameters</h3>
<p>In many cases we will have functions that depend on various
parameters beside the integration variable, i.e. functions of the form
<script type="math/tex">f(x;p_1, \cdots, p_N)</script> where the data file includes integrand
samples for multiple sets of values of the <script type="math/tex">(p_1,\cdots,p_n)</script> 
parameters. (In <a class="wikilink" href="../../../scuff-cas3d/">scuff-cas3d</a>, for example,
we might compute Casimir forces between particles separated
by various distances <script type="math/tex">d</script>, so the integrand function may 
be thought of as a function <script type="math/tex">f(x,d)</script> of both distance and frequency.)
In these cases you will generally want to evaluate <em>separate</em> integrals
over <script type="math/tex">x</script> for each set of parameter values represented in your
data file.</p>
<p>For example, suppose your data file is called <code class="codehilite">pxfgData</code> and 
looks something like
<div class="codehilite"><pre><span></span>p1 x1 f11 g11
p1 x2 f12 g12
....
p1 xN f1N g1N
p2 x1 f21 g21
p2 x2 f22 g22
....
p2 xN f2N g2N
....
pM xN fMN gMN
</pre></div></p>
<p>where <code class="codehilite">p1,</code> <code class="codehilite">p2,</code> ..., <code class="codehilite">pM</code> denote <script type="math/tex">M</script> distinct values
of some parameter <script type="math/tex">p</script> and <code class="codehilite">fmn,gmn</code> are the numerical
integrand values <script type="math/tex">f(p_m, x_n), g(p_m,x_n)</script>. 
In this case you can't simply say
<code class="codehilite">--freqColumn2 --dataColumn 3 --dataColumn 4,</code> because then
data for all parameter values will be mashed all together and 
integrated as a single function of frequency, yielding nonsense.</p>
<p>Instead, you handle this situation by specifying the additional
command-line parameter <code class="codehilite">--tagColumn 1</code> to tell <code class="codehilite">scuff-integrate</code>
to interpret data lines with different values in column 1 
as samples of different functions:
<div class="codehilite"><pre><span></span>% scuff-integrate --datafile pxfgData --tagcolumn <span class="m">1</span> --freqColumn <span class="m">2</span> --dataColumn <span class="m">3</span> --dataColumn <span class="m">4</span>
</pre></div></p>
<p>In this case, the output file <code class="codehilite">pxfgData.Integrated</code> will report
<script type="math/tex">x</script>-integrated values of <script type="math/tex">f</script> and <script type="math/tex">g</script> separately for each value of
<script type="math/tex">p</script>.</p>
<p>If your integrands depend on multiple parameters <script type="math/tex">(p,q,\cdots)</script>,
you may specify multiple <code class="codehilite">--tagColumn</code> options to specify
the columns in which values of the various parameters live.
Then each line of the <code class="codehilite"><span class="na">.Integrated</span></code> output file will report
<script type="math/tex">x</script>-integrated values of all functions for a single tuple of 
parameter values <script type="math/tex">(p,q,\cdots).</script>
</p>
<h2 id="2-using-scuff-integrate-as-a-specialized-integrator-for-scuff-em-data">2. Using <span class=SC>scuff-integrate</span> as a specialized integrator for <span class=SC>scuff-em</span> data</h2>
<p>As noted above, <a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a> has built-in knowledge
of the structure of various data files produced by
<span class=SC>scuff-em</span> calculations. This streamlines
calculations by allowing you
you to feed those data files directly into <a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a>
without needing to tell the code which column of the data file
is which.</p>
<h3 id="2a-integrating-scuff-neq-data">2A. Integrating <a class="wikilink" href="../../../scuff-neq/">scuff-neq</a> data</h3>
<p>As discussed at the top of the page, the frequency-resolved
data reported by <a href="../../scuff-neq/scuff-neq/"><span class=SC>scuff-neq</span></a>
are generalized fluxes describing temperature-independent
rates of energy and momentum transfer from each body
to each other body in your geometry. To turn these
into total heat-transfer rates, forces, and torques
for a given set of object and environment temperatures,
we must <strong>(a)</strong> integrate over frequency with
Bose-Einstein thermal weight factors appropriate for
the given temperatures, and <strong>(b)</strong> sum the
contributions of multiple source bodies to yield
the total rates of power and momentum transfer to
each destination body. 
<span class=SC>scuff-integrate</span> already knows the
file format of the <code class="codehilite"><span class="na">.SIFlux</span></code> and <code class="codehilite"><span class="na">.SRFlux</span></code> frequency-resolved
data files produced by <a href="../../scuff-neq/scuff-neq/"><span class=SC>scuff-neq</span></a>,
so there is no need to specify <code class="codehilite">--FreqColumn</code> and <code class="codehilite">--DataColumn</code>
options. </p>
<h4 id="specifiying-temperatures">Specifiying temperatures</h4>
<p>Instead, the only input you need to supply (besides
the <code class="codehilite"><span class="na">.SIFlux</span></code> or <code class="codehilite"><span class="na">.SRFlux</span></code> data file) is a specification
of the temperatures of the bodies in your geometry,
and of the surrounding environment. By default, all bodies
and the environment are at absolute zero, <script type="math/tex">T=0</script> K; if
you do not modify this situation by setting a nonzero temperature
for at least one body (or the environment), all heat-transfer
rates and forces/torques will be zero. The command-line option
for setting </p>
<ul>
<li>
<p><code class="codehilite">--Temperature N T</code></p>
<p>If <script type="math/tex">N\ge 1</script>, this sets the temperature of the <script type="math/tex">N</script>th object/surface in the geometry to <code class="codehilite">T</code>
Kelvin.
(Here objects/surfaces are indexed using a 1-based convention; to set the temperature
of the first object/surface specified in the <code class="codehilite"><span class="na">.scuffgeo</span></code> file to room temperature
you would say <code class="codehilite">--Temperature 1 300.</code>)</p>
<p>If <script type="math/tex">N=0</script>, this instead sets the temperature of the environment to <code class="codehilite">T</code>.</p>
</li>
</ul>
<h4 id="specifiying-multiple-temperature-sets">Specifiying multiple temperature sets</h4>
<p>A bonus feature
of the separation between <a class="wikilink" href="../../../scuff-neq/">scuff-neq</a> and <a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a>
is that a single set of frequency-resolved flux data (in
an <code class="codehilite"><span class="na">.SIFlux</span></code> or <code class="codehilite"><span class="na">.SRFlux</span></code> file) can be used to obtain data on
heat-transfer rates and forces and torques at multiple sets
of temperatures for the bodies and the environment, simply by 
evaluating integral (2) multiple times with different temperatures
but the same flux data.</p>
<h4 id="spatially-integrated-flux-data-siflux-files">Spatially-integrated flux data (<code class="codehilite"><span class="na">.SIFlux</span></code> files)</h4>
<p>knows how to do this automatically </p>
<p>In this case, for a geometry containing <script type="math/tex">N</script> bodies,
each line of the <code class="codehilite"><span class="na">.SIFlux</span></code> output file is tagged with
a data field of the form <script type="math/tex">sd</script> (where <script type="math/tex">s</script> and <script type="math/tex">d</script> are
integers between 1 and <script type="math/tex">N</script>) to label the contributions
of sources in body <script type="math/tex">s</script> to the power, force, and/or torque
(PFT) on body <script type="math/tex">d</script>. (For example, lines for which this field reads
<code class="codehilite">13</code> give contributions of body 1 to the PFT for body 3).
The actual data quantities reported in the
<code class="codehilite"><span class="na">.SIFlux</span></code> file are the generalized fluxes <script type="math/tex">\Phi_{s\rightarrow d}</script>
in equation (2) above, and to evaluate the <script type="math/tex">\omega</script> integral
here we need to know the temperatures of the environment
and of all bodies in the geometry, which enter through 
the Bose-Einstein factors in (2).</p>
<p>To handle these complications, <a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a>
supports the following additional command-line options:</p>
<ul>
<li>
<p><code class="codehilite">--sdColumn xx</code> </p>
<p>Specifies that the <script type="math/tex">sd</script> indicator field appears on
column <code class="codehilite">xx</code> of the data file. (The default is <code class="codehilite">--sdColumn 3</code>,
matching the default file format of the <code class="codehilite"><span class="na">.SIFlux</span></code> files
produced by <a class="wikilink" href="../../../scuff-neq/">scuff-neq</a>, so for those files this option
may be omitted.)</p>
</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<ul>
<li>
<p><code class="codehilite">--TemperatureFile TFile</code></p>
<p>Specifies a file containing multiple temperature configurations
at which to compute total PFTs. For an <script type="math/tex">N</script>-body geometry,
each line of <code class="codehilite">TFile</code> should contain <script type="math/tex">N+1</script> space-separated
numbers in the same format as the arguments to the <code class="codehilite">--Temperature</code>
option, i.e. <code class="codehilite">TEnv T1 ... TN.</code></p>
<p>For example, to compute PFTs in a two-body geometry with the
temperature of body 1 scanned from 10 to 300 Kelvin, the
temperature of body 2 held fixed at room temperature, and the
environment temperature fixed at 0, <code class="codehilite">TFile</code> would look like</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="m">0</span> <span class="m">10</span>  <span class="m">300</span>
<span class="m">0</span> <span class="m">20</span>  <span class="m">300</span>
...
<span class="m">0</span> <span class="m">300</span> <span class="m">300</span>
</pre></div>

<h2 id="3-scuff-integrate-command-line-reference">3. <span class=SC>scuff-integrate</span> Command-Line Reference</h2>
<h2 id="4-miscellaneous-notes">4. Miscellaneous notes</h2>
<h3 id="only-numerical-data-columns-are-counted-as-columns">Only numerical data columns are counted as columns</h3>
<p>There is one potentially confusing aspect of the way
<a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a> interprets column indices as specified
by command-line arguments such as <code class="codehilite">--FreqColumn</code> or <code class="codehilite">DataColumn</code>.
This is that <em><a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a> treats non-numerical data columns
as white space</em>, and in particular does not include data columns
containing text strings when counting column indices.</p>
<p>Thus, for example, if your data file contains frequency and
integrand data in the second and third columns, with the first
column containing a character string, like this:</p>
<div class="codehilite"><pre><span></span>DEFAULT <span class="m">0</span>.1 <span class="m">3</span>.45e-5
DEFAULT <span class="m">0</span>.2 <span class="m">7</span>.82e-5
DEFAULT <span class="m">0</span>.3 <span class="m">1</span>.10e-4
...
</pre></div>

<p>then <a class="wikilink" href="../../../scuff-integrate/">scuff-integrate</a> ignores the <code class="codehilite">DEFAULT</code> column and considers
the first column with numerical data to be column 1, so here
you would say <code class="codehilite">--freqColumn 1 --dataColumn 2.</code></p>
<p>In contrast, if your data file looks instead like this: </p>
<div class="codehilite"><pre><span></span><span class="m">4</span>.00000 <span class="m">0</span>.1 <span class="m">3</span>.45e-5
<span class="m">4</span>.00000 <span class="m">0</span>.2 <span class="m">7</span>.82e-5
<span class="m">4</span>.00000 <span class="m">0</span>.3 <span class="m">1</span>.10e-4
...
</pre></div>

<p>you would want to say <code class="codehilite">--freqColumn 2 --dataColumn 3.</code></p>
                
                  
                
              
              
                



  <h2 id="__comments">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "http://homerreid.github.io/scuff-em-documentation/applications/scuff-integrate/scuff-integrate/";
      this.page.identifier =
        "/applications/scuff-integrate/scuff-integrate/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//homerreid-github-io-scuff-em-documentation.disqus.com.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../scuff-analyze/scuff-analyze/" title="scuff-analyze" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                scuff-analyze
              </span>
            </div>
          </a>
        
        
          <a href="../../../HighLevelInterface/HighLevelInterface/" title="High-Level Interface" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                High-Level Interface
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../../.."}})</script>
      
        <script src="../../../javascripts/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../../../javascripts/mathjaxhelper.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-119340518-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>