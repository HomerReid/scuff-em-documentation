



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="http://homerreid.github.io/scuff-em-documentation/examples/HalfSpaceLDOS/HalfSpaceLDOS/">
      
      
        <meta name="author" content="Homer Reid">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>LDOS and dyadic Green functions above an infinite aluminum half-space - SCUFF-EM documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.8d40d89b.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,400i,700|">
        <style>body,input{font-family:"Noto Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../../css/scuff-em.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#greens-functions-and-ldos" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://homerreid.github.io/scuff-em-documentation" title="SCUFF-EM documentation" class="md-header-nav__button md-logo">
          
            <img src="../../../reference/scuffEMLogo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                SCUFF-EM documentation
              </span>
              <span class="md-header-nav__topic">
                LDOS and dyadic Green functions above an infinite aluminum half-space
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/homerreid/scuff-em/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      scuff-em
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../" title="Examples" class="md-tabs__link md-tabs__link--active">
          Examples
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../tests/Overview/" title="Test suite" class="md-tabs__link">
          Test suite
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../reference/TopLevel/" title="General reference" class="md-tabs__link">
          General reference
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../applications/GeneralReference/" title="Command-line tools" class="md-tabs__link">
          Command-line tools
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../HighLevelInterface/HighLevelInterface/" title="High-level interface" class="md-tabs__link">
          High-level interface
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../API/libscuff/" title="Low-level API" class="md-tabs__link">
          Low-level API
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../forDevelopers/Implementation/" title="For developers" class="md-tabs__link">
          For developers
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../../reference/scuffEMLogo.png" width="48" height="48">
      
    </span>
    SCUFF-EM documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/homerreid/scuff-em/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      scuff-em
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../" title="SCUFF-EM tutorial examples" class="md-nav__link">
      SCUFF-EM tutorial examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../MieScattering/MieScattering/" title="Mie scattering" class="md-nav__link">
      Mie scattering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../DielectricShell/DielectricShell/" title="Electrostatics of a spherical dielectric shell" class="md-nav__link">
      Electrostatics of a spherical dielectric shell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ThinFilm/ThinFilm/" title="Spatially-resolved study of plane-wave transmission through an infinite-area thin dielectric film" class="md-nav__link">
      Spatially-resolved study of plane-wave transmission through an infinite-area thin dielectric film
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../DiffractionPatterns/DiffractionPatterns/" title="Imaging diffraction patterns of discs, disc arrays, and hole arrays in metal screens" class="md-nav__link">
      Imaging diffraction patterns of discs, disc arrays, and hole arrays in metal screens
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../NanorodResonantModes/NanorodResonantModes/" title="Mode frequencies and field patterns of resonant modes in gold nanorods" class="md-nav__link">
      Mode frequencies and field patterns of resonant modes in gold nanorods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CubeTorus/" title="Casimir forces in a compact geometry" class="md-nav__link">
      Casimir forces in a compact geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../SiliconBeams/SiliconBeams/" title="Casimir forces in a 1D extended geometry" class="md-nav__link">
      Casimir forces in a 1D extended geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../SiliconSlabs/SiliconSlabs/" title="Casimir forces in a 2D extended geometry" class="md-nav__link">
      Casimir forces in a 2D extended geometry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../NanostructureCasimirPolder/NanostructureCasimirPolder/" title="Casimir-Polder potentials in dielectric nanostructures" class="md-nav__link">
      Casimir-Polder potentials in dielectric nanostructures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../SiO2Spheres/SiO2Spheres/" title="Thermal radiation, heat transfer, and non-equilibrium Casimir forces between silicon dioxide spheres" class="md-nav__link">
      Thermal radiation, heat transfer, and non-equilibrium Casimir forces between silicon dioxide spheres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../TipSubstrate/TipSubstrate/" title="Spatial distribution of heat flux from a warm tip over a cold substrate" class="md-nav__link">
      Spatial distribution of heat flux from a warm tip over a cold substrate
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        LDOS and dyadic Green functions above an infinite aluminum half-space
      </label>
    
    <a href="./" title="LDOS and dyadic Green functions above an infinite aluminum half-space" class="md-nav__link md-nav__link--active">
      LDOS and dyadic Green functions above an infinite aluminum half-space
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#greens-functions-and-ldos" title="Green's functions and LDOS" class="md-nav__link">
    Green's functions and LDOS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-greens-functions" title="Computing Green's functions" class="md-nav__link">
    Computing Green's functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmsh-geometry-files-for-unit-cell-geometries" title="gmsh geometry files for unit-cell geometries" class="md-nav__link">
    gmsh geometry files for unit-cell geometries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scuff-em-geometry-files" title="scuff-em geometry files" class="md-nav__link">
    scuff-em geometry files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-of-evaluation-points" title="List of evaluation points" class="md-nav__link">
    List of evaluation points
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#studying-the-integrand-to-select-the-optimal-cubature-rule" title="Studying the integrand to select the optimal cubature rule" class="md-nav__link">
    Studying the integrand to select the optimal cubature rule
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checking-brillouin-zone-symmetry" title="Checking Brillouin-zone symmetry" class="md-nav__link">
    Checking Brillouin-zone symmetry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observing-the-variation-of-the-integrand-with-mathbfk_textb" title="Observing the variation of the integrand with |\mathbf{k}_\text{B}|" class="md-nav__link">
    Observing the variation of the integrand with |\mathbf{k}_\text{B}|
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-full-brillouin-zone-integrated-calculations" title="Running full Brillouin-zone-integrated calculations" class="md-nav__link">
    Running full Brillouin-zone-integrated calculations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../PlatonicSolids/PlatonicSolids/" title="Electrostatic polarizability of platonic solids" class="md-nav__link">
      Electrostatic polarizability of platonic solids
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../TwoBodyCapacitors/TwoBodyCapacitors/" title="Capacitance of two-body capacitors" class="md-nav__link">
      Capacitance of two-body capacitors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../StriplineCapacitor/StriplineCapacitor/" title="Capacitance of a PCB stripline trace" class="md-nav__link">
      Capacitance of a PCB stripline trace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ImplicitSubstrate/ImplicitSubstrate/" title="Implicit handling of multilayer dielectric substrates" class="md-nav__link">
      Implicit handling of multilayer dielectric substrates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pythonCapacitance/pythonCapacitance/" title="Finite-size effects in stripline capacitors" class="md-nav__link">
      Finite-size effects in stripline capacitors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../PaulTrap/PaulTrap/" title="Electrostatic fields of an electrode array" class="md-nav__link">
      Electrostatic fields of an electrode array
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../YagiUdaAntennas/YagiUdaAntennas/" title="Z-parameters and directivity of Yagi-Uda antennas" class="md-nav__link">
      Z-parameters and directivity of Yagi-Uda antennas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../MicrostripDevices/MicrostripDevices/" title="Input impedance, mutual coupling, and radiated fields of microstrip RF devices" class="md-nav__link">
      Input impedance, mutual coupling, and radiated fields of microstrip RF devices
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Test suite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Test suite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/Overview/" title="Overview of the test suite" class="md-nav__link">
      Overview of the test suite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/MieScattering/MieScattering/" title="Mie scattering" class="md-nav__link">
      Mie scattering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/FresnelScattering/FresnelScattering/" title="Fresnel scattering" class="md-nav__link">
      Fresnel scattering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/CasimirSpheres/CasimirSpheres/" title="Equilibrium Casimir forces between spheres" class="md-nav__link">
      Equilibrium Casimir forces between spheres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/CasimirPlates/CasimirPlates/" title="Equilibrium Casimir forces between plates" class="md-nav__link">
      Equilibrium Casimir forces between plates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/CPSphere/CPSphere/" title="Equilibrium Casimir-Polder potential near a sphere" class="md-nav__link">
      Equilibrium Casimir-Polder potential near a sphere
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/CPPlate/CPPlate/" title="Equilibrium Casimir-Polder potential near a plate" class="md-nav__link">
      Equilibrium Casimir-Polder potential near a plate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/NEQSpheres/NEQSpheres/" title="Heat transfer and non-equilibrium Casimir forces between spheres" class="md-nav__link">
      Heat transfer and non-equilibrium Casimir forces between spheres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tests/libscuff/libscuff/" title="Low-level tests of the core library" class="md-nav__link">
      Low-level tests of the core library
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      General reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        General reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/TopLevel/" title="Top-level overview" class="md-nav__link">
      Top-level overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/Installing/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/Geometries/" title="Geometry descriptions" class="md-nav__link">
      Geometry descriptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/EquivalentEdgeSurfacePairs/" title="Equivalent edge/surface pairs" class="md-nav__link">
      Equivalent edge/surface pairs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/Materials/" title="Material designations" class="md-nav__link">
      Material designations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/Transformations/" title="Geometric transformations" class="md-nav__link">
      Geometric transformations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/IncidentFields/" title="Incident fields" class="md-nav__link">
      Incident fields
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/BrillouinZoneIntegration/" title="Brillouin zone integration" class="md-nav__link">
      Brillouin zone integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/FAQ/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Command-line tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Command-line tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/GeneralReference/" title="General command-line reference" class="md-nav__link">
      General command-line reference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-scatter/scuff-scatter/" title="scuff-scatter" class="md-nav__link">
      scuff-scatter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-transmission/scuff-transmission/" title="scuff-transmission" class="md-nav__link">
      scuff-transmission
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-ldos/scuff-ldos/" title="scuff-ldos" class="md-nav__link">
      scuff-ldos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-tmatrix/scuff-tmatrix/" title="scuff-tmatrix" class="md-nav__link">
      scuff-tmatrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-cas3D/scuff-cas3D/" title="scuff-cas3D" class="md-nav__link">
      scuff-cas3D
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-caspol/scuff-caspol/" title="scuff-caspol" class="md-nav__link">
      scuff-caspol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-neq/scuff-neq/" title="scuff-neq" class="md-nav__link">
      scuff-neq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-rf/scuff-rf/" title="scuff-rf" class="md-nav__link">
      scuff-rf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-static/scuff-static/" title="scuff-static" class="md-nav__link">
      scuff-static
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-spectrum/scuff-spectrum/" title="scuff-spectrum" class="md-nav__link">
      scuff-spectrum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-analyze/scuff-analyze/" title="scuff-analyze" class="md-nav__link">
      scuff-analyze
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../applications/scuff-integrate/scuff-integrate/" title="scuff-integrate" class="md-nav__link">
      scuff-integrate
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      High-level interface
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        High-level interface
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../HighLevelInterface/HighLevelInterface/" title="High-Level Interface" class="md-nav__link">
      High-Level Interface
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Low-level API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Low-level API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../API/libscuff/" title="libscuff" class="md-nav__link">
      libscuff
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../API/MainFlow/" title="MainFlow API" class="md-nav__link">
      MainFlow API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../API/UtilityAPI/" title="Utility API" class="md-nav__link">
      Utility API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      For developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        For developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../forDevelopers/Implementation/" title="Implementation" class="md-nav__link">
      Implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../forDevelopers/DataStructures/" title="Data Structures" class="md-nav__link">
      Data Structures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../forDevelopers/Documentation/" title="Documentation" class="md-nav__link">
      Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../forDevelopers/SingularIntegrals/" title="Code for computing singular integrals" class="md-nav__link">
      Code for computing singular integrals
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#greens-functions-and-ldos" title="Green's functions and LDOS" class="md-nav__link">
    Green's functions and LDOS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-greens-functions" title="Computing Green's functions" class="md-nav__link">
    Computing Green's functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmsh-geometry-files-for-unit-cell-geometries" title="gmsh geometry files for unit-cell geometries" class="md-nav__link">
    gmsh geometry files for unit-cell geometries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scuff-em-geometry-files" title="scuff-em geometry files" class="md-nav__link">
    scuff-em geometry files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-of-evaluation-points" title="List of evaluation points" class="md-nav__link">
    List of evaluation points
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#studying-the-integrand-to-select-the-optimal-cubature-rule" title="Studying the integrand to select the optimal cubature rule" class="md-nav__link">
    Studying the integrand to select the optimal cubature rule
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checking-brillouin-zone-symmetry" title="Checking Brillouin-zone symmetry" class="md-nav__link">
    Checking Brillouin-zone symmetry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observing-the-variation-of-the-integrand-with-mathbfk_textb" title="Observing the variation of the integrand with |\mathbf{k}_\text{B}|" class="md-nav__link">
    Observing the variation of the integrand with |\mathbf{k}_\text{B}|
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-full-brillouin-zone-integrated-calculations" title="Running full Brillouin-zone-integrated calculations" class="md-nav__link">
    Running full Brillouin-zone-integrated calculations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/homerreid/scuff-em/edit/master/docs/examples/HalfSpaceLDOS/HalfSpaceLDOS.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1>Dyadic Green's Functions and LDOS above a material half-space</h1>

<p>In this example, we exploit <a class="wikilink" href="../../../scuff-em/">scuff-em</a>'s
<a href="../../../reference/Geometries/#Extended">support for 2D periodic geometries</a>
by using <a href="../../../applications/scuff-ldos/scuff-ldos/"><span class="SC">scuff-ldos</span></a>
to compute dyadic Green's functions (DGFs) and 
electromagnetic local densities of states (LDOS) 
at evaluation points lying above an
infinite planar dielectric interface.</p>
<p>Because this geometry happens to be amenable to an analytical
treatment, we will also <em>check</em> the numerical results of
<a class="wikilink" href="../../../scuff-em/">scuff-em</a> against the results of analytical calculations of
the LDOS.</p>
<p>The files for this example may be found in the
<code class="codehilite">share/scuff-em/examples/HalfSpaceLDOS</code> subdirectory
of your <a class="wikilink" href="../../../scuff-em/">scuff-em</a> installation.</p>
<h4 id="review-what-we-are-computing-and-why-we-need-brillouin-zone-integration">Review: What we are computing and why we need Brillouin-zone integration</h4>
<p>For the benefit of users who may be wondering why numerical Brillouin-zone
integration is needed for this calculation, this section briefly reviews
some of the theoretical background. 
(This material is discussed in more detail in the memo
<a href="../../../tex/scuff-ldos.pdf">Computation of Green's Functions and LDOS in <span class="SC">scuff-em</span></a>).
If you just want to get started running the calculations in <a class="wikilink" href="../../../scuff-em/">scuff-em</a>, 
feel free to <a href="#GMSHFiles">skip to the next section</a>.</p>
<h5 id="greens-functions-and-ldos">Green's functions and LDOS</h5>
<p>The scattering dyadic Green's function
<script type="math/tex">\boldsymbol{\mathcal G}^{\text E}(\omega;
             \mathbf{x}_{\text D},
             \mathbf{x}_{\text S})</script>
of a material geometry
is a <script type="math/tex">3\times 3</script> matrix whose <script type="math/tex">i,j</script> entry is proportional to the
<script type="math/tex">i</script>-component of the scattered electric field 
at <script type="math/tex">\mathbf{x}_{\text D}</script> due to a 
<script type="math/tex">j</script>-directed point electric dipole source at
<script type="math/tex">\mathbf{x}_{\text S}</script>, all quantities having
time dependence <script type="math/tex">\sim e^{-i\omega t}</script>. (We could also 
consider the magnetic Green's function
<script type="math/tex">\boldsymbol{\mathcal G}^{\text M}</script>,
which describes the scattered <em>magnetic</em> fields
arising from a point <em>magnetic</em> dipole excitation.)
The subscripts "D" and "S" label the "destination" and 
"source" points; if these coincide
<script type="math/tex">(\mathbf{x}_{\text D}=\mathbf{x}_{\text S})</script>,
we are talking about <em>one-point DGFs</em>; otherwise
we have <em>two-point DGFs.</em></p>
<p>The one-point scattering DGFs for a material geometry contain
information on how the bodies in the geometry modify
the electromagnetic local density of states (LDOS)
in the vicinity of the body. More specifically,
the full LDOS <script type="math/tex">\rho(\mathbf{x})</script> at a point <script type="math/tex">\mathbf{x}</script>
may be decomposed as a sum of electric and magnetic
contributions, which themselves may be further decomposed
into vacuum and scattering contributions:
<script type="math/tex; mode=display"> \begin{array}{lcl}
\rho(\omega; \mathbf{x}) &=& \rho^\text{E}(\omega; \mathbf{x}) + \rho^\text{M}(\omega; \mathbf{x})
\\[5pt]
\rho^{\text{E,M}}(\mathbf{x})
 &=&   \rho_0(\omega)
     + \Delta \rho^\text{E,M}(\omega; \mathbf{x})
\\[5pt]
\rho_0(\omega) &=&\frac{\omega^2}{\pi^2 c^3}
\\[5pt]
\Delta \rho^{\text{E,M}}(\omega; \mathbf{x})
 &=& \frac{\omega}{\pi c^2}
     \text{Tr Im }\boldsymbol{\mathcal{G}}^\text{E,M}(\omega; \mathbf{x}, \mathbf{x})
\end{array}</script>
</p>
<h5 id="computing-greens-functions">Computing Green's functions</h5>
<p>The electric and magnetic DGFs for a given source point
(and any number of destination points)
collectively describe the results of 6 scattering
problems (with incident fields produced by electric and
magnetic dipoles oriented in each of the 3 cartesian
directions), and---for <em>compact</em> geometries---could
be computed in <span class=SC>scuff-em</span> simply by
assembling 6 right-hand-side vectors, solving the 
BEM system for the corresponding surface currents, and
computing the scattered fields at all desired destination
points. </p>
<p>However, the situation is more complicated for
infinitely extended geometries. 
<a href="../../../reference/Geometries/#Extended">Recall</a> that such
geometries are described in <a class="wikilink" href="../../../scuff-em/">scuff-em</a> by a
unit-cell geometry together with a basis of vectors 
for a (one- or two-dimensional) lattice <script type="math/tex">\mathcal{L}</script>.
By restricting our attention to scattering problems
in which the incident fields (and thus all fields and
currents) satisfies the Bloch-periodicity
condition 
<script type="math/tex; mode=display">f(\mathbf{x}+\mathbf{L})
  =
  e^{i\mathbf{k}_\text{B}\cdot \mathbf{L}}f(\mathbf{x})
  \quad\text{ for all } \quad
  \mathbf{L}\in\mathcal{L}
</script>
for some Bloch wavevector <script type="math/tex">\mathbf{k}_\text{B}</script>,
we can get away with solving only for the surface
currents within the unit cell, the currents
everywhere else being then fixed by the Bloch periodicity.
This is the basic magic trick that allows infinite
geometries to be modeled on finite computers.</p>
<p>Of course, the restriction to scattering problems involving
only Bloch-periodic incident fields is in fact highly restrictive;
indeed, it excludes the particular problem we must solve
to compute DGFs and LDOS, in which the incident field emanates
from a point source at <script type="math/tex">\mathbf{x}_\text{S}</script> and is certainly 
not Bloch-periodic. But here we can avail to the linearity
of Maxwell's equations and the magic of Fourier analysis.
Instead of solving a scattering problem involving the field
of a point source at <script type="math/tex">\mathbf{x}_\text{S}</script>, we consider
the field of an infinite phased <em>array</em> of point sources,
located at points <script type="math/tex">\{\mathbf{x}_\text{S} + \mathbf{L}\}</script>
with phases <script type="math/tex">e^{i\mathbf{k}_\text{B} \cdot \mathbf{L}}</script>,
for all <script type="math/tex">\mathbf{L}\in \mathcal{L}</script>. This <em>is</em> a
Bloch-periodic field, so we can take it as the incident
field in a <a class="wikilink" href="../../../scuff-em/">scuff-em</a> scattering problem, 
and the 
resulting scattered fields at <script type="math/tex">\mathbf{x}_\text{D}</script>
define the <em>Bloch-periodic scattering DGFs</em>
<script type="math/tex">\overline{\boldsymbol{\mathcal{G}}}(\omega; \mathbf{k}_\text{B};
\mathbf{x}_\text{D}, \mathbf{x}_\text{S}).</script>
To recover the non-periodic DGF <script type="math/tex">\boldsymbol{\mathcal{G}}</script>
from <script type="math/tex">\overline{\boldsymbol{\mathcal{G}}}</script>, we now
imagine solving and summing the results of
many scattering problems involving our infinite array
of point sources phased with many different Bloch vectors 
<script type="math/tex">\mathbf{k}_\text{B}</script>, chosen cleverly to ensure that the
contributions of the single point source at <script type="math/tex">\mathbf{x}_\text{S}</script> add
constructively, while the contributions of all <em>other</em> 
point sources in the array add destructively
and cancel. The formal expression of this procedure
is a sort of inverse Fourier transform relating
<script type="math/tex">\boldsymbol{\mathcal{G}}</script> to the average of
<script type="math/tex">\overline{\boldsymbol{\mathcal{G}}}(\mathbf{k}_\text{B})</script> 
over the Brillouin zone (BZ) of the reciprocal lattice:
<script type="math/tex; mode=display"> \boldsymbol{\mathcal G}(\omega; \mathbf{x}_\text{D}, \mathbf{x}_\text{S})
  =\frac{1}{V_\text{BZ}}
   \int_\text{BZ}
   \overline{\boldsymbol{\mathcal G}}(\omega; \mathbf{k}_\text{B};
                           \mathbf{x}_\text{D},
                           \mathbf{x}_\text{S})
   \, d\mathbf{k}_\text{B}
   \qquad (1)
</script>
or, evaluating the integral approximately by numerical cubature,
<script type="math/tex; mode=display"> \boldsymbol{\mathcal G}(\omega; \mathbf{x}_\text{D}, \mathbf{x}_\text{S})
   \approx \frac{1}{V_\text{BZ}}
   \sum_{m} w_m 
   \overline{\boldsymbol{\mathcal G}}(\omega; \mathbf{k}_{\text{B}m}; \mathbf{x}_\text{D},
                           \mathbf{x}_\text{S})
</script>
where <script type="math/tex">\{\mathbf{k}_{\text{B}m}, w_m\}</script> are the points and weights in a
cubature rule for integration over the Brillouin zone.
Thus, getting the LDOS at a single point in a periodic geometry
requires summing the results of many scattering calculations at
various Bloch vectors <script type="math/tex">\mathbf{k}_{\text{B}m}</script> lying in the Brillouin 
zone of the reciprocal lattice.</p>
<p>The question of how to choose the cubature rule---that is, the set of
Bloch vectors <script type="math/tex">\{\mathbf{k}_{\text{B}m}\}</script> at which the integrand
is sampled and the weights <script type="math/tex">\{w_m\}</script> with which the samples are 
combined---to yield accurate integral estimates without exorbitant 
computational cost is a tricky one, and one whose answer varies from 
problem to problem. There are two ways to proceed:</p>
<ul>
<li>You can design your own cubature scheme for integration over
the Brillouin zone, and simply ask <a class="wikilink" href="../../../scuff-ldos/">scuff-ldos</a> to give you
values of the integrand 
<script type="math/tex">\overline{\boldsymbol{\mathcal{G}}}(\mathbf{k}_\text{B})</script>
at specific Bloch vectors <script type="math/tex">\bf k_\text{B}</script>.
In this case you will pass the <code class="codehilite">--OmegakBlochFile</code> command-line
argument to <a class="wikilink" href="../../../scuff-ldos/">scuff-ldos</a>, and you will get back a data file
(with extension <code class="codehilite"><span class="na">.byOmegakBloch</span></code>) reporting values of 
<script type="math/tex">\overline{\boldsymbol{\mathcal{G}}}</script> at each <script type="math/tex">\bf k_\text{B}</script>
point you specified. (See below for examples).</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>Alternatively, you can use the built-in Brillouin-zone integrator
in <a class="wikilink" href="../../../scuff-ldos/">scuff-ldos</a> to perform the BZ integral automatically. In this
case you will get back a data file with extension <code class="codehilite"><span class="na">.LDOS</span></code>
reporting values of <script type="math/tex">\boldsymbol{\mathcal{G}}</script> and <script type="math/tex">\Delta\rho</script>
at each frequency and evaluation point you specified, <em>plus</em> a 
data file with extension <code class="codehilite"><span class="na">.byOmegakBloch</span></code> reporting the Bloch
vectors <script type="math/tex">\bf k_\text{B}</script> at which the internal integrator
sampled the integrand and the values of
<script type="math/tex">\overline{\boldsymbol{\mathcal{G}}}(\bf k_\text{B})</script> 
at each sample point. 
In this case you will probably want to set various command-line 
options to optimize the integral evaluation; this is illustrated
below and discussed in more detail on the page 
<a href="../../../reference/BrillouinZoneIntegration/">Brillouin-zone integration in <span class="SC">scuff-em</span></a>.</li>
</ul>
<hr />
<p><a name="GMSHFiles"></p>
<h2 id="gmsh-geometry-files-for-unit-cell-geometries"><a class="wikilink" href="../../../gmsh/">gmsh</a> geometry files for unit-cell geometries</h2>
<p>To compute DGFs and LDOS in a half-space geometry,
we will describe the interface between the upper (vacuum)
and lower (dielectric) regions of our geometry as the
infinite periodic replication of a unit-cell mesh 
over the sites of a 2D square lattice.
Because this particular geometry has infinite translational
symmetry, we are free to choose the lattice constant 
<script type="math/tex">L=L_x=L_y</script> however we like; here we will consider 
the two values <script type="math/tex">L=10</script> nm and <script type="math/tex">L=100</script> nm.</p>
<p>The <a class="wikilink" href="../../../gmsh/">gmsh</a> geometry file <a href="../Square_L_N.geo"><code class="codehilite">Square_L_N.geo</code></a>
describes a square with user-adjustable parameters 
<code class="codehilite">L</code> and <code class="codehilite">N</code> that may be configured using the <code class="codehilite">-setnumber</code>
option on the <a class="wikilink" href="../../../gmsh/">gmsh</a> command line to define the square
side length and the number of triangle edges per side length 
(the meshing fineness). To produce unit-cell meshes for
the two desired lattice constants, I go like this:</p>
<p><div class="codehilite"><pre><span></span>% gmsh -2 -setnumber L <span class="m">0</span>.1 -setnumber N <span class="m">4</span> Square_L_N.geo -o Square_L0P1.msh 
% RenameMesh Square_L0P1.msh

% gmsh -2 -setnumber L <span class="m">0</span>.01 -setnumber N <span class="m">4</span> Square_L_N.geo -o Square_L0P01.msh 
% RenameMesh Square_L0P01.msh
</pre></div>
(Here <a href="../../../examples/SiO2Spheres/RenameMesh"><code class="codehilite">RenameMesh</code></a> is a simple <code class="codehilite">bash</code> script
that uses <a class="wikilink" href="../../../scuff-analyze/">scuff-analyze</a> to count the number of interior
edges in a surface mesh and rename the mesh file accordingly.)
These commands produce the files 
<code class="codehilite">Square_L0P1_40.msh</code> and <code class="codehilite">Square_L0P01_40.msh.</code> I also repeat the 
process with <code class="codehilite">-setnumber N 8</code> to yield finer meshes (with 176 instead
of 40 interior edges).
These meshes may be visualized in <a class="wikilink" href="../../../gmsh/">gmsh</a> by saying e.g.</p>
<div class="codehilite"><pre><span></span>% gmsh Square_L0P1.40.msh
% gmsh Square_L0P01.176.msh
</pre></div>

<p><img alt="Square_L0P1_40.png" src="../Square_L0P1_40.png" />
<img alt="Square_L0P01_176.png" src="../Square_L0P01_176.png" /></p>
<p>Note the following:</p>
<ul>
<li>
<p>For 2D periodic geometries in <a class="wikilink" href="../../../scuff-em/">scuff-em</a>, the 
   lattice vectors must lie in the <script type="math/tex">xy</script> plane.</p>
</li>
<li>
<p>For surfaces that straddle the unit-cell boundaries
   (as is the case here), each triangle edge that lies
   on any edge of the unit cell must have an identical
   image edge on the opposite side of the unit cell.
   An easy way to achieve this is to use <em>extrusions</em>
   in <a class="wikilink" href="../../../gmsh/">gmsh</a>, as in the <code class="codehilite"><span class="na">.geo</span></code> file above.</p>
</li>
<li>
<p>Among the various possible ways to discretize a square
intro triangles, I have chosen one that preserves as 
much symmetry as possible---specifically, the mesh 
is symmetric under the transformations
<script type="math/tex">x \leftrightarrow -x</script>, <script type="math/tex">y \leftrightarrow -y</script>, and
<script type="math/tex">x \leftrightarrow y</script>. This is important for exploiting
symmetries to reduce the cost of Brillouin-zone integration
(see below).</p>
</li>
</ul>
<p>The <code class="codehilite"><span class="na">.msh</span></code> files needed to run the calculations in this
tutorial may be found in the <code class="codehilite">mshFiles/</code> subfolder
of the <code class="codehilite">HalfSpaceLDOS</code> example distributed with
<a class="wikilink" href="../../../scuff-em/">scuff-em</a>.</p>
<hr />
<h2 id="scuff-em-geometry-files"><a class="wikilink" href="../../../scuff-em/">scuff-em</a> geometry files</h2>
<p>For each unit-cell mesh I create
<a href="../../../reference/Geometries/"><span class="SC">scuff-em</span> geometry files</a>
describing three material geometries:</p>
<ul>
<li>
<p>an infinite-area perfectly electrically conducting (PEC) plate at height <script type="math/tex">z=0</script>;</p>
</li>
<li>
<p>an infinite lossless dielectric (<script type="math/tex">\epsilon \equiv 10</script>) filling
  space for <script type="math/tex">z<0</script>, with vacuum for <script type="math/tex">z>0</script>;</p>
</li>
<li>
<p>same as previous, but now with lossy metal (aluminum) instead
  of lossless dielectric.</p>
</li>
</ul>
<p>The resulting <code class="codehilite"><span class="na">.scuffgeo</span></code> files may be found in the 
<code class="codehilite">scuffgeoFiles/</code> subfolder of the <code class="codehilite">HalfSpaceLDOS</code>
example directory.
For example, the PEC-plate geometry at the coarser resolution
with the longer lattice constant is
<a href="../scuffgeoFiles/PECPlate_L0P1_40.scuffgeo"><code class="codehilite">PECPlate_L0P1_40.scuffgeo</code></a>,
while the aluminum half-space geometry at the finer resolution
with the shorter lattice constant is
<a href="../scuffgeoFiles/AlHalfSpace_L0P01_176.scuffgeo"><code class="codehilite">AlHalfSpace_L0P01_176.scuffgeo</code></a>.
The latter file looks like this:
<div class="codehilite"><pre><span></span><span class="c1"># this comes from Phys Rev B **68** 245405</span>
MATERIAL ALUMINUM
    <span class="nv">wp</span> <span class="o">=</span> <span class="m">1</span>.747e16<span class="p">;</span> 
    <span class="nv">gamma</span> <span class="o">=</span> <span class="m">7</span>.596e13<span class="p">;</span>
    Eps<span class="o">(</span>w<span class="o">)</span> <span class="o">=</span> <span class="m">1</span> - wp^2 / <span class="o">(</span>w * <span class="o">(</span>w + i*gamma<span class="o">))</span><span class="p">;</span>
ENDMATERIAL

LATTICE
    VECTOR <span class="m">0</span>.01 <span class="m">0</span>.00
    VECTOR <span class="m">0</span>.00 <span class="m">0</span>.01
ENDLATTICE

REGION UpperHalfSpace MATERIAL Vacuum
REGION Exterior       MATERIAL Aluminum

SURFACE Plate
    MESHFILE Square_L0P01_176.msh
    REGIONS Exterior UpperHalfSpace
ENDSURFACE
</pre></div></p>
<hr />
<h2 id="list-of-evaluation-points">List of evaluation points</h2>
<p>We'll compute one-point DGFs and LDOS at four points,
located at distances of 1, 10, 100, and 1000 nm above
the surface on the <script type="math/tex">z</script>-axis (<script type="math/tex">x=y=0</script>). Thus our evaluation-point
file (<code class="codehilite">EPFile</code>) looks like this:</p>
<div class="codehilite"><pre><span></span><span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.001
<span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.010
<span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">0</span>.100
<span class="m">0</span>.0 <span class="m">0</span>.0 <span class="m">1</span>.000
</pre></div>

<hr />
<h3 id="studying-the-integrand-to-select-the-optimal-cubature-rule">Studying the integrand to select the optimal cubature rule</h3>
<p>Ultimately we will want to launch a full
Brillouin-zone-integrated calculation to get
the total LDOS at our desired evaluation points 
and frequencies. However, before doing this we
should acquire some insight into the behavior of
the integrand so that we can make intelligent
choices for the various 
<a href="../../../reference/BrillouinZoneIntegration/">options controlling Brillouin-zone integration</a>.</p>
<h4 id="checking-brillouin-zone-symmetry">Checking Brillouin-zone symmetry</h4>
<p>A first thing to check is the <em>symmetry</em> of the
integrand within the Brillouin zone (BZ).
As discussed <a href="../../../reference/BrillouinZoneIntegration/">here</a>, the built-in cubature
routines for 2D BZ integration in <a class="wikilink" href="../../../scuff-em/">scuff-em</a>
can exploit 2, 4, or 8-fold rotational symmetry.
In this case, because</p>
<ul>
<li>
<p><strong>(1)</strong> the underlying (real-space) geometry is symmetric
under <script type="math/tex">x\leftrightarrow -x</script>, <script type="math/tex">y\leftrightarrow -y</script>,
and <script type="math/tex">x\leftrightarrow y</script>,</p>
</li>
<li>
<p><strong>(2)</strong> we have chosen a mesh discretization that 
preserves these symmetries, and</p>
</li>
<li>
<p><strong>(3)</strong> we are computing a one-point DGF, </p>
</li>
</ul>
<p>we expect the BZ integrand 
<script type="math/tex">\overline{\boldsymbol{\mathcal{G}}}(k_x,k_y)</script>
to have 8-fold rotational symmetry, and thus
we should be able to restrict the domain of the 
BZ integration to just the <em>irreducible</em> Brillouin
zone (a triangular wedge having 1/8 the total area
of the BZ, as shown <a href="../../../reference/BrillouinZoneIntegration/#IrreducibleBZ">here</a>) and multiply by 8 
to get the full BZ integral. </p>
<p>To test this, we'll run a quick first calculation in which
we compute just the integrand <script type="math/tex">\boldsymbol{\mathcal{G}}(k_x,k_y)</script>
at 8 <script type="math/tex">(k_x,k_y)</script> points related by symmetry. Specifically,
for a square lattice with lattice constant <script type="math/tex">L=100\text{ nm}</script>
(reciprocal lattice constant <script type="math/tex">\Gamma=\frac{2\pi}{100\text{ nm}}</script>)
we'll consider the point
<script type="math/tex; mode=display">(k_x,k_y)=(0.40\Gamma,0.27\Gamma)\approx(25,17)\,\mu\text{m}^{-1}</script>
and the 7 other points obtained by flipping signs and interchanging
components. Here's a picture showing the locations of these 8 points
within in the BZ:</p>
<p><img alt="EightPoints.png" src="../EightPoints.png" /></p>
<p>Working at angular frequency <script type="math/tex">\omega=10 \cdot 3\times 10^{14}</script> rad/sec,
we create a little text file named <a href="../EightPoints"><code class="codehilite">EightPoints</code></a> listing the
<script type="math/tex">(\omega, k_x, k_y)</script> values at which we want to sample the BZ integrand:</p>
<div class="codehilite"><pre><span></span><span class="m">10</span> +25 +17
<span class="m">10</span> +17 +25
<span class="m">10</span> -17 +25
<span class="m">10</span> -25 +17
<span class="m">10</span> -25 -17
<span class="m">10</span> -17 -25
<span class="m">10</span> +17 -25
<span class="m">10</span> +25 -17
</pre></div>

<p>Now run <a class="wikilink" href="../../../scuff-ldos/">scuff-ldos</a>:</p>
<div class="codehilite"><pre><span></span>% scuff-ldos --geometry scuffgeoFiles/AlHalfSpace_L0P1_40.scuffgeo --OmegakBlochFile EightPoints --EPFile EPFile
</pre></div>

<p>This produces the file <code class="codehilite">AlHalfSpace_L0P1_40.byOmegakBloch</code>,
in which each individual line reports <script type="math/tex">\overline{\mathcal{G}}</script> values
for a single evaluation point, frequency, and Bloch vector.
Looking at just the portion of the file corresponding to the
evaluation point at <script type="math/tex">z=100</script> nm, we see this:</p>
<p><img alt="EightPointsOutput.png" src="../EightPointsOutput.png" /></p>
<p>This shows that, as expected, the Brillouin-zone integrands for
the electric and magnetic LDOS <script type="math/tex">\rho^\text{E,M}</script> are
invariant---up to small numerical errors on the order 
of around 1%, which are reduced to around 0.1% when we re-run
the calculation on the finer [N=176] mesh---under the 8-fold
symmetry relating the various Brillouin-zone points here. 
Later we will exploit this symmetry by specifying the command-line
option <code class="codehilite">--BZSymmetryFactor 8</code> to reduce the cost of
evaluating the full BZ integral.</p>
<p>Incidentally, notice that the individual components of the DGFs (such as
<script type="math/tex">\overline{\mathcal{G}}_{xx}</script>) do <em>not</em> obey the full set of symmetries obeyed by the LDOS. You will need to take this into account if your goal is to compute DGFs and not just LDOS.</p>
<h4 id="observing-the-variation-of-the-integrand-with-mathbfk_textb">Observing the variation of the integrand with <script type="math/tex">|\mathbf{k}_\text{B}|</script>
</h4>
<p>Another diagnostic test is to inspect the variation of the integrand with the magnitude of the Bloch vector. For this purpose we'll compute the integrand at points lying on the <script type="math/tex">x</script>-axis between the origin and the edge of the BZ, again working with the <script type="math/tex">L=100</script> nm lattice at <script type="math/tex">\omega=10</script>.  We create a file called <code class="codehilite">XAxisPoints</code> specifying the (<script type="math/tex">\omega,k_x,k_y</script>) points we want to sample: </p>
<div class="codehilite"><pre><span></span><span class="m">10</span>  <span class="m">00</span>.0  <span class="m">0</span>.0
<span class="m">10</span>  <span class="m">1</span>.57  <span class="m">0</span>.0
<span class="m">10</span>  <span class="m">3</span>.14  <span class="m">0</span>.0
...
<span class="m">10</span>  <span class="m">29</span>.8  <span class="m">0</span>.0
<span class="m">10</span>  <span class="m">31</span>.4  <span class="m">0</span>.0
</pre></div>

<p>Run <a class="wikilink" href="../../../scuff-ldos/">scuff-ldos</a>:</p>
<div class="codehilite"><pre><span></span>% scuff-ldos --geometry scuffgeoFiles/AlHalfSpace_L0P1_40.scuffgeo --OmegakBlochFile XAxisPoints --EPFile EPFile
</pre></div>

<p>This produces the file <code class="codehilite">AlHalfSpace_L0P1_40.byOmegakBloch.</code>
We plot the BZ integrand for the electric LDOS 
<script type="math/tex">\rho^\text{E}(\mathbf{k})</script> versus <script type="math/tex">k_x</script> at <script type="math/tex">z=100</script> nm: </p>
<div class="codehilite"><pre><span></span>% gnuplot
gnuplot&gt; <span class="nv">FILE</span><span class="o">=</span><span class="s1">&#39;AlHalfSpace_L0P1_40.byOmegakBloch&#39;</span>
gnuplot&gt; <span class="nb">set</span> yrange <span class="o">[</span>-100:100<span class="o">]</span>
gnuplot&gt; plot FILE u <span class="o">(</span><span class="nv">$3</span><span class="o">==</span><span class="m">0</span>.1 ? <span class="nv">$6</span> : <span class="m">1</span>/0<span class="o">)</span>:8 w lp pt <span class="m">7</span> ps <span class="m">1</span>
</pre></div>

<p><img alt="RhoEVskX.png" src="../RhoEVskX.png" /></p>
<p>Whoops! There seems to be some sort of blowup happening
near <script type="math/tex">k_x=10</script>, i.e. near the point <script type="math/tex">k_x=\frac{\omega}{c}</script>
where the Bloch wavelength coincides with the free-space
photon wavelength. Zooming in on the region near <script type="math/tex">k_x=10</script>,
the data look like this (where we have additionally plotted
data for evaluation points at a couple of other heights
off the surface):</p>
<p><img alt="RhoEVskXLogScale.png" src="../RhoEVskXLogScale.png" /></p>
<p>The important things to read off from this plot are:</p>
<ul>
<li>
<p>As <script type="math/tex">|\mathbf{k}_\text{B}|\to k_0\equiv \frac{\omega}{c}</script> from below, the integrand
  blows up like <script type="math/tex">1/\sqrt{k_0 - |\mathbf{k}_\text{B}|}.</script>
</p>
</li>
<li>
<p>On the other side of <script type="math/tex">k_0</script>, the integrand decays exponentially
  at a <script type="math/tex">z</script>-dependent rate.</p>
</li>
</ul>
<p>This behavior is expected for cases in which the photon wavenumber
lies within the Brillouin zone; the square-root blowup in
the LDOS is just the usual van Hove singularity, while 
the exponential decay for larger <script type="math/tex">k</script> arises because plane waves
with transverse wavelength shorter than the free-space 
photon wavelength are evanescent (not propagating) waves
that decay exponentially with distance from the surface.</p>
<p>(BTW, <a href="../XAxisPlotter.gp">here</a> is the <span class=SC>gnuplot</span>
script that produces the two plots above.)</p>
<hr />
<h3 id="running-full-brillouin-zone-integrated-calculations">Running full Brillouin-zone-integrated calculations</h3>
<p>Now it's time to launch runs for full BZ-integrated LDOS. For
this purpose we will want to set appropriate values for the
<a href="../../../reference/BrillouinZoneIntegration/">command-line options controlling Brillouin-zone integration</a>.
We have already determined that the integrand has 
8-fold symmetry, so we will be specifying <code class="codehilite">--BZSymmetryFactor 8.</code>
The next task is to choose a cubature
rule ("BZ integration method"), i.e. a strategy for sampling
the integrand at appropriately-chosen <script type="math/tex">|\mathbf{k}_\text{B}|</script>
points to estimate the integral accurately with as few
samples as possible.</p>
<p>The presence of the <script type="math/tex">|\mathbf{k}_\text{B}|=k_0</script> singularity
in the Brillouin zone makes this a good candidate for
the <code class="codehilite">Polar2</code> strategy, which performs the BZ integral
using a polar decomposition
<script type="math/tex">\mathbf{k}_\text{B}=(k_\rho, k_\theta)</script>,
with the integrals over the regions <script type="math/tex">k_\rho < k_0</script> 
and <script type="math/tex">k_\rho>k_0</script> handled separately, and with the 
change of variables <script type="math/tex">k_\rho \to k_z=\sqrt{|k_0^2 - k_\rho^2|}</script>
to neutralize the square-root singularity at 
<script type="math/tex">k_\rho = k_0.</script> In this case the integrals
over <script type="math/tex">k_z</script> and <script type="math/tex">k_\theta</script> are performed using 
<script type="math/tex">N_\rho</script> and <script type="math/tex">N_\theta</script> evaluation points, 
respectively, where <script type="math/tex">N_\rho</script> and <script type="math/tex">N_\theta</script> 
are combined into a single value specified as 
the <code class="codehilite">--BZIOrder</code> command-line option, i.e.
<script type="math/tex; mode=display"> \texttt{--BZIOrder} = N_\rho \times 100 + N_\theta.</script>
For example, to use 31 points for the radial integral
and 11 points for the <script type="math/tex">\theta</script> integral, we would
say <code class="codehilite">--BZIOrder 3111</code>.</p>
<p>(Actually, in this particular case, we expect to have
full rotational symmetry, i.e. the integrand should be 
independent of <script type="math/tex">k_\theta</script>, and thus we can specify
the special value <script type="math/tex">N_\theta=2</script> to request that the
<script type="math/tex">k_\theta</script> integral be evaluated by a one-point
cubature sampling just the point <script type="math/tex">k_\theta=0</script>.)</p>
<p>Choosing an 11-point integration rule for the
radial integral and the above-discussed 1-point
cubature for the <script type="math/tex">\theta</script> integral, our <a class="wikilink" href="../../../scuff-ldos/">scuff-ldos</a>
command-line looks like this:</p>
<div class="codehilite"><pre><span></span>% scuff-ldos --geometry scuffgeoFiles/AlHalfSpace_L0P1_40.scuffgeo --OmegaFile OmegaFile --EPFile EPFile --BZIMethod Polar2 --BZIOrder <span class="m">1102</span>
</pre></div>

<p>As a comparison, I will also run calculations with
<script type="math/tex">N_\rho=0</script>. This selects an <em>adaptive</em> integration
algorithm for the radial integral, which determines
the number and location of the sample points
automatically to achieve user-specified relative
and absolute error tolerances, which are set with the 
<code class="codehilite">--BZIRelTol</code> and <code class="codehilite">--BZIAbsTol</code> command-line options:</p>
<div class="codehilite"><pre><span></span>% scuff-ldos --geometry scuffgeoFiles/AlHalfSpace_L0P1_40.scuffgeo --OmegaFile OmegaFile --EPFile EPFile --BZIMethod Polar2 --BZIOrder <span class="m">0002</span> --BZIRelTol <span class="m">1</span>.0e-2 --BZIRelTol <span class="m">1</span>.0e-8
</pre></div>

<p>I also run calculations on the finer-resolution mesh (the <code class="codehilite">_176.scuffgeo</code> files) and the 
mesh with lattice constant <script type="math/tex">L=0.01\,\mu\text{m}</script> (the <code class="codehilite">L0P01</code> files).</p>
<p>Here's a plot of the LDOS enhancement at <script type="math/tex">z=10 nm</script>:</p>
<p><img alt="AluminumLDOS_Z0P01.png" src="../AluminumLDOS_Z0P01.png" /></p>
<p>The green dots are for the calculation with all numerical
resolution parameters
set to their maximum (most accurate and most expensive) values: 
finest mesh, smallest lattice constant, and adaptive BZ cubature. 
These points agree well with the analytical prediction up to the 
highest frequencies, where they start to deviate.</p>
<p>The other data symbols are the results of calculations in
which one fineness parameter is relaxed to a less-expensive 
value:</p>
<ul>
<li>The blue triangles are for the geometry with lattice constant
<script type="math/tex">L=100</script> nm (but still using a fine mesh with adaptive cubature).
Evidently this degrades the quality of the numerical data
completely. That makes sense, since the evaluation point 
is at a height <script type="math/tex">z=10</script> nm above the surface. For larger <script type="math/tex">z</script> 
values the data values for the two lattice constants are in 
better agreement.</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>The orange triangles are for the geometry with lattice
constant <script type="math/tex">L=10</script> nm, but now meshed at coarser resolution
(resulting in <script type="math/tex">N=40</script> triangle edges instead of <script type="math/tex">N=176</script> for
the finer case). Evidently this doesn't degrade the 
quality of the data <em>at all</em>, so for this case we can 
run calculations with the (significantly cheaper) coarser
mesh at no cost in accuracy. </li>
</ul>
<p>&nbsp;</p>
<ul>
<li>The yellow stars are for the <script type="math/tex">L=10</script> nm geometry with
the fine (<script type="math/tex">N=176</script>) mesh resolution, but with the BZ integration
performed using a fixed-order numerical integration (<script type="math/tex">N_\rho=31</script> samples)
instead of adaptive quadrature
for the radial part of the BZ integral. Evidently this 
yields data that agree with the more accurate adaptive-quadrature
data at most frequencies, but deviate over a range of 
frequencies in the range <script type="math/tex">\omega\in[10,40]</script>
and again at high frequencies.</li>
</ul>
                
                  
                
              
              
                



  <h2 id="__comments">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "http://homerreid.github.io/scuff-em-documentation/examples/HalfSpaceLDOS/HalfSpaceLDOS/";
      this.page.identifier =
        "/examples/HalfSpaceLDOS/HalfSpaceLDOS/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//homerreid-github-io-scuff-em-documentation.disqus.com.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../TipSubstrate/TipSubstrate/" title="Spatial distribution of heat flux from a warm tip over a cold substrate" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Spatial distribution of heat flux from a warm tip over a cold substrate
              </span>
            </div>
          </a>
        
        
          <a href="../../PlatonicSolids/PlatonicSolids/" title="Electrostatic polarizability of platonic solids" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Electrostatic polarizability of platonic solids
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../../.."}})</script>
      
        <script src="../../../javascripts/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../../../javascripts/mathjaxhelper.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-119340518-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>